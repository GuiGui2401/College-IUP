{"ast":null,"code":"import{useEffect,useState}from\"react\";import{Alert,Badge,Button,ButtonGroup,Card,Col,Container,Form,InputGroup,Row,Spinner,Table}from\"react-bootstrap\";import{ArrowLeftCircle,ArrowRightCircle,Calendar,CalendarRange,CheckCircleFill,Clock,FileEarmarkText,Filter,People,PersonXFill,Printer,Search,XCircleFill}from\"react-bootstrap-icons\";import{useAuth}from\"../../hooks/useAuth\";import{host}from\"../../utils/fetch\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const AttendanceReports=()=>{const[attendances,setAttendances]=useState([]);const[filteredAttendances,setFilteredAttendances]=useState([]);const[classes,setClasses]=useState([]);const[isLoading,setIsLoading]=useState(false);const[isMarkingAbsent,setIsMarkingAbsent]=useState(false);const[message,setMessage]=useState(\"\");const[messageType,setMessageType]=useState(\"\");const[filters,setFilters]=useState({startDate:new Date().toISOString().split(\"T\")[0],endDate:new Date().toISOString().split(\"T\")[0],classId:\"\",status:\"all\",// all, present, absent\neventType:\"all\",// all, entry, exit\nsearchTerm:\"\"});const[summary,setSummary]=useState({totalRecords:0,entryCount:0,exitCount:0,presentCount:0,absentCount:0,presentPercentage:0});const{user,token}=useAuth();useEffect(()=>{console.log(\"üöÄ AttendanceReports mont√©\");console.log(\"üë§ User:\",user);console.log(\"üîë Token pr√©sent:\",!!token);console.log(\"üìä User role:\",user===null||user===void 0?void 0:user.role);if(!user||!token){setMessage(\"Utilisateur non connect√© ou token manquant\");setMessageType(\"danger\");return;}if(user.role!==\"surveillant_general\"&&user.role!==\"admin\"){setMessage(\"Acc√®s refus√©: r√¥le insuffisant\");setMessageType(\"danger\");return;}loadSupervisorClasses();},[user,token]);useEffect(()=>{console.log(\"üîÑ Effect loadAttendances d√©clench√©\");console.log(\"üìÖ Dates:\",filters.startDate,\"√†\",filters.endDate);console.log(\"üè´ Classe ID:\",filters.classId);if(filters.startDate&&filters.endDate&&user&&token){console.log(\"‚ñ∂Ô∏è D√©clenchement loadAttendances\");loadAttendances();}else{console.log(\"‚è∏Ô∏è Conditions non remplies:\",{startDate:!!filters.startDate,endDate:!!filters.endDate,user:!!user,token:!!token});}},[filters.startDate,filters.endDate,filters.classId,user,token]);useEffect(()=>{filterAndSummarizeAttendances();},[attendances,filters.status,filters.eventType,filters.searchTerm]);const loadSupervisorClasses=async()=>{try{console.log(\"üîç Chargement des classes pour superviseur:\",user.id);console.log(\"üîë Token:\",token?\"pr√©sent\":\"absent\");// Le token est d√©j√† disponible depuis useAuth\nconst response=await fetch(`${host}/api/supervisors/${user.id}/assignments`,{headers:{Authorization:`Bearer ${token}`,\"Content-Type\":\"application/json\"}});console.log(\"üì° Response status:\",response.status);const data=await response.json();console.log(\"üìä Response data:\",data);if(data.success){var _data$data;console.log(\"‚úÖ Classes trouv√©es:\",((_data$data=data.data)===null||_data$data===void 0?void 0:_data$data.length)||0);setClasses(data.data||[]);// setMessage(\n//   `${data.data?.length || 0} classe(s) assign√©e(s) trouv√©e(s)`\n// );\n// setMessageType(\"success\");\n}else{console.log(\"‚ùå √âchec chargement classes:\",data.message);// setMessage(data.message || \"Erreur lors du chargement des classes\");\n// setMessageType(\"warning\");\n}}catch(error){// console.error(\"üö® Erreur lors du chargement des classes:\", error);\n// setMessage(\"Erreur r√©seau lors du chargement des classes\");\n// setMessageType(\"danger\");\n}};const loadAttendances=async()=>{if(!filters.startDate||!filters.endDate){console.log(\"‚ö†Ô∏è Dates manquantes:\",filters.startDate,filters.endDate);return;}try{setIsLoading(true);console.log(\"üìÖ Chargement attendance:\",filters.startDate,\"√†\",filters.endDate);// Le token est d√©j√† disponible depuis useAuth\nconst params=new URLSearchParams({supervisor_id:user.id,start_date:filters.startDate,end_date:filters.endDate});if(filters.classId){params.append(\"class_id\",filters.classId);console.log(\"üè´ Filtre classe:\",filters.classId);}const url=`${host}/api/supervisors/attendance-range?${params}`;console.log(\"üåê URL requ√™te:\",url);const response=await fetch(url,{headers:{Authorization:`Bearer ${token}`,\"Content-Type\":\"application/json\"}});console.log(\"üì° Attendance response status:\",response.status);const data=await response.json();console.log(\"üìä Attendance data:\",data);if(data.success){var _data$data2,_data$data2$attendanc;const attendanceCount=((_data$data2=data.data)===null||_data$data2===void 0?void 0:(_data$data2$attendanc=_data$data2.attendances)===null||_data$data2$attendanc===void 0?void 0:_data$data2$attendanc.length)||0;console.log(\"‚úÖ Attendances trouv√©es:\",attendanceCount);setAttendances(data.data.attendances||[]);// if (attendanceCount === 0) {\n//   // setMessage(\"Aucune donn√©e de pr√©sence trouv√©e pour cette p√©riode\");\n//   // setMessageType(\"info\");\n// } else {\n//   setMessage(\n//     `${attendanceCount} enregistrement(s) de pr√©sence trouv√©(s)`\n//   );\n//   setMessageType(\"success\");\n// }\n}else{console.log(\"‚ùå √âchec chargement attendance:\",data.message);setMessage(data.message||\"Erreur lors du chargement\");setMessageType(\"danger\");}}catch(error){console.error(\"üö® Erreur attendance:\",error);setMessage(\"Erreur lors du chargement des pr√©sences\");setMessageType(\"danger\");}finally{setIsLoading(false);}};const filterAndSummarizeAttendances=()=>{let filtered=[...attendances];// Filter by status\nif(filters.status===\"present\"){filtered=filtered.filter(att=>att.is_present);}else if(filters.status===\"absent\"){filtered=filtered.filter(att=>!att.is_present);}// Filter by event type\nif(filters.eventType===\"entry\"){filtered=filtered.filter(att=>att.event_type===\"entry\");}else if(filters.eventType===\"exit\"){filtered=filtered.filter(att=>att.event_type===\"exit\");}// Filter by search term\nif(filters.searchTerm){const searchLower=filters.searchTerm.toLowerCase();filtered=filtered.filter(att=>{var _att$student,_att$student$full_nam,_att$school_class,_att$school_class$nam;return((_att$student=att.student)===null||_att$student===void 0?void 0:(_att$student$full_nam=_att$student.full_name)===null||_att$student$full_nam===void 0?void 0:_att$student$full_nam.toLowerCase().includes(searchLower))||((_att$school_class=att.school_class)===null||_att$school_class===void 0?void 0:(_att$school_class$nam=_att$school_class.name)===null||_att$school_class$nam===void 0?void 0:_att$school_class$nam.toLowerCase().includes(searchLower));});}setFilteredAttendances(filtered);// Calculate summary\nconst totalRecords=attendances.length;const entryCount=attendances.filter(att=>att.event_type===\"entry\").length;const exitCount=attendances.filter(att=>att.event_type===\"exit\").length;const presentCount=attendances.filter(att=>att.is_present).length;const absentCount=totalRecords-presentCount;const presentPercentage=totalRecords>0?(presentCount/totalRecords*100).toFixed(1):0;setSummary({totalRecords,entryCount,exitCount,presentCount,absentCount,presentPercentage});};const handleFilterChange=(field,value)=>{setFilters(prev=>({...prev,[field]:value}));};const resetFilters=()=>{setFilters({startDate:new Date().toISOString().split(\"T\")[0],endDate:new Date().toISOString().split(\"T\")[0],classId:\"\",status:\"all\",eventType:\"all\",searchTerm:\"\"});};const formatDate=dateString=>{return new Date(dateString).toLocaleDateString(\"fr-FR\");};const formatTime=timeString=>{if(!timeString)return\"\";return new Date(`2000-01-01T${timeString}`).toLocaleTimeString(\"fr-FR\",{hour:\"2-digit\",minute:\"2-digit\"});};const exportToPDF=()=>{// TODO: Implement PDF export\nsetMessage(\"Fonction d'export PDF en cours de d√©veloppement\");setMessageType(\"info\");};const markAbsentStudents=async()=>{if(!filters.classId){setMessage(\"Veuillez s√©lectionner une classe pour marquer les absents\");setMessageType(\"warning\");return;}const confirmAction=window.confirm(`√ätes-vous s√ªr de vouloir marquer tous les √©l√®ves non pr√©sents comme absents pour le ${new Date(filters.startDate).toLocaleDateString(\"fr-FR\")} ?`);if(!confirmAction)return;try{setIsMarkingAbsent(true);console.log(\"üîÑ Marquage des absents pour classe:\",filters.classId,\"date:\",filters.startDate);const response=await fetch(`${host}/api/supervisors/mark-absent-students`,{method:\"POST\",headers:{Authorization:`Bearer ${token}`,\"Content-Type\":\"application/json\"},body:JSON.stringify({supervisor_id:user.id,school_class_id:filters.classId,attendance_date:filters.startDate})});const data=await response.json();console.log(\"üìä R√©sultat marquage absents:\",data);if(data.success){setMessage(data.message);setMessageType(\"success\");// Recharger les donn√©es d'attendance\nloadAttendances();// Afficher les statistiques\nif(data.data){setTimeout(()=>{setMessage(`‚úÖ ${data.message}\\n`+`üìä Total √©tudiants: ${data.data.total_students}\\n`+`‚úÖ Pr√©sents: ${data.data.present_students}\\n`+`‚ùå Absents marqu√©s: ${data.data.absent_students_marked}`);},1000);}}else{setMessage(data.message||\"Erreur lors du marquage des absents\");setMessageType(\"danger\");}}catch(error){console.error(\"üö® Erreur marquage absents:\",error);setMessage(\"Erreur r√©seau lors du marquage des absents\");setMessageType(\"danger\");}finally{setIsMarkingAbsent(false);}};const printReport=()=>{// Create a new window with printable content\nconst printWindow=window.open(\"\",\"_blank\");const printContent=generatePrintableReport();printWindow.document.write(`\n      <!DOCTYPE html>\n      <html>\n        <head>\n          <title>Rapport de Pr√©sences - ${filters.startDate} au ${filters.endDate}</title>\n          <style>\n            body { font-family: Arial, sans-serif; margin: 20px; }\n            .header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #000; padding-bottom: 10px; }\n            .summary { margin-bottom: 20px; display: flex; justify-content: space-around; }\n            .summary-item { text-align: center; }\n            .summary-number { font-size: 24px; font-weight: bold; color: #007bff; }\n            table { width: 100%; border-collapse: collapse; margin-top: 20px; }\n            th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }\n            th { background-color: #f8f9fa; font-weight: bold; }\n            .present { color: #28a745; font-weight: bold; }\n            .absent { color: #dc3545; font-weight: bold; }\n            .footer { margin-top: 30px; text-align: center; font-size: 12px; color: #666; }\n            @media print {\n              body { margin: 0; }\n              .no-print { display: none; }\n            }\n          </style>\n        </head>\n        <body>\n          ${printContent}\n        </body>\n      </html>\n    `);printWindow.document.close();printWindow.focus();setTimeout(()=>{printWindow.print();printWindow.close();},250);};const generatePrintableReport=()=>{const now=new Date();return`\n      <div class=\"header\">\n        <h1>COLLEGE POLYVALENT BILINGUE DE DOUALA</h1>\n        <h2>Rapport de Pr√©sences</h2>\n        <p><strong>P√©riode:</strong> ${formatDate(filters.startDate)} - ${formatDate(filters.endDate)}</p>\n        <p><strong>Surveillant:</strong> ${(user===null||user===void 0?void 0:user.name)||\"N/A\"}</p>\n        <p><strong>G√©n√©r√© le:</strong> ${now.toLocaleDateString(\"fr-FR\")} √† ${now.toLocaleTimeString(\"fr-FR\")}</p>\n      </div>\n\n      <div class=\"summary\">\n        <div class=\"summary-item\">\n          <div class=\"summary-number\">${summary.totalStudents}</div>\n          <div>Total Enregistrements</div>\n        </div>\n        <div class=\"summary-item\">\n          <div class=\"summary-number\" style=\"color: #28a745\">${summary.presentCount}</div>\n          <div>Pr√©sents</div>\n        </div>\n        <div class=\"summary-item\">\n          <div class=\"summary-number\" style=\"color: #dc3545\">${summary.absentCount}</div>\n          <div>Absents</div>\n        </div>\n        <div class=\"summary-item\">\n          <div class=\"summary-number\" style=\"color: #17a2b8\">${summary.presentPercentage}%</div>\n          <div>Taux de Pr√©sence</div>\n        </div>\n      </div>\n\n      <table>\n        <thead>\n          <tr>\n            <th>Date</th>\n            <th>√âl√®ve</th>\n            <th>Classe</th>\n            <th>Heure</th>\n            <th>Statut</th>\n            <th>Surveillant</th>\n          </tr>\n        </thead>\n        <tbody>\n          ${filteredAttendances.map(attendance=>{var _attendance$student,_attendance$school_cl,_attendance$superviso;return`\n            <tr>\n              <td>${formatDate(attendance.attendance_date)}</td>\n              <td><strong>${((_attendance$student=attendance.student)===null||_attendance$student===void 0?void 0:_attendance$student.full_name)||\"N/A\"}</strong></td>\n              <td>${((_attendance$school_cl=attendance.school_class)===null||_attendance$school_cl===void 0?void 0:_attendance$school_cl.name)||\"N/A\"}</td>\n              <td>${formatTime(attendance.scanned_at)}</td>\n              <td class=\"${attendance.is_present?\"present\":\"absent\"}\">\n                ${attendance.is_present?\"‚úì Pr√©sent\":\"‚úó Absent\"}\n              </td>\n              <td>${((_attendance$superviso=attendance.supervisor)===null||_attendance$superviso===void 0?void 0:_attendance$superviso.name)||(user===null||user===void 0?void 0:user.name)||\"N/A\"}</td>\n            </tr>\n          `;}).join(\"\")}\n        </tbody>\n      </table>\n\n      <div class=\"footer\">\n        <p>Document g√©n√©r√© automatiquement par le syst√®me de gestion scolaire</p>\n        <p>Total: ${filteredAttendances.length} enregistrement(s)</p>\n      </div>\n    `;};return/*#__PURE__*/_jsxs(Container,{fluid:true,className:\"py-4\",children:[/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsxs(\"h2\",{className:\"mb-4 d-flex align-items-center\",children:[/*#__PURE__*/_jsx(FileEarmarkText,{className:\"me-2\"}),\"Rapports de Pr\\xE9sences\"]})})}),/*#__PURE__*/_jsx(Row,{className:\"mb-3\",children:/*#__PURE__*/_jsx(Col,{children:!user||!token?/*#__PURE__*/_jsxs(Alert,{variant:\"danger\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u26A0\\uFE0F Probl\\xE8me d'authentification\"}),/*#__PURE__*/_jsx(\"br\",{}),\"Veuillez vous reconnecter avec un compte surveillant g\\xE9n\\xE9ral.\"]}):user.role!==\"surveillant_general\"&&user.role!==\"admin\"?/*#__PURE__*/_jsxs(Alert,{variant:\"warning\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\uD83D\\uDEAB Acc\\xE8s refus\\xE9\"}),/*#__PURE__*/_jsx(\"br\",{}),\"Cette page est r\\xE9serv\\xE9e aux surveillants g\\xE9n\\xE9raux et administrateurs.\"]}):/*#__PURE__*/_jsxs(Alert,{variant:\"info\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\uD83D\\uDC64 Connect\\xE9 en tant que:\"}),\" \",user.name,\" (\",user.role,\")\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"strong\",{children:\"\\uD83D\\uDCCA Classes assign\\xE9es:\"}),\" \",classes.length,\" classe(s)\"]})})}),message&&/*#__PURE__*/_jsx(Row,{className:\"mb-3\",children:/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(Alert,{variant:messageType,onClose:()=>setMessage(\"\"),dismissible:true,children:message})})}),/*#__PURE__*/_jsx(Row,{className:\"mb-4\",children:/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(Card.Header,{children:/*#__PURE__*/_jsxs(\"h5\",{className:\"mb-0 d-flex align-items-center\",children:[/*#__PURE__*/_jsx(Filter,{className:\"me-2\"}),\"Filtres de Recherche\"]})}),/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:3,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Date de d\\xE9but\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"date\",value:filters.startDate,onChange:e=>handleFilterChange(\"startDate\",e.target.value)})]})}),/*#__PURE__*/_jsx(Col,{md:3,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Date de fin\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"date\",value:filters.endDate,onChange:e=>handleFilterChange(\"endDate\",e.target.value)})]})}),/*#__PURE__*/_jsx(Col,{md:3,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Classe\"}),/*#__PURE__*/_jsxs(Form.Select,{value:filters.classId,onChange:e=>handleFilterChange(\"classId\",e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Toutes les classes\"}),classes.map(assignment=>{var _assignment$school_cl;return/*#__PURE__*/_jsx(\"option\",{value:assignment.school_class_id,children:(_assignment$school_cl=assignment.school_class)===null||_assignment$school_cl===void 0?void 0:_assignment$school_cl.name},assignment.id);})]})]})}),/*#__PURE__*/_jsx(Col,{md:3,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Statut\"}),/*#__PURE__*/_jsxs(Form.Select,{value:filters.status,onChange:e=>handleFilterChange(\"status\",e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"all\",children:\"Tous\"}),/*#__PURE__*/_jsx(\"option\",{value:\"present\",children:\"Pr\\xE9sents seulement\"}),/*#__PURE__*/_jsx(\"option\",{value:\"absent\",children:\"Absents seulement\"})]})]})})]}),/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:3,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Type d'\\xE9v\\xE9nement\"}),/*#__PURE__*/_jsxs(Form.Select,{value:filters.eventType,onChange:e=>handleFilterChange(\"eventType\",e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"all\",children:\"Tous les \\xE9v\\xE9nements\"}),/*#__PURE__*/_jsx(\"option\",{value:\"entry\",children:\"Entr\\xE9es seulement\"}),/*#__PURE__*/_jsx(\"option\",{value:\"exit\",children:\"Sorties seulement\"})]})]})}),/*#__PURE__*/_jsx(Col,{md:5,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Rechercher un \\xE9l\\xE8ve\"}),/*#__PURE__*/_jsxs(InputGroup,{children:[/*#__PURE__*/_jsx(InputGroup.Text,{children:/*#__PURE__*/_jsx(Search,{})}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"Nom de l'\\xE9l\\xE8ve...\",value:filters.searchTerm,onChange:e=>handleFilterChange(\"searchTerm\",e.target.value)})]})]})}),/*#__PURE__*/_jsx(Col,{md:4,className:\"d-flex align-items-end\",children:/*#__PURE__*/_jsx(Button,{variant:\"outline-secondary\",onClick:resetFilters,className:\"mb-3\",children:\"R\\xE9initialiser\"})})]})]})]})})}),/*#__PURE__*/_jsxs(Row,{className:\"mb-4\",children:[/*#__PURE__*/_jsx(Col,{md:2,children:/*#__PURE__*/_jsx(Card,{className:\"text-center border-primary\",children:/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsx(People,{size:28,className:\"text-primary mb-2\"}),/*#__PURE__*/_jsx(\"h5\",{className:\"mb-0\",children:summary.totalRecords}),/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:\"Total\"})]})})}),/*#__PURE__*/_jsx(Col,{md:2,children:/*#__PURE__*/_jsx(Card,{className:\"text-center border-success\",children:/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsx(ArrowRightCircle,{size:28,className:\"text-success mb-2\"}),/*#__PURE__*/_jsx(\"h5\",{className:\"mb-0\",children:summary.entryCount}),/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:\"Entr\\xE9es\"})]})})}),/*#__PURE__*/_jsx(Col,{md:2,children:/*#__PURE__*/_jsx(Card,{className:\"text-center border-danger\",children:/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsx(ArrowLeftCircle,{size:28,className:\"text-danger mb-2\"}),/*#__PURE__*/_jsx(\"h5\",{className:\"mb-0\",children:summary.exitCount}),/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:\"Sorties\"})]})})}),/*#__PURE__*/_jsx(Col,{md:2,children:/*#__PURE__*/_jsx(Card,{className:\"text-center border-success\",children:/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsx(CheckCircleFill,{size:28,className:\"text-success mb-2\"}),/*#__PURE__*/_jsx(\"h5\",{className:\"mb-0\",children:summary.presentCount}),/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:\"Pr\\xE9sents\"})]})})}),/*#__PURE__*/_jsx(Col,{md:2,children:/*#__PURE__*/_jsx(Card,{className:\"text-center border-warning\",children:/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsx(XCircleFill,{size:28,className:\"text-warning mb-2\"}),/*#__PURE__*/_jsx(\"h5\",{className:\"mb-0\",children:summary.absentCount}),/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:\"Absents\"})]})})}),/*#__PURE__*/_jsx(Col,{md:2,children:/*#__PURE__*/_jsx(Card,{className:\"text-center border-info\",children:/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsx(CalendarRange,{size:28,className:\"text-info mb-2\"}),/*#__PURE__*/_jsxs(\"h5\",{className:\"mb-0\",children:[summary.presentPercentage,\"%\"]}),/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:\"Taux\"})]})})})]}),/*#__PURE__*/_jsx(Row,{className:\"mb-3\",children:/*#__PURE__*/_jsxs(Col,{className:\"d-flex justify-content-between align-items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[filters.classId&&/*#__PURE__*/_jsx(Button,{variant:\"warning\",onClick:markAbsentStudents,disabled:isMarkingAbsent||!filters.classId,children:isMarkingAbsent?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Spinner,{size:\"sm\",className:\"me-2\"}),\"Marquage en cours...\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(PersonXFill,{className:\"me-2\"}),\"Marquer Absents du Jour\"]})}),!filters.classId&&/*#__PURE__*/_jsxs(\"small\",{className:\"text-muted d-flex align-items-center\",children:[/*#__PURE__*/_jsx(PersonXFill,{className:\"me-1\"}),\"S\\xE9lectionnez une classe pour marquer les absents\"]})]}),/*#__PURE__*/_jsx(ButtonGroup,{children:/*#__PURE__*/_jsxs(Button,{variant:\"outline-primary\",onClick:printReport,children:[/*#__PURE__*/_jsx(Printer,{className:\"me-2\"}),\"Imprimer\"]})})]})}),/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(Card.Header,{children:/*#__PURE__*/_jsxs(\"h5\",{className:\"mb-0 d-flex align-items-center\",children:[/*#__PURE__*/_jsx(Calendar,{className:\"me-2\"}),\"R\\xE9sultats\",/*#__PURE__*/_jsx(Badge,{bg:\"secondary\",className:\"ms-2\",children:filteredAttendances.length})]})}),/*#__PURE__*/_jsx(Card.Body,{children:isLoading?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-4\",children:[/*#__PURE__*/_jsx(Spinner,{}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-2 text-muted\",children:\"Chargement en cours...\"})]}):filteredAttendances.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"table-responsive\",children:/*#__PURE__*/_jsxs(Table,{striped:true,hover:true,children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Date\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\xC9l\\xE8ve\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Classe\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Type\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Heure\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Statut\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Surveillant\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:filteredAttendances.map((attendance,index)=>{var _attendance$student2,_attendance$school_cl2,_attendance$superviso2;return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:formatDate(attendance.attendance_date)}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"strong\",{children:((_attendance$student2=attendance.student)===null||_attendance$student2===void 0?void 0:_attendance$student2.full_name)||\"N/A\"})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Badge,{bg:\"light\",text:\"dark\",children:((_attendance$school_cl2=attendance.school_class)===null||_attendance$school_cl2===void 0?void 0:_attendance$school_cl2.name)||\"N/A\"})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Badge,{bg:attendance.event_type===\"entry\"?\"success\":\"danger\",children:attendance.event_type===\"entry\"?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ArrowRightCircle,{size:12,className:\"me-1\"}),\"Entr\\xE9e\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ArrowLeftCircle,{size:12,className:\"me-1\"}),\"Sortie\"]})})}),/*#__PURE__*/_jsxs(\"td\",{className:\"d-flex align-items-center\",children:[/*#__PURE__*/_jsx(Clock,{size:14,className:\"me-1\"}),formatTime(attendance.scanned_at)]}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Badge,{bg:attendance.is_present?\"success\":\"danger\",children:attendance.is_present?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(CheckCircleFill,{size:12,className:\"me-1\"}),\"Pr\\xE9sent\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(XCircleFill,{size:12,className:\"me-1\"}),\"Absent\"]})})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:((_attendance$superviso2=attendance.supervisor)===null||_attendance$superviso2===void 0?void 0:_attendance$superviso2.name)||\"N/A\"})})]},index);})})]})}):/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-4 text-muted\",children:[/*#__PURE__*/_jsx(Calendar,{size:48}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-2 mb-0\",children:attendances.length===0?\"Aucune donn√©e de pr√©sence pour la p√©riode s√©lectionn√©e\":\"Aucun r√©sultat ne correspond aux filtres appliqu√©s\"})]})})]})})})]});};export default AttendanceReports;","map":{"version":3,"names":["useEffect","useState","Alert","Badge","Button","ButtonGroup","Card","Col","Container","Form","InputGroup","Row","Spinner","Table","ArrowLeftCircle","ArrowRightCircle","Calendar","CalendarRange","CheckCircleFill","Clock","FileEarmarkText","Filter","People","PersonXFill","Printer","Search","XCircleFill","useAuth","host","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","AttendanceReports","attendances","setAttendances","filteredAttendances","setFilteredAttendances","classes","setClasses","isLoading","setIsLoading","isMarkingAbsent","setIsMarkingAbsent","message","setMessage","messageType","setMessageType","filters","setFilters","startDate","Date","toISOString","split","endDate","classId","status","eventType","searchTerm","summary","setSummary","totalRecords","entryCount","exitCount","presentCount","absentCount","presentPercentage","user","token","console","log","role","loadSupervisorClasses","loadAttendances","filterAndSummarizeAttendances","id","response","fetch","headers","Authorization","data","json","success","_data$data","length","error","params","URLSearchParams","supervisor_id","start_date","end_date","append","url","_data$data2","_data$data2$attendanc","attendanceCount","filtered","filter","att","is_present","event_type","searchLower","toLowerCase","_att$student","_att$student$full_nam","_att$school_class","_att$school_class$nam","student","full_name","includes","school_class","name","toFixed","handleFilterChange","field","value","prev","resetFilters","formatDate","dateString","toLocaleDateString","formatTime","timeString","toLocaleTimeString","hour","minute","exportToPDF","markAbsentStudents","confirmAction","window","confirm","method","body","JSON","stringify","school_class_id","attendance_date","setTimeout","total_students","present_students","absent_students_marked","printReport","printWindow","open","printContent","generatePrintableReport","document","write","close","focus","print","now","totalStudents","map","attendance","_attendance$student","_attendance$school_cl","_attendance$superviso","scanned_at","supervisor","join","fluid","className","children","variant","onClose","dismissible","Header","Body","md","Group","Label","Control","type","onChange","e","target","Select","assignment","_assignment$school_cl","Text","placeholder","onClick","size","disabled","bg","striped","hover","index","_attendance$student2","_attendance$school_cl2","_attendance$superviso2","text"],"sources":["/var/www/College-IUP/front/src/pages/Attendance/AttendanceReports.jsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\nimport {\n  Alert,\n  Badge,\n  Button,\n  ButtonGroup,\n  Card,\n  Col,\n  Container,\n  Form,\n  InputGroup,\n  Row,\n  Spinner,\n  Table,\n} from \"react-bootstrap\";\nimport {\n  ArrowLeftCircle,\n  ArrowRightCircle,\n  Calendar,\n  CalendarRange,\n  CheckCircleFill,\n  Clock,\n  FileEarmarkText,\n  Filter,\n  People,\n  PersonXFill,\n  Printer,\n  Search,\n  XCircleFill,\n} from \"react-bootstrap-icons\";\nimport { useAuth } from \"../../hooks/useAuth\";\nimport { host } from \"../../utils/fetch\";\n\nconst AttendanceReports = () => {\n  const [attendances, setAttendances] = useState([]);\n  const [filteredAttendances, setFilteredAttendances] = useState([]);\n  const [classes, setClasses] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [isMarkingAbsent, setIsMarkingAbsent] = useState(false);\n  const [message, setMessage] = useState(\"\");\n  const [messageType, setMessageType] = useState(\"\");\n\n  const [filters, setFilters] = useState({\n    startDate: new Date().toISOString().split(\"T\")[0],\n    endDate: new Date().toISOString().split(\"T\")[0],\n    classId: \"\",\n    status: \"all\", // all, present, absent\n    eventType: \"all\", // all, entry, exit\n    searchTerm: \"\",\n  });\n\n  const [summary, setSummary] = useState({\n    totalRecords: 0,\n    entryCount: 0,\n    exitCount: 0,\n    presentCount: 0,\n    absentCount: 0,\n    presentPercentage: 0,\n  });\n\n  const { user, token } = useAuth();\n\n  useEffect(() => {\n    console.log(\"üöÄ AttendanceReports mont√©\");\n    console.log(\"üë§ User:\", user);\n    console.log(\"üîë Token pr√©sent:\", !!token);\n    console.log(\"üìä User role:\", user?.role);\n\n    if (!user || !token) {\n      setMessage(\"Utilisateur non connect√© ou token manquant\");\n      setMessageType(\"danger\");\n      return;\n    }\n\n    if (user.role !== \"surveillant_general\" && user.role !== \"admin\") {\n      setMessage(\"Acc√®s refus√©: r√¥le insuffisant\");\n      setMessageType(\"danger\");\n      return;\n    }\n\n    loadSupervisorClasses();\n  }, [user, token]);\n\n  useEffect(() => {\n    console.log(\"üîÑ Effect loadAttendances d√©clench√©\");\n    console.log(\"üìÖ Dates:\", filters.startDate, \"√†\", filters.endDate);\n    console.log(\"üè´ Classe ID:\", filters.classId);\n\n    if (filters.startDate && filters.endDate && user && token) {\n      console.log(\"‚ñ∂Ô∏è D√©clenchement loadAttendances\");\n      loadAttendances();\n    } else {\n      console.log(\"‚è∏Ô∏è Conditions non remplies:\", {\n        startDate: !!filters.startDate,\n        endDate: !!filters.endDate,\n        user: !!user,\n        token: !!token,\n      });\n    }\n  }, [filters.startDate, filters.endDate, filters.classId, user, token]);\n\n  useEffect(() => {\n    filterAndSummarizeAttendances();\n  }, [attendances, filters.status, filters.eventType, filters.searchTerm]);\n\n  const loadSupervisorClasses = async () => {\n    try {\n      console.log(\"üîç Chargement des classes pour superviseur:\", user.id);\n      console.log(\"üîë Token:\", token ? \"pr√©sent\" : \"absent\");\n\n      // Le token est d√©j√† disponible depuis useAuth\n      const response = await fetch(\n        `${host}/api/supervisors/${user.id}/assignments`,\n        {\n          headers: {\n            Authorization: `Bearer ${token}`,\n            \"Content-Type\": \"application/json\",\n          },\n        }\n      );\n\n      console.log(\"üì° Response status:\", response.status);\n      const data = await response.json();\n      console.log(\"üìä Response data:\", data);\n\n      if (data.success) {\n        console.log(\"‚úÖ Classes trouv√©es:\", data.data?.length || 0);\n        setClasses(data.data || []);\n        // setMessage(\n        //   `${data.data?.length || 0} classe(s) assign√©e(s) trouv√©e(s)`\n        // );\n        // setMessageType(\"success\");\n      } else {\n        console.log(\"‚ùå √âchec chargement classes:\", data.message);\n        // setMessage(data.message || \"Erreur lors du chargement des classes\");\n        // setMessageType(\"warning\");\n      }\n    } catch (error) {\n      // console.error(\"üö® Erreur lors du chargement des classes:\", error);\n      // setMessage(\"Erreur r√©seau lors du chargement des classes\");\n      // setMessageType(\"danger\");\n    }\n  };\n\n  const loadAttendances = async () => {\n    if (!filters.startDate || !filters.endDate) {\n      console.log(\"‚ö†Ô∏è Dates manquantes:\", filters.startDate, filters.endDate);\n      return;\n    }\n\n    try {\n      setIsLoading(true);\n      console.log(\n        \"üìÖ Chargement attendance:\",\n        filters.startDate,\n        \"√†\",\n        filters.endDate\n      );\n\n      // Le token est d√©j√† disponible depuis useAuth\n      const params = new URLSearchParams({\n        supervisor_id: user.id,\n        start_date: filters.startDate,\n        end_date: filters.endDate,\n      });\n\n      if (filters.classId) {\n        params.append(\"class_id\", filters.classId);\n        console.log(\"üè´ Filtre classe:\", filters.classId);\n      }\n\n      const url = `${host}/api/supervisors/attendance-range?${params}`;\n      console.log(\"üåê URL requ√™te:\", url);\n\n      const response = await fetch(url, {\n        headers: {\n          Authorization: `Bearer ${token}`,\n          \"Content-Type\": \"application/json\",\n        },\n      });\n\n      console.log(\"üì° Attendance response status:\", response.status);\n      const data = await response.json();\n      console.log(\"üìä Attendance data:\", data);\n\n      if (data.success) {\n        const attendanceCount = data.data?.attendances?.length || 0;\n        console.log(\"‚úÖ Attendances trouv√©es:\", attendanceCount);\n        setAttendances(data.data.attendances || []);\n        // if (attendanceCount === 0) {\n        //   // setMessage(\"Aucune donn√©e de pr√©sence trouv√©e pour cette p√©riode\");\n        //   // setMessageType(\"info\");\n        // } else {\n        //   setMessage(\n        //     `${attendanceCount} enregistrement(s) de pr√©sence trouv√©(s)`\n        //   );\n        //   setMessageType(\"success\");\n        // }\n      } else {\n        console.log(\"‚ùå √âchec chargement attendance:\", data.message);\n        setMessage(data.message || \"Erreur lors du chargement\");\n        setMessageType(\"danger\");\n      }\n    } catch (error) {\n      console.error(\"üö® Erreur attendance:\", error);\n      setMessage(\"Erreur lors du chargement des pr√©sences\");\n      setMessageType(\"danger\");\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const filterAndSummarizeAttendances = () => {\n    let filtered = [...attendances];\n\n    // Filter by status\n    if (filters.status === \"present\") {\n      filtered = filtered.filter((att) => att.is_present);\n    } else if (filters.status === \"absent\") {\n      filtered = filtered.filter((att) => !att.is_present);\n    }\n\n    // Filter by event type\n    if (filters.eventType === \"entry\") {\n      filtered = filtered.filter((att) => att.event_type === \"entry\");\n    } else if (filters.eventType === \"exit\") {\n      filtered = filtered.filter((att) => att.event_type === \"exit\");\n    }\n\n    // Filter by search term\n    if (filters.searchTerm) {\n      const searchLower = filters.searchTerm.toLowerCase();\n      filtered = filtered.filter(\n        (att) =>\n          att.student?.full_name?.toLowerCase().includes(searchLower) ||\n          att.school_class?.name?.toLowerCase().includes(searchLower)\n      );\n    }\n\n    setFilteredAttendances(filtered);\n\n    // Calculate summary\n    const totalRecords = attendances.length;\n    const entryCount = attendances.filter(\n      (att) => att.event_type === \"entry\"\n    ).length;\n    const exitCount = attendances.filter(\n      (att) => att.event_type === \"exit\"\n    ).length;\n    const presentCount = attendances.filter((att) => att.is_present).length;\n    const absentCount = totalRecords - presentCount;\n    const presentPercentage =\n      totalRecords > 0 ? ((presentCount / totalRecords) * 100).toFixed(1) : 0;\n\n    setSummary({\n      totalRecords,\n      entryCount,\n      exitCount,\n      presentCount,\n      absentCount,\n      presentPercentage,\n    });\n  };\n\n  const handleFilterChange = (field, value) => {\n    setFilters((prev) => ({\n      ...prev,\n      [field]: value,\n    }));\n  };\n\n  const resetFilters = () => {\n    setFilters({\n      startDate: new Date().toISOString().split(\"T\")[0],\n      endDate: new Date().toISOString().split(\"T\")[0],\n      classId: \"\",\n      status: \"all\",\n      eventType: \"all\",\n      searchTerm: \"\",\n    });\n  };\n\n  const formatDate = (dateString) => {\n    return new Date(dateString).toLocaleDateString(\"fr-FR\");\n  };\n\n  const formatTime = (timeString) => {\n    if (!timeString) return \"\";\n    return new Date(`2000-01-01T${timeString}`).toLocaleTimeString(\"fr-FR\", {\n      hour: \"2-digit\",\n      minute: \"2-digit\",\n    });\n  };\n\n  const exportToPDF = () => {\n    // TODO: Implement PDF export\n    setMessage(\"Fonction d'export PDF en cours de d√©veloppement\");\n    setMessageType(\"info\");\n  };\n\n  const markAbsentStudents = async () => {\n    if (!filters.classId) {\n      setMessage(\"Veuillez s√©lectionner une classe pour marquer les absents\");\n      setMessageType(\"warning\");\n      return;\n    }\n\n    const confirmAction = window.confirm(\n      `√ätes-vous s√ªr de vouloir marquer tous les √©l√®ves non pr√©sents comme absents pour le ${new Date(\n        filters.startDate\n      ).toLocaleDateString(\"fr-FR\")} ?`\n    );\n\n    if (!confirmAction) return;\n\n    try {\n      setIsMarkingAbsent(true);\n      console.log(\n        \"üîÑ Marquage des absents pour classe:\",\n        filters.classId,\n        \"date:\",\n        filters.startDate\n      );\n\n      const response = await fetch(\n        `${host}/api/supervisors/mark-absent-students`,\n        {\n          method: \"POST\",\n          headers: {\n            Authorization: `Bearer ${token}`,\n            \"Content-Type\": \"application/json\",\n          },\n          body: JSON.stringify({\n            supervisor_id: user.id,\n            school_class_id: filters.classId,\n            attendance_date: filters.startDate,\n          }),\n        }\n      );\n\n      const data = await response.json();\n      console.log(\"üìä R√©sultat marquage absents:\", data);\n\n      if (data.success) {\n        setMessage(data.message);\n        setMessageType(\"success\");\n\n        // Recharger les donn√©es d'attendance\n        loadAttendances();\n\n        // Afficher les statistiques\n        if (data.data) {\n          setTimeout(() => {\n            setMessage(\n              `‚úÖ ${data.message}\\n` +\n                `üìä Total √©tudiants: ${data.data.total_students}\\n` +\n                `‚úÖ Pr√©sents: ${data.data.present_students}\\n` +\n                `‚ùå Absents marqu√©s: ${data.data.absent_students_marked}`\n            );\n          }, 1000);\n        }\n      } else {\n        setMessage(data.message || \"Erreur lors du marquage des absents\");\n        setMessageType(\"danger\");\n      }\n    } catch (error) {\n      console.error(\"üö® Erreur marquage absents:\", error);\n      setMessage(\"Erreur r√©seau lors du marquage des absents\");\n      setMessageType(\"danger\");\n    } finally {\n      setIsMarkingAbsent(false);\n    }\n  };\n\n  const printReport = () => {\n    // Create a new window with printable content\n    const printWindow = window.open(\"\", \"_blank\");\n    const printContent = generatePrintableReport();\n\n    printWindow.document.write(`\n      <!DOCTYPE html>\n      <html>\n        <head>\n          <title>Rapport de Pr√©sences - ${filters.startDate} au ${filters.endDate}</title>\n          <style>\n            body { font-family: Arial, sans-serif; margin: 20px; }\n            .header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #000; padding-bottom: 10px; }\n            .summary { margin-bottom: 20px; display: flex; justify-content: space-around; }\n            .summary-item { text-align: center; }\n            .summary-number { font-size: 24px; font-weight: bold; color: #007bff; }\n            table { width: 100%; border-collapse: collapse; margin-top: 20px; }\n            th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }\n            th { background-color: #f8f9fa; font-weight: bold; }\n            .present { color: #28a745; font-weight: bold; }\n            .absent { color: #dc3545; font-weight: bold; }\n            .footer { margin-top: 30px; text-align: center; font-size: 12px; color: #666; }\n            @media print {\n              body { margin: 0; }\n              .no-print { display: none; }\n            }\n          </style>\n        </head>\n        <body>\n          ${printContent}\n        </body>\n      </html>\n    `);\n\n    printWindow.document.close();\n    printWindow.focus();\n    setTimeout(() => {\n      printWindow.print();\n      printWindow.close();\n    }, 250);\n  };\n\n  const generatePrintableReport = () => {\n    const now = new Date();\n    return `\n      <div class=\"header\">\n        <h1>COLLEGE POLYVALENT BILINGUE DE DOUALA</h1>\n        <h2>Rapport de Pr√©sences</h2>\n        <p><strong>P√©riode:</strong> ${formatDate(\n          filters.startDate\n        )} - ${formatDate(filters.endDate)}</p>\n        <p><strong>Surveillant:</strong> ${user?.name || \"N/A\"}</p>\n        <p><strong>G√©n√©r√© le:</strong> ${now.toLocaleDateString(\n          \"fr-FR\"\n        )} √† ${now.toLocaleTimeString(\"fr-FR\")}</p>\n      </div>\n\n      <div class=\"summary\">\n        <div class=\"summary-item\">\n          <div class=\"summary-number\">${summary.totalStudents}</div>\n          <div>Total Enregistrements</div>\n        </div>\n        <div class=\"summary-item\">\n          <div class=\"summary-number\" style=\"color: #28a745\">${\n            summary.presentCount\n          }</div>\n          <div>Pr√©sents</div>\n        </div>\n        <div class=\"summary-item\">\n          <div class=\"summary-number\" style=\"color: #dc3545\">${\n            summary.absentCount\n          }</div>\n          <div>Absents</div>\n        </div>\n        <div class=\"summary-item\">\n          <div class=\"summary-number\" style=\"color: #17a2b8\">${\n            summary.presentPercentage\n          }%</div>\n          <div>Taux de Pr√©sence</div>\n        </div>\n      </div>\n\n      <table>\n        <thead>\n          <tr>\n            <th>Date</th>\n            <th>√âl√®ve</th>\n            <th>Classe</th>\n            <th>Heure</th>\n            <th>Statut</th>\n            <th>Surveillant</th>\n          </tr>\n        </thead>\n        <tbody>\n          ${filteredAttendances\n            .map(\n              (attendance) => `\n            <tr>\n              <td>${formatDate(attendance.attendance_date)}</td>\n              <td><strong>${\n                attendance.student?.full_name || \"N/A\"\n              }</strong></td>\n              <td>${attendance.school_class?.name || \"N/A\"}</td>\n              <td>${formatTime(attendance.scanned_at)}</td>\n              <td class=\"${attendance.is_present ? \"present\" : \"absent\"}\">\n                ${attendance.is_present ? \"‚úì Pr√©sent\" : \"‚úó Absent\"}\n              </td>\n              <td>${attendance.supervisor?.name || user?.name || \"N/A\"}</td>\n            </tr>\n          `\n            )\n            .join(\"\")}\n        </tbody>\n      </table>\n\n      <div class=\"footer\">\n        <p>Document g√©n√©r√© automatiquement par le syst√®me de gestion scolaire</p>\n        <p>Total: ${filteredAttendances.length} enregistrement(s)</p>\n      </div>\n    `;\n  };\n\n  return (\n    <Container fluid className=\"py-4\">\n      <Row>\n        <Col>\n          <h2 className=\"mb-4 d-flex align-items-center\">\n            <FileEarmarkText className=\"me-2\" />\n            Rapports de Pr√©sences\n          </h2>\n        </Col>\n      </Row>\n\n      {/* √âtat de connexion */}\n      <Row className=\"mb-3\">\n        <Col>\n          {!user || !token ? (\n            <Alert variant=\"danger\">\n              <strong>‚ö†Ô∏è Probl√®me d'authentification</strong>\n              <br />\n              Veuillez vous reconnecter avec un compte surveillant g√©n√©ral.\n            </Alert>\n          ) : user.role !== \"surveillant_general\" && user.role !== \"admin\" ? (\n            <Alert variant=\"warning\">\n              <strong>üö´ Acc√®s refus√©</strong>\n              <br />\n              Cette page est r√©serv√©e aux surveillants g√©n√©raux et\n              administrateurs.\n            </Alert>\n          ) : (\n            <Alert variant=\"info\">\n              <strong>üë§ Connect√© en tant que:</strong> {user.name} ({user.role}\n              )<br />\n              <strong>üìä Classes assign√©es:</strong> {classes.length} classe(s)\n            </Alert>\n          )}\n        </Col>\n      </Row>\n\n      {/* Messages de l'application */}\n      {message && (\n        <Row className=\"mb-3\">\n          <Col>\n            <Alert\n              variant={messageType}\n              onClose={() => setMessage(\"\")}\n              dismissible\n            >\n              {message}\n            </Alert>\n          </Col>\n        </Row>\n      )}\n\n      {/* Filters Section */}\n      <Row className=\"mb-4\">\n        <Col>\n          <Card>\n            <Card.Header>\n              <h5 className=\"mb-0 d-flex align-items-center\">\n                <Filter className=\"me-2\" />\n                Filtres de Recherche\n              </h5>\n            </Card.Header>\n            <Card.Body>\n              <Row>\n                <Col md={3}>\n                  <Form.Group className=\"mb-3\">\n                    <Form.Label>Date de d√©but</Form.Label>\n                    <Form.Control\n                      type=\"date\"\n                      value={filters.startDate}\n                      onChange={(e) =>\n                        handleFilterChange(\"startDate\", e.target.value)\n                      }\n                    />\n                  </Form.Group>\n                </Col>\n                <Col md={3}>\n                  <Form.Group className=\"mb-3\">\n                    <Form.Label>Date de fin</Form.Label>\n                    <Form.Control\n                      type=\"date\"\n                      value={filters.endDate}\n                      onChange={(e) =>\n                        handleFilterChange(\"endDate\", e.target.value)\n                      }\n                    />\n                  </Form.Group>\n                </Col>\n                <Col md={3}>\n                  <Form.Group className=\"mb-3\">\n                    <Form.Label>Classe</Form.Label>\n                    <Form.Select\n                      value={filters.classId}\n                      onChange={(e) =>\n                        handleFilterChange(\"classId\", e.target.value)\n                      }\n                    >\n                      <option value=\"\">Toutes les classes</option>\n                      {classes.map((assignment) => (\n                        <option\n                          key={assignment.id}\n                          value={assignment.school_class_id}\n                        >\n                          {assignment.school_class?.name}\n                        </option>\n                      ))}\n                    </Form.Select>\n                  </Form.Group>\n                </Col>\n                <Col md={3}>\n                  <Form.Group className=\"mb-3\">\n                    <Form.Label>Statut</Form.Label>\n                    <Form.Select\n                      value={filters.status}\n                      onChange={(e) =>\n                        handleFilterChange(\"status\", e.target.value)\n                      }\n                    >\n                      <option value=\"all\">Tous</option>\n                      <option value=\"present\">Pr√©sents seulement</option>\n                      <option value=\"absent\">Absents seulement</option>\n                    </Form.Select>\n                  </Form.Group>\n                </Col>\n              </Row>\n              <Row>\n                <Col md={3}>\n                  <Form.Group className=\"mb-3\">\n                    <Form.Label>Type d'√©v√©nement</Form.Label>\n                    <Form.Select\n                      value={filters.eventType}\n                      onChange={(e) =>\n                        handleFilterChange(\"eventType\", e.target.value)\n                      }\n                    >\n                      <option value=\"all\">Tous les √©v√©nements</option>\n                      <option value=\"entry\">Entr√©es seulement</option>\n                      <option value=\"exit\">Sorties seulement</option>\n                    </Form.Select>\n                  </Form.Group>\n                </Col>\n                <Col md={5}>\n                  <Form.Group className=\"mb-3\">\n                    <Form.Label>Rechercher un √©l√®ve</Form.Label>\n                    <InputGroup>\n                      <InputGroup.Text>\n                        <Search />\n                      </InputGroup.Text>\n                      <Form.Control\n                        type=\"text\"\n                        placeholder=\"Nom de l'√©l√®ve...\"\n                        value={filters.searchTerm}\n                        onChange={(e) =>\n                          handleFilterChange(\"searchTerm\", e.target.value)\n                        }\n                      />\n                    </InputGroup>\n                  </Form.Group>\n                </Col>\n                <Col md={4} className=\"d-flex align-items-end\">\n                  <Button\n                    variant=\"outline-secondary\"\n                    onClick={resetFilters}\n                    className=\"mb-3\"\n                  >\n                    R√©initialiser\n                  </Button>\n                </Col>\n              </Row>\n            </Card.Body>\n          </Card>\n        </Col>\n      </Row>\n\n      {/* Summary Section */}\n      <Row className=\"mb-4\">\n        <Col md={2}>\n          <Card className=\"text-center border-primary\">\n            <Card.Body>\n              <People size={28} className=\"text-primary mb-2\" />\n              <h5 className=\"mb-0\">{summary.totalRecords}</h5>\n              <small className=\"text-muted\">Total</small>\n            </Card.Body>\n          </Card>\n        </Col>\n        <Col md={2}>\n          <Card className=\"text-center border-success\">\n            <Card.Body>\n              <ArrowRightCircle size={28} className=\"text-success mb-2\" />\n              <h5 className=\"mb-0\">{summary.entryCount}</h5>\n              <small className=\"text-muted\">Entr√©es</small>\n            </Card.Body>\n          </Card>\n        </Col>\n        <Col md={2}>\n          <Card className=\"text-center border-danger\">\n            <Card.Body>\n              <ArrowLeftCircle size={28} className=\"text-danger mb-2\" />\n              <h5 className=\"mb-0\">{summary.exitCount}</h5>\n              <small className=\"text-muted\">Sorties</small>\n            </Card.Body>\n          </Card>\n        </Col>\n        <Col md={2}>\n          <Card className=\"text-center border-success\">\n            <Card.Body>\n              <CheckCircleFill size={28} className=\"text-success mb-2\" />\n              <h5 className=\"mb-0\">{summary.presentCount}</h5>\n              <small className=\"text-muted\">Pr√©sents</small>\n            </Card.Body>\n          </Card>\n        </Col>\n        <Col md={2}>\n          <Card className=\"text-center border-warning\">\n            <Card.Body>\n              <XCircleFill size={28} className=\"text-warning mb-2\" />\n              <h5 className=\"mb-0\">{summary.absentCount}</h5>\n              <small className=\"text-muted\">Absents</small>\n            </Card.Body>\n          </Card>\n        </Col>\n        <Col md={2}>\n          <Card className=\"text-center border-info\">\n            <Card.Body>\n              <CalendarRange size={28} className=\"text-info mb-2\" />\n              <h5 className=\"mb-0\">{summary.presentPercentage}%</h5>\n              <small className=\"text-muted\">Taux</small>\n            </Card.Body>\n          </Card>\n        </Col>\n      </Row>\n\n      {/* Actions */}\n      <Row className=\"mb-3\">\n        <Col className=\"d-flex justify-content-between align-items-center\">\n          {/* Bouton marquer absents */}\n          <div>\n            {filters.classId && (\n              <Button\n                variant=\"warning\"\n                onClick={markAbsentStudents}\n                disabled={isMarkingAbsent || !filters.classId}\n              >\n                {isMarkingAbsent ? (\n                  <>\n                    <Spinner size=\"sm\" className=\"me-2\" />\n                    Marquage en cours...\n                  </>\n                ) : (\n                  <>\n                    <PersonXFill className=\"me-2\" />\n                    Marquer Absents du Jour\n                  </>\n                )}\n              </Button>\n            )}\n            {!filters.classId && (\n              <small className=\"text-muted d-flex align-items-center\">\n                <PersonXFill className=\"me-1\" />\n                S√©lectionnez une classe pour marquer les absents\n              </small>\n            )}\n          </div>\n\n          {/* Boutons d'export */}\n          <ButtonGroup>\n            <Button variant=\"outline-primary\" onClick={printReport}>\n              <Printer className=\"me-2\" />\n              Imprimer\n            </Button>\n            {/* <Button variant=\"outline-success\" onClick={exportToPDF}>\n              <Download className=\"me-2\" />\n              Exporter PDF\n            </Button> */}\n          </ButtonGroup>\n        </Col>\n      </Row>\n\n      {/* Results Table */}\n      <Row>\n        <Col>\n          <Card>\n            <Card.Header>\n              <h5 className=\"mb-0 d-flex align-items-center\">\n                <Calendar className=\"me-2\" />\n                R√©sultats\n                <Badge bg=\"secondary\" className=\"ms-2\">\n                  {filteredAttendances.length}\n                </Badge>\n              </h5>\n            </Card.Header>\n            <Card.Body>\n              {isLoading ? (\n                <div className=\"text-center py-4\">\n                  <Spinner />\n                  <p className=\"mt-2 text-muted\">Chargement en cours...</p>\n                </div>\n              ) : filteredAttendances.length > 0 ? (\n                <div className=\"table-responsive\">\n                  <Table striped hover>\n                    <thead>\n                      <tr>\n                        <th>Date</th>\n                        <th>√âl√®ve</th>\n                        <th>Classe</th>\n                        <th>Type</th>\n                        <th>Heure</th>\n                        <th>Statut</th>\n                        <th>Surveillant</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      {filteredAttendances.map((attendance, index) => (\n                        <tr key={index}>\n                          <td>{formatDate(attendance.attendance_date)}</td>\n                          <td>\n                            <strong>\n                              {attendance.student?.full_name || \"N/A\"}\n                            </strong>\n                          </td>\n                          <td>\n                            <Badge bg=\"light\" text=\"dark\">\n                              {attendance.school_class?.name || \"N/A\"}\n                            </Badge>\n                          </td>\n                          <td>\n                            <Badge\n                              bg={\n                                attendance.event_type === \"entry\"\n                                  ? \"success\"\n                                  : \"danger\"\n                              }\n                            >\n                              {attendance.event_type === \"entry\" ? (\n                                <>\n                                  <ArrowRightCircle\n                                    size={12}\n                                    className=\"me-1\"\n                                  />\n                                  Entr√©e\n                                </>\n                              ) : (\n                                <>\n                                  <ArrowLeftCircle size={12} className=\"me-1\" />\n                                  Sortie\n                                </>\n                              )}\n                            </Badge>\n                          </td>\n                          <td className=\"d-flex align-items-center\">\n                            <Clock size={14} className=\"me-1\" />\n                            {formatTime(attendance.scanned_at)}\n                          </td>\n                          <td>\n                            <Badge\n                              bg={attendance.is_present ? \"success\" : \"danger\"}\n                            >\n                              {attendance.is_present ? (\n                                <>\n                                  <CheckCircleFill size={12} className=\"me-1\" />\n                                  Pr√©sent\n                                </>\n                              ) : (\n                                <>\n                                  <XCircleFill size={12} className=\"me-1\" />\n                                  Absent\n                                </>\n                              )}\n                            </Badge>\n                          </td>\n                          <td>\n                            <small className=\"text-muted\">\n                              {attendance.supervisor?.name || \"N/A\"}\n                            </small>\n                          </td>\n                        </tr>\n                      ))}\n                    </tbody>\n                  </Table>\n                </div>\n              ) : (\n                <div className=\"text-center py-4 text-muted\">\n                  <Calendar size={48} />\n                  <p className=\"mt-2 mb-0\">\n                    {attendances.length === 0\n                      ? \"Aucune donn√©e de pr√©sence pour la p√©riode s√©lectionn√©e\"\n                      : \"Aucun r√©sultat ne correspond aux filtres appliqu√©s\"}\n                  </p>\n                </div>\n              )}\n            </Card.Body>\n          </Card>\n        </Col>\n      </Row>\n    </Container>\n  );\n};\n\nexport default AttendanceReports;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}