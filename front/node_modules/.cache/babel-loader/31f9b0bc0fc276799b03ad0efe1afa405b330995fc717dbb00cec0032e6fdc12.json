{"ast":null,"code":"import{useEffect,useState}from\"react\";import{Alert,Badge,Button,Card,Col,Container,Form,Nav,Row,Spinner,Tab,Table}from\"react-bootstrap\";import{Building,FileText,Printer,Search,CheckSquare}from\"react-bootstrap-icons\";import{secureApiEndpoints}from\"../../utils/apiMigration\";import SeriesCollectionSummary from\"../Reports/SeriesCollectionSummary\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const PaymentReports=()=>{const[payments,setPayments]=useState([]);const[stats,setStats]=useState({});const[schoolYear,setSchoolYear]=useState(null);const[availableSeries,setAvailableSeries]=useState([]);const[loading,setLoading]=useState(false);const[error,setError]=useState(\"\");const[filters,setFilters]=useState({start_date:\"\",end_date:\"\",series_id:\"\"});useEffect(()=>{loadAvailableSeries();// Charger les donn√©es du jour par d√©faut\nconst today=new Date().toISOString().split(\"T\")[0];setFilters(prev=>({...prev,start_date:today,end_date:today}));loadPaymentStats({start_date:today,end_date:today});},[]);const loadAvailableSeries=async()=>{try{// R√©cup√©rer les classes avec leurs s√©ries\nconst response=await secureApiEndpoints.accountant.getClasses();if(response.success){const series=[];// La structure est: response.data.classes (array avec les relations)\nresponse.data.classes.forEach(schoolClass=>{if(schoolClass.series&&schoolClass.series.length>0){schoolClass.series.forEach(serie=>{series.push({id:serie.id,name:`${schoolClass.name} - ${serie.name}`,class_name:schoolClass.name,series_name:serie.name});});}});setAvailableSeries(series);console.log(\"Series loaded:\",series);// Debug\n}else{console.error(\"Error loading classes:\",response.message);}}catch(error){console.error(\"Error loading series:\",error);}};const loadPaymentStats=async function(){let customFilters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;try{setLoading(true);setError(\"\");const queryFilters=customFilters||filters;const response=await secureApiEndpoints.payments.getStats(queryFilters);if(response.success){setPayments(response.data.recent_payments||[]);setStats(response.data);setSchoolYear(response.data.school_year);}else{setError(response.message);}}catch(error){setError(\"Erreur lors du chargement des donn√©es\");console.error(\"Error loading payment stats:\",error);}finally{setLoading(false);}};const handleFilterChange=(field,value)=>{setFilters(prev=>({...prev,[field]:value}));};const handleSearch=()=>{if(filters.start_date&&filters.end_date&&filters.start_date>filters.end_date){setError(\"La date de d√©but doit √™tre ant√©rieure √† la date de fin\");return;}loadPaymentStats();};const handleExportPdf=()=>{const printWindow=window.open(\"\",\"_blank\");const html=generateReportHtml();printWindow.document.write(`\n            <html>\n                <head>\n                    <title>√âtat des Paiements</title>\n                    <style>\n                        @page {\n                            size: A4;\n                            margin: 1cm;\n                        }\n                        \n                        body { \n                            font-family: Arial, sans-serif; \n                            margin: 0;\n                            padding: 0;\n                            font-size: 11px;\n                            line-height: 1.3;\n                        }\n                        \n                        table { \n                            width: 100%; \n                            border-collapse: collapse; \n                            margin: 15px 0;\n                            font-size: 10px;\n                        }\n                        \n                        th, td { \n                            border: 1px solid #ddd; \n                            padding: 6px; \n                            text-align: left; \n                        }\n                        \n                        th { \n                            background-color: #f5f5f5; \n                            font-weight: bold; \n                            font-size: 10px;\n                        }\n                        \n                        .text-center { text-align: center; }\n                        .text-right { text-align: right; }\n                        \n                        .stats-grid { \n                            display: grid; \n                            grid-template-columns: repeat(2, 1fr); \n                            gap: 15px; \n                            margin: 15px 0; \n                        }\n                        \n                        .stat-card { \n                            border: 1px solid #ddd; \n                            padding: 10px; \n                            text-align: center;\n                            font-size: 12px;\n                        }\n                        \n                        .report-header {\n                            text-align: center;\n                            margin-bottom: 20px;\n                            border-bottom: 2px solid #333;\n                            padding-bottom: 15px;\n                        }\n                        \n                        .report-header h1 {\n                            font-size: 16px;\n                            margin: 5px 0;\n                        }\n                        \n                        .report-header h2 {\n                            font-size: 14px;\n                            margin: 5px 0;\n                        }\n                        \n                        .report-header p {\n                            font-size: 11px;\n                            margin: 3px 0;\n                        }\n                        \n                        @media print { \n                            body { \n                                margin: 0; \n                                -webkit-print-color-adjust: exact;\n                                print-color-adjust: exact;\n                            }\n                            .no-print { \n                                display: none !important; \n                            }\n                        }\n                        \n                        @media screen {\n                            body {\n                                background: #f0f0f0;\n                                padding: 20px;\n                            }\n                            \n                            .report-container {\n                                background: white;\n                                max-width: 210mm;\n                                margin: 0 auto;\n                                padding: 20px;\n                                box-shadow: 0 0 10px rgba(0,0,0,0.1);\n                            }\n                        }\n                    </style>\n                </head>\n                <body>\n                    <div class=\"report-container\">\n                        ${html}\n                    </div>\n                    <div class=\"no-print\" style=\"text-align: center; margin-top: 30px; background: white; padding: 20px;\">\n                        <button onclick=\"window.print()\" style=\"padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; margin-right: 10px;\">üìÑ Imprimer Rapport</button>\n                        <button onclick=\"window.close()\" style=\"padding: 10px 20px; background: #6c757d; color: white; border: none; border-radius: 5px; cursor: pointer;\">‚úñÔ∏è Fermer</button>\n                    </div>\n                </body>\n            </html>\n        `);printWindow.document.close();};const generateReportHtml=()=>{const selectedSeries=availableSeries.find(s=>s.id==filters.series_id);const periodText=filters.start_date&&filters.end_date?`Du ${new Date(filters.start_date).toLocaleDateString(\"fr-FR\")} au ${new Date(filters.end_date).toLocaleDateString(\"fr-FR\")}`:\"Toutes les p√©riodes\";return`\n            <div class=\"report\">\n                <div class=\"report-header text-center\" style=\"margin-bottom: 30px; border-bottom: 2px solid #333; padding-bottom: 20px;\">\n                    <h1>COLL√àGE POLYVALENT BILINGUE DE DOUALA</h1>\n                    <h2>√âtat des Paiements</h2>\n                    <p><strong>Ann√©e scolaire:</strong> ${(schoolYear===null||schoolYear===void 0?void 0:schoolYear.name)||\"N/A\"}</p>\n                    <p><strong>P√©riode:</strong> ${periodText}</p>\n                    ${selectedSeries?`<p><strong>S√©rie:</strong> ${selectedSeries.name}</p>`:\"<p><strong>S√©rie:</strong> Toutes les s√©ries</p>\"}\n                    <p><strong>G√©n√©r√© le:</strong> ${new Date().toLocaleDateString(\"fr-FR\")} √† ${new Date().toLocaleTimeString(\"fr-FR\")}</p>\n                </div>\n                \n                <div class=\"stats-section\">\n                    <h3>R√©sum√© des Statistiques</h3>\n                    <div class=\"stats-grid\">\n                        <div class=\"stat-card\">\n                            <h4>Total des Paiements</h4>\n                            <p style=\"font-size: 24px; color: #007bff;\">${stats.total_payments||0}</p>\n                        </div>\n                        <div class=\"stat-card\">\n                            <h4>Montant Total</h4>\n                            <p style=\"font-size: 24px; color: #28a745;\">${parseInt(stats.total_amount||0).toLocaleString()} FCFA</p>\n                        </div>\n                    </div>\n                </div>\n                \n                <div class=\"payments-section\">\n                    <h3>D√©tail des Paiements</h3>\n                    <table>\n                        <thead>\n                            <tr>\n                                <th>Date</th>\n                                <th>Re√ßu N¬∞</th>\n                                <th>√âtudiant</th>\n                                <th>Classe</th>\n                                <th>Montant</th>\n                                <th>Mode</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            ${(payments||[]).map(payment=>`\n                                <tr>\n                                    <td>${payment.date||\"N/A\"}</td>\n                                    <td>${payment.receipt_number||\"N/A\"}</td>\n                                    <td>${payment.student_name||\"N/A\"}</td>\n                                    <td>${payment.class||\"N/A\"}</td>\n                                    <td class=\"text-right\">${parseInt(payment.amount||0).toLocaleString()} FCFA</td>\n                                    <td>${payment.method||\"N/A\"}</td>\n                                </tr>\n                            `).join(\"\")}\n                        </tbody>\n                    </table>\n                </div>\n                \n                ${Object.keys(stats.by_tranche||{}).length>0?`\n                <div class=\"tranches-section\">\n                    <h3>R√©partition par Tranche</h3>\n                    <table>\n                        <thead>\n                            <tr>\n                                <th>Tranche</th>\n                                <th>Nombre de Paiements</th>\n                                <th>Montant Total</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            ${Object.entries(stats.by_tranche).map(_ref=>{let[tranche,data]=_ref;return`\n                                <tr>\n                                    <td>${tranche}</td>\n                                    <td class=\"text-center\">${data.count}</td>\n                                    <td class=\"text-right\">${parseInt(data.amount).toLocaleString()} FCFA</td>\n                                </tr>\n                            `;}).join(\"\")}\n                        </tbody>\n                    </table>\n                </div>\n                `:\"\"}\n            </div>\n        `;};const formatAmount=amount=>{return parseInt(amount).toLocaleString()+\" FCFA\";};const formatDate=dateString=>{return new Date(dateString).toLocaleDateString(\"fr-FR\");};const getPaymentMethodLabel=function(method){let isRamePhysical=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(isRamePhysical){return\"Rame Physique\";}const methods={cash:\"Banque\",card:\"Carte\",transfer:\"Virement\",check:\"Ch√®que\"};return methods[method]||method;};return/*#__PURE__*/_jsxs(Container,{fluid:true,className:\"py-4\",children:[/*#__PURE__*/_jsx(Row,{className:\"mb-4\",children:/*#__PURE__*/_jsxs(Col,{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\xC9tats des Paiements\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted\",children:\"Consultez et exportez les rapports de paiements\"})]})}),/*#__PURE__*/_jsxs(Tab.Container,{defaultActiveKey:\"series-summary\",children:[/*#__PURE__*/_jsxs(Nav,{variant:\"pills\",className:\"mb-4\",children:[/*#__PURE__*/_jsx(Nav.Item,{children:/*#__PURE__*/_jsxs(Nav.Link,{eventKey:\"series-summary\",children:[/*#__PURE__*/_jsx(Building,{className:\"me-2\",size:16}),\"R\\xE9cap par S\\xE9rie\"]})}),/*#__PURE__*/_jsx(Nav.Item,{children:/*#__PURE__*/_jsxs(Nav.Link,{eventKey:\"detailed-payments\",children:[/*#__PURE__*/_jsx(FileText,{className:\"me-2\",size:16}),\"Paiements D\\xE9taill\\xE9s\"]})}),/*#__PURE__*/_jsx(Nav.Item,{children:/*#__PURE__*/_jsxs(Nav.Link,{eventKey:\"payment-listing\",children:[/*#__PURE__*/_jsx(Printer,{className:\"me-2\",size:16}),\"Listing des Paiements\"]})}),/*#__PURE__*/_jsx(Nav.Item,{children:/*#__PURE__*/_jsxs(Nav.Link,{eventKey:\"tranche-lists\",children:[/*#__PURE__*/_jsx(CheckSquare,{className:\"me-2\",size:16}),\"Listes par Tranches\"]})})]}),/*#__PURE__*/_jsxs(Tab.Content,{children:[/*#__PURE__*/_jsx(Tab.Pane,{eventKey:\"series-summary\",children:/*#__PURE__*/_jsx(SeriesCollectionSummary,{})}),/*#__PURE__*/_jsxs(Tab.Pane,{eventKey:\"detailed-payments\",children:[/*#__PURE__*/_jsxs(Card,{className:\"mb-4\",children:[/*#__PURE__*/_jsx(Card.Header,{children:/*#__PURE__*/_jsx(\"h5\",{className:\"mb-0\",children:\"Filtres de Recherche\"})}),/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:3,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Date de d\\xE9but\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"date\",value:filters.start_date,onChange:e=>handleFilterChange(\"start_date\",e.target.value)})]})}),/*#__PURE__*/_jsx(Col,{md:3,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Date de fin\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"date\",value:filters.end_date,onChange:e=>handleFilterChange(\"end_date\",e.target.value)})]})}),/*#__PURE__*/_jsx(Col,{md:4,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"S\\xE9rie (optionnel)\"}),/*#__PURE__*/_jsxs(Form.Select,{value:filters.series_id,onChange:e=>handleFilterChange(\"series_id\",e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Toutes les s\\xE9ries\"}),availableSeries.map(series=>/*#__PURE__*/_jsx(\"option\",{value:series.id,children:series.name},series.id))]})]})}),/*#__PURE__*/_jsx(Col,{md:2,className:\"d-flex align-items-end\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex gap-2 mb-3\",children:[/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:handleSearch,disabled:loading,children:loading?/*#__PURE__*/_jsx(Spinner,{animation:\"border\",size:\"sm\"}):/*#__PURE__*/_jsx(Search,{size:16})}),payments&&payments.length>0&&/*#__PURE__*/_jsx(Button,{variant:\"success\",onClick:handleExportPdf,children:/*#__PURE__*/_jsx(Printer,{size:16})})]})})]})})]}),error&&/*#__PURE__*/_jsx(Alert,{variant:\"danger\",dismissible:true,onClose:()=>setError(\"\"),children:error}),Object.keys(stats).length>0&&/*#__PURE__*/_jsxs(Row,{className:\"mb-4\",children:[/*#__PURE__*/_jsx(Col,{md:3,children:/*#__PURE__*/_jsx(Card,{className:\"text-center\",children:/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-primary\",children:stats.total_payments}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted mb-0\",children:\"Total Paiements\"})]})})}),/*#__PURE__*/_jsx(Col,{md:3,children:/*#__PURE__*/_jsx(Card,{className:\"text-center\",children:/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-success\",children:formatAmount(stats.total_amount||0)}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted mb-0\",children:\"Montant Total\"})]})})}),/*#__PURE__*/_jsx(Col,{md:3,children:/*#__PURE__*/_jsx(Card,{className:\"text-center\",children:/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-info\",children:Object.keys(stats.by_method||{}).length}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted mb-0\",children:\"Modes de Paiement\"})]})})}),/*#__PURE__*/_jsx(Col,{md:3,children:/*#__PURE__*/_jsx(Card,{className:\"text-center\",children:/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-warning\",children:Object.keys(stats.by_tranche||{}).length}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted mb-0\",children:\"Tranches Touch\\xE9es\"})]})})})]}),/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(Card.Header,{className:\"d-flex justify-content-between align-items-center\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"mb-0\",children:\"D\\xE9tail des Paiements\"}),payments&&payments.length>0&&/*#__PURE__*/_jsxs(Badge,{bg:\"info\",children:[payments.length,\" paiement(s)\"]})]}),/*#__PURE__*/_jsx(Card.Body,{children:loading?/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-4\",children:/*#__PURE__*/_jsx(Spinner,{animation:\"border\",role:\"status\",children:/*#__PURE__*/_jsx(\"span\",{className:\"visually-hidden\",children:\"Chargement...\"})})}):!payments||payments.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-muted text-center py-4\",children:\"Aucun paiement trouv\\xE9 pour les crit\\xE8res s\\xE9lectionn\\xE9s\"}):/*#__PURE__*/_jsxs(Table,{responsive:true,hover:true,children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Date\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Re\\xE7u N\\xB0\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\xC9tudiant\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Classe\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Montant\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Mode\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Tranches Affect\\xE9es\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:(payments||[]).map(payment=>{var _payment$payment_deta;return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:formatDate(payment.payment_date)}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"code\",{children:payment.receipt_number||\"N/A\"})}),/*#__PURE__*/_jsx(\"td\",{children:payment.student_name||\"N/A\"}),/*#__PURE__*/_jsx(\"td\",{children:payment.class||\"N/A\"}),/*#__PURE__*/_jsx(\"td\",{className:\"text-end\",children:/*#__PURE__*/_jsx(\"strong\",{children:formatAmount(payment.amount)})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Badge,{bg:payment.is_rame_physical?\"info\":\"secondary\",children:getPaymentMethodLabel(payment.payment_method,payment.is_rame_physical)})}),/*#__PURE__*/_jsx(\"td\",{children:((_payment$payment_deta=payment.payment_details)===null||_payment$payment_deta===void 0?void 0:_payment$payment_deta.map(detail=>/*#__PURE__*/_jsxs(Badge,{bg:\"primary\",className:\"me-1 mb-1\",children:[detail.payment_tranche.name,\":\",\" \",formatAmount(detail.amount_allocated)]},detail.id)))||/*#__PURE__*/_jsx(\"span\",{className:\"text-muted\",children:\"-\"})})]},payment.id);})})]})})]}),Object.keys(stats.by_tranche||{}).length>0&&/*#__PURE__*/_jsxs(Card,{className:\"mt-4\",children:[/*#__PURE__*/_jsx(Card.Header,{children:/*#__PURE__*/_jsx(\"h5\",{className:\"mb-0\",children:\"R\\xE9partition par Tranche de Paiement\"})}),/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(Table,{responsive:true,children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Tranche\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Nombre de Paiements\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Montant Total\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Pourcentage\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:Object.entries(stats.by_tranche).map(_ref2=>{let[tranche,data]=_ref2;return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:tranche}),/*#__PURE__*/_jsx(\"td\",{children:data.count}),/*#__PURE__*/_jsx(\"td\",{className:\"text-end\",children:/*#__PURE__*/_jsx(\"strong\",{children:formatAmount(data.amount)})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(Badge,{bg:\"info\",children:[(data.amount/stats.total_amount*100).toFixed(1),\"%\"]})})]},tranche);})})]})})]})]}),/*#__PURE__*/_jsx(Tab.Pane,{eventKey:\"payment-listing\",children:/*#__PURE__*/_jsx(PaymentListingReport,{})}),/*#__PURE__*/_jsx(Tab.Pane,{eventKey:\"tranche-lists\",children:/*#__PURE__*/_jsx(TrancheListsReport,{})})]})]})]});};// Composant pour le listing des paiements\nconst PaymentListingReport=()=>{const[listingData,setListingData]=useState(null);const[loading,setLoading]=useState(false);const[error,setError]=useState(\"\");const[classes,setClasses]=useState([]);const[listingFilters,setListingFilters]=useState({start_date:new Date().toISOString().split(\"T\")[0],end_date:new Date().toISOString().split(\"T\")[0],class_id:\"\"});useEffect(()=>{loadClasses();},[]);const loadClasses=async()=>{try{const response=await secureApiEndpoints.accountant.getClasses();if(response.success&&response.data&&response.data.classes){// L'API retourne: { success: true, data: { classes: [...], grouped_classes: {...} } }\nsetClasses(response.data.classes);}else{setClasses([]);}}catch(error){console.error(\"Erreur lors du chargement des classes:\",error);setClasses([]);// Assurer que classes est toujours un tableau\n}};const generateListing=async()=>{try{setLoading(true);setError(\"\");const response=await secureApiEndpoints.payments.generateListingReport({...listingFilters,format:\"html\"});if(response.success){setListingData(response.data);}else{setError(response.message||\"Erreur lors de la g√©n√©ration du listing\");}}catch(error){setError(\"Erreur lors de la g√©n√©ration du listing\");console.error(\"Erreur:\",error);}finally{setLoading(false);}};const downloadPDF=async()=>{try{setLoading(true);await secureApiEndpoints.payments.downloadListingReportPDF(listingFilters);}catch(error){setError(\"Erreur lors du t√©l√©chargement PDF\");console.error(\"Erreur:\",error);}finally{setLoading(false);}};const printReport=()=>{if(listingData!==null&&listingData!==void 0&&listingData.html){const printWindow=window.open(\"\",\"_blank\");printWindow.document.write(`\n        <!DOCTYPE html>\n        <html>\n        <head>\n          <title>Listing des Paiements</title>\n          <style>\n            body { font-family: Arial, sans-serif; margin: 0; padding: 10px; }\n            @media print { \n              body { margin: 0; }\n              .no-print { display: none !important; }\n            }\n          </style>\n        </head>\n        <body>\n          ${listingData.html}\n        </body>\n        </html>\n      `);printWindow.document.close();printWindow.print();}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(Card,{className:\"mb-4\",children:[/*#__PURE__*/_jsx(Card.Header,{children:/*#__PURE__*/_jsx(\"h5\",{className:\"mb-0\",children:\"Param\\xE8tres du Listing\"})}),/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:3,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Date de d\\xE9but\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"date\",value:listingFilters.start_date,onChange:e=>setListingFilters(prev=>({...prev,start_date:e.target.value}))})]})}),/*#__PURE__*/_jsx(Col,{md:3,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Date de fin\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"date\",value:listingFilters.end_date,onChange:e=>setListingFilters(prev=>({...prev,end_date:e.target.value}))})]})}),/*#__PURE__*/_jsx(Col,{md:3,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Classe (optionnel)\"}),/*#__PURE__*/_jsxs(Form.Select,{value:listingFilters.class_id,onChange:e=>setListingFilters(prev=>({...prev,class_id:e.target.value})),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Toutes les classes\"}),classes.map(classe=>/*#__PURE__*/_jsx(\"option\",{value:classe.id,children:classe.name},classe.id))]})]})}),/*#__PURE__*/_jsx(Col,{md:3,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"\\xA0\"}),/*#__PURE__*/_jsx(\"div\",{className:\"d-grid gap-2\",children:/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:generateListing,disabled:loading,children:loading?/*#__PURE__*/_jsx(Spinner,{animation:\"border\",size:\"sm\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Search,{className:\"me-2\",size:16}),\"G\\xE9n\\xE9rer\"]})})})]})})]}),listingData&&/*#__PURE__*/_jsx(Row,{className:\"mt-3\",children:/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex gap-2\",children:[/*#__PURE__*/_jsxs(Button,{variant:\"success\",onClick:downloadPDF,disabled:loading,children:[/*#__PURE__*/_jsx(FileText,{className:\"me-2\",size:16}),\"T\\xE9l\\xE9charger PDF\"]}),/*#__PURE__*/_jsxs(Button,{variant:\"info\",onClick:printReport,children:[/*#__PURE__*/_jsx(Printer,{className:\"me-2\",size:16}),\"Imprimer\"]})]})})})]})]}),error&&/*#__PURE__*/_jsx(Alert,{variant:\"danger\",className:\"mb-4\",children:error}),listingData&&/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(Card.Header,{className:\"d-flex justify-content-between align-items-center\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"mb-0\",children:\"R\\xE9sultats du Listing\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(Badge,{bg:\"primary\",className:\"me-2\",children:[listingData.summary.total_students,\" \\xE9tudiant(s)\"]}),/*#__PURE__*/_jsxs(Badge,{bg:\"success\",children:[new Intl.NumberFormat('fr-FR').format(listingData.summary.total_amount),\" FCFA\"]})]})]}),/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsx(\"div\",{dangerouslySetInnerHTML:{__html:listingData.html},style:{maxHeight:'600px',overflowY:'auto',border:'1px solid #dee2e6',padding:'15px'}})})]})]});};// Composant pour les listes de tranches\nconst TrancheListsReport=()=>{const[listingData,setListingData]=useState(null);const[loading,setLoading]=useState(false);const[error,setError]=useState(\"\");const[classes,setClasses]=useState([]);const[series,setSeries]=useState([]);const[tranches,setTranches]=useState([]);const[filters,setFilters]=useState({start_date:new Date().toISOString().split(\"T\")[0],end_date:new Date().toISOString().split(\"T\")[0],class_id:\"\",series_id:\"\",tranche_ids:[]});useEffect(()=>{loadClasses();loadTranches();},[]);// Charger les s√©ries quand une classe est s√©lectionn√©e\nuseEffect(()=>{if(filters.class_id){loadSeriesForClass(filters.class_id);}else{setSeries([]);setFilters(prev=>({...prev,series_id:\"\"}));}},[filters.class_id]);const loadClasses=async()=>{try{const response=await secureApiEndpoints.accountant.getClasses();if(response.success&&response.data&&response.data.classes){setClasses(response.data.classes);}else{setClasses([]);}}catch(error){console.error(\"Erreur lors du chargement des classes:\",error);setClasses([]);}};const loadSeriesForClass=async classId=>{try{const response=await secureApiEndpoints.accountant.getClasses();if(response.success&&response.data&&response.data.classes){const selectedClass=response.data.classes.find(cls=>cls.id==classId);if(selectedClass&&selectedClass.series){setSeries(selectedClass.series);}else{setSeries([]);}}}catch(error){console.error(\"Erreur lors du chargement des s√©ries:\",error);setSeries([]);}};const loadTranches=async()=>{try{const response=await secureApiEndpoints.payments.getTranches();if(response.success&&response.data){setTranches(response.data);// S√©lectionner toutes les tranches par d√©faut\nsetFilters(prev=>({...prev,tranche_ids:response.data.map(t=>t.id)}));}else{setTranches([]);}}catch(error){console.error(\"Erreur lors du chargement des tranches:\",error);setTranches([]);}};const handleTrancheToggle=trancheId=>{setFilters(prev=>({...prev,tranche_ids:prev.tranche_ids.includes(trancheId)?prev.tranche_ids.filter(id=>id!==trancheId):[...prev.tranche_ids,trancheId]}));};const selectAllTranches=()=>{setFilters(prev=>({...prev,tranche_ids:tranches.map(t=>t.id)}));};const deselectAllTranches=()=>{setFilters(prev=>({...prev,tranche_ids:[]}));};const generateListing=async()=>{if(filters.tranche_ids.length===0){setError(\"Veuillez s√©lectionner au moins une tranche\");return;}try{setLoading(true);setError(\"\");const response=await secureApiEndpoints.payments.generateTrancheListsReport({...filters,format:\"html\"});if(response.success){setListingData(response.data);}else{setError(response.message||\"Erreur lors de la g√©n√©ration du listing\");}}catch(error){setError(\"Erreur lors de la g√©n√©ration du listing\");console.error(\"Erreur:\",error);}finally{setLoading(false);}};const downloadPDF=async()=>{if(filters.tranche_ids.length===0){setError(\"Veuillez s√©lectionner au moins une tranche\");return;}try{setLoading(true);await secureApiEndpoints.payments.downloadTrancheListsReportPDF(filters);}catch(error){setError(\"Erreur lors du t√©l√©chargement PDF\");console.error(\"Erreur:\",error);}finally{setLoading(false);}};const printReport=()=>{if(listingData!==null&&listingData!==void 0&&listingData.html){const printWindow=window.open(\"\",\"_blank\");printWindow.document.write(`\n        <!DOCTYPE html>\n        <html>\n        <head>\n          <title>Listes des Tranches</title>\n          <style>\n            body { font-family: Arial, sans-serif; margin: 0; padding: 10px; }\n            @media print { \n              body { margin: 0; }\n              .no-print { display: none !important; }\n            }\n          </style>\n        </head>\n        <body>\n          ${listingData.html}\n        </body>\n        </html>\n      `);printWindow.document.close();printWindow.print();}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(Card,{className:\"mb-4\",children:[/*#__PURE__*/_jsx(Card.Header,{children:/*#__PURE__*/_jsx(\"h5\",{className:\"mb-0\",children:\"Param\\xE8tres des Listes par Tranches\"})}),/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:3,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Date de d\\xE9but\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"date\",value:filters.start_date,onChange:e=>setFilters(prev=>({...prev,start_date:e.target.value}))})]})}),/*#__PURE__*/_jsx(Col,{md:3,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Date de fin\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"date\",value:filters.end_date,onChange:e=>setFilters(prev=>({...prev,end_date:e.target.value}))})]})}),/*#__PURE__*/_jsx(Col,{md:3,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Classe (optionnel)\"}),/*#__PURE__*/_jsxs(Form.Select,{value:filters.class_id,onChange:e=>setFilters(prev=>({...prev,class_id:e.target.value})),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Toutes les classes\"}),classes.map(classe=>/*#__PURE__*/_jsx(\"option\",{value:classe.id,children:classe.name},classe.id))]})]})}),/*#__PURE__*/_jsx(Col,{md:3,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"S\\xE9rie (optionnel)\"}),/*#__PURE__*/_jsxs(Form.Select,{value:filters.series_id,onChange:e=>setFilters(prev=>({...prev,series_id:e.target.value})),disabled:!filters.class_id,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Toutes les s\\xE9ries\"}),series.map(serie=>/*#__PURE__*/_jsx(\"option\",{value:serie.id,children:serie.name},serie.id))]})]})})]}),/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{md:12,children:/*#__PURE__*/_jsx(Form.Group,{className:\"mb-3\",children:/*#__PURE__*/_jsx(\"div\",{className:\"d-grid gap-2\",style:{maxWidth:'200px'},children:/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:generateListing,disabled:loading||filters.tranche_ids.length===0,children:loading?/*#__PURE__*/_jsx(Spinner,{animation:\"border\",size:\"sm\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Search,{className:\"me-2\",size:16}),\"G\\xE9n\\xE9rer\"]})})})})})}),/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center mb-2\",children:[/*#__PURE__*/_jsxs(Form.Label,{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Tranches \\xE0 inclure :\"}),\" \",/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:\"(Seuls les \\xE9tudiants ayant pay\\xE9 ces tranches dans la p\\xE9riode seront affich\\xE9s)\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Button,{variant:\"outline-primary\",size:\"sm\",onClick:selectAllTranches,className:\"me-2\",children:\"Tout s\\xE9lectionner\"}),/*#__PURE__*/_jsx(Button,{variant:\"outline-secondary\",size:\"sm\",onClick:deselectAllTranches,children:\"Tout d\\xE9s\\xE9lectionner\"})]})]}),/*#__PURE__*/_jsx(\"div\",{style:{maxHeight:'150px',overflowY:'auto',border:'1px solid #dee2e6',padding:'10px',borderRadius:'5px'},children:/*#__PURE__*/_jsx(Row,{children:tranches.map(tranche=>/*#__PURE__*/_jsx(Col,{md:4,className:\"mb-2\",children:/*#__PURE__*/_jsx(Form.Check,{type:\"checkbox\",id:`tranche-${tranche.id}`,label:tranche.name,checked:filters.tranche_ids.includes(tranche.id),onChange:()=>handleTrancheToggle(tranche.id)})},tranche.id))})}),filters.tranche_ids.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-2\",children:/*#__PURE__*/_jsxs(Badge,{bg:\"info\",children:[filters.tranche_ids.length,\" tranche(s) s\\xE9lectionn\\xE9e(s)\"]})})]})})}),listingData&&/*#__PURE__*/_jsx(Row,{className:\"mt-3\",children:/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex gap-2\",children:[/*#__PURE__*/_jsxs(Button,{variant:\"success\",onClick:downloadPDF,disabled:loading,children:[/*#__PURE__*/_jsx(FileText,{className:\"me-2\",size:16}),\"T\\xE9l\\xE9charger PDF\"]}),/*#__PURE__*/_jsxs(Button,{variant:\"info\",onClick:printReport,children:[/*#__PURE__*/_jsx(Printer,{className:\"me-2\",size:16}),\"Imprimer\"]})]})})})]})]}),error&&/*#__PURE__*/_jsx(Alert,{variant:\"danger\",className:\"mb-4\",children:error}),listingData&&/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(Card.Header,{className:\"d-flex justify-content-between align-items-center\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"mb-0\",children:\"R\\xE9sultats du Listing par Tranches\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(Badge,{bg:\"primary\",className:\"me-2\",children:[listingData.summary.total_students,\" \\xE9tudiant(s)\"]}),/*#__PURE__*/_jsx(Badge,{bg:\"success\",children:listingData.summary.selected_tranches.join(', ')})]})]}),/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsx(\"div\",{dangerouslySetInnerHTML:{__html:listingData.html},style:{maxHeight:'600px',overflowY:'auto',border:'1px solid #dee2e6',padding:'15px'}})})]})]});};export default PaymentReports;","map":{"version":3,"names":["useEffect","useState","Alert","Badge","Button","Card","Col","Container","Form","Nav","Row","Spinner","Tab","Table","Building","FileText","Printer","Search","CheckSquare","secureApiEndpoints","SeriesCollectionSummary","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","PaymentReports","payments","setPayments","stats","setStats","schoolYear","setSchoolYear","availableSeries","setAvailableSeries","loading","setLoading","error","setError","filters","setFilters","start_date","end_date","series_id","loadAvailableSeries","today","Date","toISOString","split","prev","loadPaymentStats","response","accountant","getClasses","success","series","data","classes","forEach","schoolClass","length","serie","push","id","name","class_name","series_name","console","log","message","customFilters","arguments","undefined","queryFilters","getStats","recent_payments","school_year","handleFilterChange","field","value","handleSearch","handleExportPdf","printWindow","window","open","html","generateReportHtml","document","write","close","selectedSeries","find","s","periodText","toLocaleDateString","toLocaleTimeString","total_payments","parseInt","total_amount","toLocaleString","map","payment","date","receipt_number","student_name","class","amount","method","join","Object","keys","by_tranche","entries","_ref","tranche","count","formatAmount","formatDate","dateString","getPaymentMethodLabel","isRamePhysical","methods","cash","card","transfer","check","fluid","className","children","defaultActiveKey","variant","Item","Link","eventKey","size","Content","Pane","Header","Body","md","Group","Label","Control","type","onChange","e","target","Select","onClick","disabled","animation","dismissible","onClose","by_method","bg","role","responsive","hover","_payment$payment_deta","payment_date","is_rame_physical","payment_method","payment_details","detail","payment_tranche","amount_allocated","_ref2","toFixed","PaymentListingReport","TrancheListsReport","listingData","setListingData","setClasses","listingFilters","setListingFilters","class_id","loadClasses","generateListing","generateListingReport","format","downloadPDF","downloadListingReportPDF","printReport","print","classe","summary","total_students","Intl","NumberFormat","dangerouslySetInnerHTML","__html","style","maxHeight","overflowY","border","padding","setSeries","tranches","setTranches","tranche_ids","loadTranches","loadSeriesForClass","classId","selectedClass","cls","getTranches","t","handleTrancheToggle","trancheId","includes","filter","selectAllTranches","deselectAllTranches","generateTrancheListsReport","downloadTrancheListsReportPDF","maxWidth","borderRadius","Check","label","checked","selected_tranches"],"sources":["/var/www/College-IUP/front/src/pages/Payments/PaymentReports.jsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\nimport {\n  Alert,\n  Badge,\n  Button,\n  Card,\n  Col,\n  Container,\n  Form,\n  Nav,\n  Row,\n  Spinner,\n  Tab,\n  Table,\n} from \"react-bootstrap\";\nimport { Building, FileText, Printer, Search, CheckSquare } from \"react-bootstrap-icons\";\nimport { secureApiEndpoints } from \"../../utils/apiMigration\";\nimport SeriesCollectionSummary from \"../Reports/SeriesCollectionSummary\";\n\nconst PaymentReports = () => {\n  const [payments, setPayments] = useState([]);\n  const [stats, setStats] = useState({});\n  const [schoolYear, setSchoolYear] = useState(null);\n  const [availableSeries, setAvailableSeries] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(\"\");\n\n  const [filters, setFilters] = useState({\n    start_date: \"\",\n    end_date: \"\",\n    series_id: \"\",\n  });\n\n  useEffect(() => {\n    loadAvailableSeries();\n    // Charger les donn√©es du jour par d√©faut\n    const today = new Date().toISOString().split(\"T\")[0];\n    setFilters((prev) => ({\n      ...prev,\n      start_date: today,\n      end_date: today,\n    }));\n    loadPaymentStats({ start_date: today, end_date: today });\n  }, []);\n\n  const loadAvailableSeries = async () => {\n    try {\n      // R√©cup√©rer les classes avec leurs s√©ries\n      const response = await secureApiEndpoints.accountant.getClasses();\n      if (response.success) {\n        const series = [];\n\n        // La structure est: response.data.classes (array avec les relations)\n        response.data.classes.forEach((schoolClass) => {\n          if (schoolClass.series && schoolClass.series.length > 0) {\n            schoolClass.series.forEach((serie) => {\n              series.push({\n                id: serie.id,\n                name: `${schoolClass.name} - ${serie.name}`,\n                class_name: schoolClass.name,\n                series_name: serie.name,\n              });\n            });\n          }\n        });\n\n        setAvailableSeries(series);\n        console.log(\"Series loaded:\", series); // Debug\n      } else {\n        console.error(\"Error loading classes:\", response.message);\n      }\n    } catch (error) {\n      console.error(\"Error loading series:\", error);\n    }\n  };\n\n  const loadPaymentStats = async (customFilters = null) => {\n    try {\n      setLoading(true);\n      setError(\"\");\n\n      const queryFilters = customFilters || filters;\n      const response = await secureApiEndpoints.payments.getStats(queryFilters);\n\n      if (response.success) {\n        setPayments(response.data.recent_payments || []);\n        setStats(response.data);\n        setSchoolYear(response.data.school_year);\n      } else {\n        setError(response.message);\n      }\n    } catch (error) {\n      setError(\"Erreur lors du chargement des donn√©es\");\n      console.error(\"Error loading payment stats:\", error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleFilterChange = (field, value) => {\n    setFilters((prev) => ({\n      ...prev,\n      [field]: value,\n    }));\n  };\n\n  const handleSearch = () => {\n    if (\n      filters.start_date &&\n      filters.end_date &&\n      filters.start_date > filters.end_date\n    ) {\n      setError(\"La date de d√©but doit √™tre ant√©rieure √† la date de fin\");\n      return;\n    }\n    loadPaymentStats();\n  };\n\n  const handleExportPdf = () => {\n    const printWindow = window.open(\"\", \"_blank\");\n    const html = generateReportHtml();\n\n    printWindow.document.write(`\n            <html>\n                <head>\n                    <title>√âtat des Paiements</title>\n                    <style>\n                        @page {\n                            size: A4;\n                            margin: 1cm;\n                        }\n                        \n                        body { \n                            font-family: Arial, sans-serif; \n                            margin: 0;\n                            padding: 0;\n                            font-size: 11px;\n                            line-height: 1.3;\n                        }\n                        \n                        table { \n                            width: 100%; \n                            border-collapse: collapse; \n                            margin: 15px 0;\n                            font-size: 10px;\n                        }\n                        \n                        th, td { \n                            border: 1px solid #ddd; \n                            padding: 6px; \n                            text-align: left; \n                        }\n                        \n                        th { \n                            background-color: #f5f5f5; \n                            font-weight: bold; \n                            font-size: 10px;\n                        }\n                        \n                        .text-center { text-align: center; }\n                        .text-right { text-align: right; }\n                        \n                        .stats-grid { \n                            display: grid; \n                            grid-template-columns: repeat(2, 1fr); \n                            gap: 15px; \n                            margin: 15px 0; \n                        }\n                        \n                        .stat-card { \n                            border: 1px solid #ddd; \n                            padding: 10px; \n                            text-align: center;\n                            font-size: 12px;\n                        }\n                        \n                        .report-header {\n                            text-align: center;\n                            margin-bottom: 20px;\n                            border-bottom: 2px solid #333;\n                            padding-bottom: 15px;\n                        }\n                        \n                        .report-header h1 {\n                            font-size: 16px;\n                            margin: 5px 0;\n                        }\n                        \n                        .report-header h2 {\n                            font-size: 14px;\n                            margin: 5px 0;\n                        }\n                        \n                        .report-header p {\n                            font-size: 11px;\n                            margin: 3px 0;\n                        }\n                        \n                        @media print { \n                            body { \n                                margin: 0; \n                                -webkit-print-color-adjust: exact;\n                                print-color-adjust: exact;\n                            }\n                            .no-print { \n                                display: none !important; \n                            }\n                        }\n                        \n                        @media screen {\n                            body {\n                                background: #f0f0f0;\n                                padding: 20px;\n                            }\n                            \n                            .report-container {\n                                background: white;\n                                max-width: 210mm;\n                                margin: 0 auto;\n                                padding: 20px;\n                                box-shadow: 0 0 10px rgba(0,0,0,0.1);\n                            }\n                        }\n                    </style>\n                </head>\n                <body>\n                    <div class=\"report-container\">\n                        ${html}\n                    </div>\n                    <div class=\"no-print\" style=\"text-align: center; margin-top: 30px; background: white; padding: 20px;\">\n                        <button onclick=\"window.print()\" style=\"padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; margin-right: 10px;\">üìÑ Imprimer Rapport</button>\n                        <button onclick=\"window.close()\" style=\"padding: 10px 20px; background: #6c757d; color: white; border: none; border-radius: 5px; cursor: pointer;\">‚úñÔ∏è Fermer</button>\n                    </div>\n                </body>\n            </html>\n        `);\n    printWindow.document.close();\n  };\n\n  const generateReportHtml = () => {\n    const selectedSeries = availableSeries.find(\n      (s) => s.id == filters.series_id\n    );\n    const periodText =\n      filters.start_date && filters.end_date\n        ? `Du ${new Date(filters.start_date).toLocaleDateString(\n            \"fr-FR\"\n          )} au ${new Date(filters.end_date).toLocaleDateString(\"fr-FR\")}`\n        : \"Toutes les p√©riodes\";\n\n    return `\n            <div class=\"report\">\n                <div class=\"report-header text-center\" style=\"margin-bottom: 30px; border-bottom: 2px solid #333; padding-bottom: 20px;\">\n                    <h1>COLL√àGE POLYVALENT BILINGUE DE DOUALA</h1>\n                    <h2>√âtat des Paiements</h2>\n                    <p><strong>Ann√©e scolaire:</strong> ${\n                      schoolYear?.name || \"N/A\"\n                    }</p>\n                    <p><strong>P√©riode:</strong> ${periodText}</p>\n                    ${\n                      selectedSeries\n                        ? `<p><strong>S√©rie:</strong> ${selectedSeries.name}</p>`\n                        : \"<p><strong>S√©rie:</strong> Toutes les s√©ries</p>\"\n                    }\n                    <p><strong>G√©n√©r√© le:</strong> ${new Date().toLocaleDateString(\n                      \"fr-FR\"\n                    )} √† ${new Date().toLocaleTimeString(\"fr-FR\")}</p>\n                </div>\n                \n                <div class=\"stats-section\">\n                    <h3>R√©sum√© des Statistiques</h3>\n                    <div class=\"stats-grid\">\n                        <div class=\"stat-card\">\n                            <h4>Total des Paiements</h4>\n                            <p style=\"font-size: 24px; color: #007bff;\">${\n                              stats.total_payments || 0\n                            }</p>\n                        </div>\n                        <div class=\"stat-card\">\n                            <h4>Montant Total</h4>\n                            <p style=\"font-size: 24px; color: #28a745;\">${parseInt(\n                              stats.total_amount || 0\n                            ).toLocaleString()} FCFA</p>\n                        </div>\n                    </div>\n                </div>\n                \n                <div class=\"payments-section\">\n                    <h3>D√©tail des Paiements</h3>\n                    <table>\n                        <thead>\n                            <tr>\n                                <th>Date</th>\n                                <th>Re√ßu N¬∞</th>\n                                <th>√âtudiant</th>\n                                <th>Classe</th>\n                                <th>Montant</th>\n                                <th>Mode</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            ${(payments || [])\n                              .map(\n                                (payment) => `\n                                <tr>\n                                    <td>${payment.date || \"N/A\"}</td>\n                                    <td>${payment.receipt_number || \"N/A\"}</td>\n                                    <td>${payment.student_name || \"N/A\"}</td>\n                                    <td>${payment.class || \"N/A\"}</td>\n                                    <td class=\"text-right\">${parseInt(\n                                      payment.amount || 0\n                                    ).toLocaleString()} FCFA</td>\n                                    <td>${payment.method || \"N/A\"}</td>\n                                </tr>\n                            `\n                              )\n                              .join(\"\")}\n                        </tbody>\n                    </table>\n                </div>\n                \n                ${\n                  Object.keys(stats.by_tranche || {}).length > 0\n                    ? `\n                <div class=\"tranches-section\">\n                    <h3>R√©partition par Tranche</h3>\n                    <table>\n                        <thead>\n                            <tr>\n                                <th>Tranche</th>\n                                <th>Nombre de Paiements</th>\n                                <th>Montant Total</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            ${Object.entries(stats.by_tranche)\n                              .map(\n                                ([tranche, data]) => `\n                                <tr>\n                                    <td>${tranche}</td>\n                                    <td class=\"text-center\">${data.count}</td>\n                                    <td class=\"text-right\">${parseInt(\n                                      data.amount\n                                    ).toLocaleString()} FCFA</td>\n                                </tr>\n                            `\n                              )\n                              .join(\"\")}\n                        </tbody>\n                    </table>\n                </div>\n                `\n                    : \"\"\n                }\n            </div>\n        `;\n  };\n\n  const formatAmount = (amount) => {\n    return parseInt(amount).toLocaleString() + \" FCFA\";\n  };\n\n  const formatDate = (dateString) => {\n    return new Date(dateString).toLocaleDateString(\"fr-FR\");\n  };\n\n  const getPaymentMethodLabel = (method, isRamePhysical = false) => {\n    if (isRamePhysical) {\n      return \"Rame Physique\";\n    }\n    const methods = {\n      cash: \"Banque\",\n      card: \"Carte\",\n      transfer: \"Virement\",\n      check: \"Ch√®que\",\n    };\n    return methods[method] || method;\n  };\n\n  return (\n    <Container fluid className=\"py-4\">\n      {/* Header */}\n      <Row className=\"mb-4\">\n        <Col>\n          <h2>√âtats des Paiements</h2>\n          <p className=\"text-muted\">\n            Consultez et exportez les rapports de paiements\n          </p>\n        </Col>\n      </Row>\n\n      {/* Tabs */}\n      <Tab.Container defaultActiveKey=\"series-summary\">\n        <Nav variant=\"pills\" className=\"mb-4\">\n          <Nav.Item>\n            <Nav.Link eventKey=\"series-summary\">\n              <Building className=\"me-2\" size={16} />\n              R√©cap par S√©rie\n            </Nav.Link>\n          </Nav.Item>\n          <Nav.Item>\n            <Nav.Link eventKey=\"detailed-payments\">\n              <FileText className=\"me-2\" size={16} />\n              Paiements D√©taill√©s\n            </Nav.Link>\n          </Nav.Item>\n          <Nav.Item>\n            <Nav.Link eventKey=\"payment-listing\">\n              <Printer className=\"me-2\" size={16} />\n              Listing des Paiements\n            </Nav.Link>\n          </Nav.Item>\n          <Nav.Item>\n            <Nav.Link eventKey=\"tranche-lists\">\n              <CheckSquare className=\"me-2\" size={16} />\n              Listes par Tranches\n            </Nav.Link>\n          </Nav.Item>\n        </Nav>\n\n        <Tab.Content>\n          <Tab.Pane eventKey=\"series-summary\">\n            <SeriesCollectionSummary />\n          </Tab.Pane>\n\n          <Tab.Pane eventKey=\"detailed-payments\">\n            {/* Contenu existant des paiements d√©taill√©s */}\n\n            {/* Filters */}\n            <Card className=\"mb-4\">\n              <Card.Header>\n                <h5 className=\"mb-0\">Filtres de Recherche</h5>\n              </Card.Header>\n              <Card.Body>\n                <Row>\n                  <Col md={3}>\n                    <Form.Group className=\"mb-3\">\n                      <Form.Label>Date de d√©but</Form.Label>\n                      <Form.Control\n                        type=\"date\"\n                        value={filters.start_date}\n                        onChange={(e) =>\n                          handleFilterChange(\"start_date\", e.target.value)\n                        }\n                      />\n                    </Form.Group>\n                  </Col>\n                  <Col md={3}>\n                    <Form.Group className=\"mb-3\">\n                      <Form.Label>Date de fin</Form.Label>\n                      <Form.Control\n                        type=\"date\"\n                        value={filters.end_date}\n                        onChange={(e) =>\n                          handleFilterChange(\"end_date\", e.target.value)\n                        }\n                      />\n                    </Form.Group>\n                  </Col>\n                  <Col md={4}>\n                    <Form.Group className=\"mb-3\">\n                      <Form.Label>S√©rie (optionnel)</Form.Label>\n                      <Form.Select\n                        value={filters.series_id}\n                        onChange={(e) =>\n                          handleFilterChange(\"series_id\", e.target.value)\n                        }\n                      >\n                        <option value=\"\">Toutes les s√©ries</option>\n                        {availableSeries.map((series) => (\n                          <option key={series.id} value={series.id}>\n                            {series.name}\n                          </option>\n                        ))}\n                      </Form.Select>\n                    </Form.Group>\n                  </Col>\n                  <Col md={2} className=\"d-flex align-items-end\">\n                    <div className=\"d-flex gap-2 mb-3\">\n                      <Button\n                        variant=\"primary\"\n                        onClick={handleSearch}\n                        disabled={loading}\n                      >\n                        {loading ? (\n                          <Spinner animation=\"border\" size=\"sm\" />\n                        ) : (\n                          <Search size={16} />\n                        )}\n                      </Button>\n                      {payments && payments.length > 0 && (\n                        <Button variant=\"success\" onClick={handleExportPdf}>\n                          <Printer size={16} />\n                        </Button>\n                      )}\n                    </div>\n                  </Col>\n                </Row>\n              </Card.Body>\n            </Card>\n\n            {/* Error Alert */}\n            {error && (\n              <Alert variant=\"danger\" dismissible onClose={() => setError(\"\")}>\n                {error}\n              </Alert>\n            )}\n\n            {/* Statistics Cards */}\n            {Object.keys(stats).length > 0 && (\n              <Row className=\"mb-4\">\n                <Col md={3}>\n                  <Card className=\"text-center\">\n                    <Card.Body>\n                      <h3 className=\"text-primary\">{stats.total_payments}</h3>\n                      <p className=\"text-muted mb-0\">Total Paiements</p>\n                    </Card.Body>\n                  </Card>\n                </Col>\n                <Col md={3}>\n                  <Card className=\"text-center\">\n                    <Card.Body>\n                      <h3 className=\"text-success\">\n                        {formatAmount(stats.total_amount || 0)}\n                      </h3>\n                      <p className=\"text-muted mb-0\">Montant Total</p>\n                    </Card.Body>\n                  </Card>\n                </Col>\n                <Col md={3}>\n                  <Card className=\"text-center\">\n                    <Card.Body>\n                      <h3 className=\"text-info\">\n                        {Object.keys(stats.by_method || {}).length}\n                      </h3>\n                      <p className=\"text-muted mb-0\">Modes de Paiement</p>\n                    </Card.Body>\n                  </Card>\n                </Col>\n                <Col md={3}>\n                  <Card className=\"text-center\">\n                    <Card.Body>\n                      <h3 className=\"text-warning\">\n                        {Object.keys(stats.by_tranche || {}).length}\n                      </h3>\n                      <p className=\"text-muted mb-0\">Tranches Touch√©es</p>\n                    </Card.Body>\n                  </Card>\n                </Col>\n              </Row>\n            )}\n\n            {/* Payment Details */}\n            <Card>\n              <Card.Header className=\"d-flex justify-content-between align-items-center\">\n                <h5 className=\"mb-0\">D√©tail des Paiements</h5>\n                {payments && payments.length > 0 && (\n                  <Badge bg=\"info\">{payments.length} paiement(s)</Badge>\n                )}\n              </Card.Header>\n              <Card.Body>\n                {loading ? (\n                  <div className=\"text-center py-4\">\n                    <Spinner animation=\"border\" role=\"status\">\n                      <span className=\"visually-hidden\">Chargement...</span>\n                    </Spinner>\n                  </div>\n                ) : !payments || payments.length === 0 ? (\n                  <p className=\"text-muted text-center py-4\">\n                    Aucun paiement trouv√© pour les crit√®res s√©lectionn√©s\n                  </p>\n                ) : (\n                  <Table responsive hover>\n                    <thead>\n                      <tr>\n                        <th>Date</th>\n                        <th>Re√ßu N¬∞</th>\n                        <th>√âtudiant</th>\n                        <th>Classe</th>\n                        <th>Montant</th>\n                        <th>Mode</th>\n                        <th>Tranches Affect√©es</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      {(payments || []).map((payment) => (\n                        <tr key={payment.id}>\n                          <td>{formatDate(payment.payment_date)}</td>\n                          <td>\n                            <code>{payment.receipt_number || \"N/A\"}</code>\n                          </td>\n                          <td>{payment.student_name || \"N/A\"}</td>\n                          <td>{payment.class || \"N/A\"}</td>\n                          <td className=\"text-end\">\n                            <strong>{formatAmount(payment.amount)}</strong>\n                          </td>\n                          <td>\n                            <Badge\n                              bg={\n                                payment.is_rame_physical ? \"info\" : \"secondary\"\n                              }\n                            >\n                              {getPaymentMethodLabel(\n                                payment.payment_method,\n                                payment.is_rame_physical\n                              )}\n                            </Badge>\n                          </td>\n                          <td>\n                            {payment.payment_details?.map((detail) => (\n                              <Badge\n                                key={detail.id}\n                                bg=\"primary\"\n                                className=\"me-1 mb-1\"\n                              >\n                                {detail.payment_tranche.name}:{\" \"}\n                                {formatAmount(detail.amount_allocated)}\n                              </Badge>\n                            )) || <span className=\"text-muted\">-</span>}\n                          </td>\n                        </tr>\n                      ))}\n                    </tbody>\n                  </Table>\n                )}\n              </Card.Body>\n            </Card>\n\n            {/* Statistics by Tranche */}\n            {Object.keys(stats.by_tranche || {}).length > 0 && (\n              <Card className=\"mt-4\">\n                <Card.Header>\n                  <h5 className=\"mb-0\">R√©partition par Tranche de Paiement</h5>\n                </Card.Header>\n                <Card.Body>\n                  <Table responsive>\n                    <thead>\n                      <tr>\n                        <th>Tranche</th>\n                        <th>Nombre de Paiements</th>\n                        <th>Montant Total</th>\n                        <th>Pourcentage</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      {Object.entries(stats.by_tranche).map(\n                        ([tranche, data]) => (\n                          <tr key={tranche}>\n                            <td>{tranche}</td>\n                            <td>{data.count}</td>\n                            <td className=\"text-end\">\n                              <strong>{formatAmount(data.amount)}</strong>\n                            </td>\n                            <td>\n                              <Badge bg=\"info\">\n                                {(\n                                  (data.amount / stats.total_amount) *\n                                  100\n                                ).toFixed(1)}\n                                %\n                              </Badge>\n                            </td>\n                          </tr>\n                        )\n                      )}\n                    </tbody>\n                  </Table>\n                </Card.Body>\n              </Card>\n            )}\n          </Tab.Pane>\n\n          <Tab.Pane eventKey=\"payment-listing\">\n            <PaymentListingReport />\n          </Tab.Pane>\n\n          <Tab.Pane eventKey=\"tranche-lists\">\n            <TrancheListsReport />\n          </Tab.Pane>\n        </Tab.Content>\n      </Tab.Container>\n    </Container>\n  );\n};\n\n// Composant pour le listing des paiements\nconst PaymentListingReport = () => {\n  const [listingData, setListingData] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(\"\");\n  const [classes, setClasses] = useState([]);\n\n  const [listingFilters, setListingFilters] = useState({\n    start_date: new Date().toISOString().split(\"T\")[0],\n    end_date: new Date().toISOString().split(\"T\")[0],\n    class_id: \"\",\n  });\n\n  useEffect(() => {\n    loadClasses();\n  }, []);\n\n  const loadClasses = async () => {\n    try {\n      const response = await secureApiEndpoints.accountant.getClasses();\n      if (response.success && response.data && response.data.classes) {\n        // L'API retourne: { success: true, data: { classes: [...], grouped_classes: {...} } }\n        setClasses(response.data.classes);\n      } else {\n        setClasses([]);\n      }\n    } catch (error) {\n      console.error(\"Erreur lors du chargement des classes:\", error);\n      setClasses([]); // Assurer que classes est toujours un tableau\n    }\n  };\n\n  const generateListing = async () => {\n    try {\n      setLoading(true);\n      setError(\"\");\n\n      const response = await secureApiEndpoints.payments.generateListingReport({\n        ...listingFilters,\n        format: \"html\"\n      });\n\n      if (response.success) {\n        setListingData(response.data);\n      } else {\n        setError(response.message || \"Erreur lors de la g√©n√©ration du listing\");\n      }\n    } catch (error) {\n      setError(\"Erreur lors de la g√©n√©ration du listing\");\n      console.error(\"Erreur:\", error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const downloadPDF = async () => {\n    try {\n      setLoading(true);\n      await secureApiEndpoints.payments.downloadListingReportPDF(listingFilters);\n    } catch (error) {\n      setError(\"Erreur lors du t√©l√©chargement PDF\");\n      console.error(\"Erreur:\", error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const printReport = () => {\n    if (listingData?.html) {\n      const printWindow = window.open(\"\", \"_blank\");\n      printWindow.document.write(`\n        <!DOCTYPE html>\n        <html>\n        <head>\n          <title>Listing des Paiements</title>\n          <style>\n            body { font-family: Arial, sans-serif; margin: 0; padding: 10px; }\n            @media print { \n              body { margin: 0; }\n              .no-print { display: none !important; }\n            }\n          </style>\n        </head>\n        <body>\n          ${listingData.html}\n        </body>\n        </html>\n      `);\n      printWindow.document.close();\n      printWindow.print();\n    }\n  };\n\n  return (\n    <div>\n      <Card className=\"mb-4\">\n        <Card.Header>\n          <h5 className=\"mb-0\">Param√®tres du Listing</h5>\n        </Card.Header>\n        <Card.Body>\n          <Row>\n            <Col md={3}>\n              <Form.Group className=\"mb-3\">\n                <Form.Label>Date de d√©but</Form.Label>\n                <Form.Control\n                  type=\"date\"\n                  value={listingFilters.start_date}\n                  onChange={(e) =>\n                    setListingFilters(prev => ({\n                      ...prev,\n                      start_date: e.target.value\n                    }))\n                  }\n                />\n              </Form.Group>\n            </Col>\n            <Col md={3}>\n              <Form.Group className=\"mb-3\">\n                <Form.Label>Date de fin</Form.Label>\n                <Form.Control\n                  type=\"date\"\n                  value={listingFilters.end_date}\n                  onChange={(e) =>\n                    setListingFilters(prev => ({\n                      ...prev,\n                      end_date: e.target.value\n                    }))\n                  }\n                />\n              </Form.Group>\n            </Col>\n            <Col md={3}>\n              <Form.Group className=\"mb-3\">\n                <Form.Label>Classe (optionnel)</Form.Label>\n                <Form.Select\n                  value={listingFilters.class_id}\n                  onChange={(e) =>\n                    setListingFilters(prev => ({\n                      ...prev,\n                      class_id: e.target.value\n                    }))\n                  }\n                >\n                  <option value=\"\">Toutes les classes</option>\n                  {classes.map((classe) => (\n                    <option key={classe.id} value={classe.id}>\n                      {classe.name}\n                    </option>\n                  ))}\n                </Form.Select>\n              </Form.Group>\n            </Col>\n            <Col md={3}>\n              <Form.Group className=\"mb-3\">\n                <Form.Label>&nbsp;</Form.Label>\n                <div className=\"d-grid gap-2\">\n                  <Button\n                    variant=\"primary\"\n                    onClick={generateListing}\n                    disabled={loading}\n                  >\n                    {loading ? (\n                      <Spinner animation=\"border\" size=\"sm\" />\n                    ) : (\n                      <>\n                        <Search className=\"me-2\" size={16} />\n                        G√©n√©rer\n                      </>\n                    )}\n                  </Button>\n                </div>\n              </Form.Group>\n            </Col>\n          </Row>\n\n          {listingData && (\n            <Row className=\"mt-3\">\n              <Col>\n                <div className=\"d-flex gap-2\">\n                  <Button variant=\"success\" onClick={downloadPDF} disabled={loading}>\n                    <FileText className=\"me-2\" size={16} />\n                    T√©l√©charger PDF\n                  </Button>\n                  <Button variant=\"info\" onClick={printReport}>\n                    <Printer className=\"me-2\" size={16} />\n                    Imprimer\n                  </Button>\n                </div>\n              </Col>\n            </Row>\n          )}\n        </Card.Body>\n      </Card>\n\n      {error && (\n        <Alert variant=\"danger\" className=\"mb-4\">\n          {error}\n        </Alert>\n      )}\n\n      {listingData && (\n        <Card>\n          <Card.Header className=\"d-flex justify-content-between align-items-center\">\n            <h5 className=\"mb-0\">R√©sultats du Listing</h5>\n            <div>\n              <Badge bg=\"primary\" className=\"me-2\">\n                {listingData.summary.total_students} √©tudiant(s)\n              </Badge>\n              <Badge bg=\"success\">\n                {new Intl.NumberFormat('fr-FR').format(listingData.summary.total_amount)} FCFA\n              </Badge>\n            </div>\n          </Card.Header>\n          <Card.Body>\n            <div \n              dangerouslySetInnerHTML={{ __html: listingData.html }}\n              style={{ \n                maxHeight: '600px', \n                overflowY: 'auto',\n                border: '1px solid #dee2e6',\n                padding: '15px'\n              }}\n            />\n          </Card.Body>\n        </Card>\n      )}\n    </div>\n  );\n};\n\n// Composant pour les listes de tranches\nconst TrancheListsReport = () => {\n  const [listingData, setListingData] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(\"\");\n  const [classes, setClasses] = useState([]);\n  const [series, setSeries] = useState([]);\n  const [tranches, setTranches] = useState([]);\n\n  const [filters, setFilters] = useState({\n    start_date: new Date().toISOString().split(\"T\")[0],\n    end_date: new Date().toISOString().split(\"T\")[0],\n    class_id: \"\",\n    series_id: \"\",\n    tranche_ids: []\n  });\n\n  useEffect(() => {\n    loadClasses();\n    loadTranches();\n  }, []);\n\n  // Charger les s√©ries quand une classe est s√©lectionn√©e\n  useEffect(() => {\n    if (filters.class_id) {\n      loadSeriesForClass(filters.class_id);\n    } else {\n      setSeries([]);\n      setFilters(prev => ({ ...prev, series_id: \"\" }));\n    }\n  }, [filters.class_id]);\n\n  const loadClasses = async () => {\n    try {\n      const response = await secureApiEndpoints.accountant.getClasses();\n      if (response.success && response.data && response.data.classes) {\n        setClasses(response.data.classes);\n      } else {\n        setClasses([]);\n      }\n    } catch (error) {\n      console.error(\"Erreur lors du chargement des classes:\", error);\n      setClasses([]);\n    }\n  };\n\n  const loadSeriesForClass = async (classId) => {\n    try {\n      const response = await secureApiEndpoints.accountant.getClasses();\n      if (response.success && response.data && response.data.classes) {\n        const selectedClass = response.data.classes.find(cls => cls.id == classId);\n        if (selectedClass && selectedClass.series) {\n          setSeries(selectedClass.series);\n        } else {\n          setSeries([]);\n        }\n      }\n    } catch (error) {\n      console.error(\"Erreur lors du chargement des s√©ries:\", error);\n      setSeries([]);\n    }\n  };\n\n  const loadTranches = async () => {\n    try {\n      const response = await secureApiEndpoints.payments.getTranches();\n      if (response.success && response.data) {\n        setTranches(response.data);\n        // S√©lectionner toutes les tranches par d√©faut\n        setFilters(prev => ({\n          ...prev,\n          tranche_ids: response.data.map(t => t.id)\n        }));\n      } else {\n        setTranches([]);\n      }\n    } catch (error) {\n      console.error(\"Erreur lors du chargement des tranches:\", error);\n      setTranches([]);\n    }\n  };\n\n  const handleTrancheToggle = (trancheId) => {\n    setFilters(prev => ({\n      ...prev,\n      tranche_ids: prev.tranche_ids.includes(trancheId)\n        ? prev.tranche_ids.filter(id => id !== trancheId)\n        : [...prev.tranche_ids, trancheId]\n    }));\n  };\n\n  const selectAllTranches = () => {\n    setFilters(prev => ({\n      ...prev,\n      tranche_ids: tranches.map(t => t.id)\n    }));\n  };\n\n  const deselectAllTranches = () => {\n    setFilters(prev => ({\n      ...prev,\n      tranche_ids: []\n    }));\n  };\n\n  const generateListing = async () => {\n    if (filters.tranche_ids.length === 0) {\n      setError(\"Veuillez s√©lectionner au moins une tranche\");\n      return;\n    }\n\n    try {\n      setLoading(true);\n      setError(\"\");\n\n      const response = await secureApiEndpoints.payments.generateTrancheListsReport({\n        ...filters,\n        format: \"html\"\n      });\n\n      if (response.success) {\n        setListingData(response.data);\n      } else {\n        setError(response.message || \"Erreur lors de la g√©n√©ration du listing\");\n      }\n    } catch (error) {\n      setError(\"Erreur lors de la g√©n√©ration du listing\");\n      console.error(\"Erreur:\", error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const downloadPDF = async () => {\n    if (filters.tranche_ids.length === 0) {\n      setError(\"Veuillez s√©lectionner au moins une tranche\");\n      return;\n    }\n\n    try {\n      setLoading(true);\n      await secureApiEndpoints.payments.downloadTrancheListsReportPDF(filters);\n    } catch (error) {\n      setError(\"Erreur lors du t√©l√©chargement PDF\");\n      console.error(\"Erreur:\", error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const printReport = () => {\n    if (listingData?.html) {\n      const printWindow = window.open(\"\", \"_blank\");\n      printWindow.document.write(`\n        <!DOCTYPE html>\n        <html>\n        <head>\n          <title>Listes des Tranches</title>\n          <style>\n            body { font-family: Arial, sans-serif; margin: 0; padding: 10px; }\n            @media print { \n              body { margin: 0; }\n              .no-print { display: none !important; }\n            }\n          </style>\n        </head>\n        <body>\n          ${listingData.html}\n        </body>\n        </html>\n      `);\n      printWindow.document.close();\n      printWindow.print();\n    }\n  };\n\n  return (\n    <div>\n      <Card className=\"mb-4\">\n        <Card.Header>\n          <h5 className=\"mb-0\">Param√®tres des Listes par Tranches</h5>\n        </Card.Header>\n        <Card.Body>\n          <Row>\n            <Col md={3}>\n              <Form.Group className=\"mb-3\">\n                <Form.Label>Date de d√©but</Form.Label>\n                <Form.Control\n                  type=\"date\"\n                  value={filters.start_date}\n                  onChange={(e) =>\n                    setFilters(prev => ({\n                      ...prev,\n                      start_date: e.target.value\n                    }))\n                  }\n                />\n              </Form.Group>\n            </Col>\n            <Col md={3}>\n              <Form.Group className=\"mb-3\">\n                <Form.Label>Date de fin</Form.Label>\n                <Form.Control\n                  type=\"date\"\n                  value={filters.end_date}\n                  onChange={(e) =>\n                    setFilters(prev => ({\n                      ...prev,\n                      end_date: e.target.value\n                    }))\n                  }\n                />\n              </Form.Group>\n            </Col>\n            <Col md={3}>\n              <Form.Group className=\"mb-3\">\n                <Form.Label>Classe (optionnel)</Form.Label>\n                <Form.Select\n                  value={filters.class_id}\n                  onChange={(e) =>\n                    setFilters(prev => ({\n                      ...prev,\n                      class_id: e.target.value\n                    }))\n                  }\n                >\n                  <option value=\"\">Toutes les classes</option>\n                  {classes.map((classe) => (\n                    <option key={classe.id} value={classe.id}>\n                      {classe.name}\n                    </option>\n                  ))}\n                </Form.Select>\n              </Form.Group>\n            </Col>\n            <Col md={3}>\n              <Form.Group className=\"mb-3\">\n                <Form.Label>S√©rie (optionnel)</Form.Label>\n                <Form.Select\n                  value={filters.series_id}\n                  onChange={(e) =>\n                    setFilters(prev => ({\n                      ...prev,\n                      series_id: e.target.value\n                    }))\n                  }\n                  disabled={!filters.class_id}\n                >\n                  <option value=\"\">Toutes les s√©ries</option>\n                  {series.map((serie) => (\n                    <option key={serie.id} value={serie.id}>\n                      {serie.name}\n                    </option>\n                  ))}\n                </Form.Select>\n              </Form.Group>\n            </Col>\n          </Row>\n          \n          <Row>\n            <Col md={12}>\n              <Form.Group className=\"mb-3\">\n                <div className=\"d-grid gap-2\" style={{ maxWidth: '200px' }}>\n                  <Button\n                    variant=\"primary\"\n                    onClick={generateListing}\n                    disabled={loading || filters.tranche_ids.length === 0}\n                  >\n                    {loading ? (\n                      <Spinner animation=\"border\" size=\"sm\" />\n                    ) : (\n                      <>\n                        <Search className=\"me-2\" size={16} />\n                        G√©n√©rer\n                      </>\n                    )}\n                  </Button>\n                </div>\n              </Form.Group>\n            </Col>\n          </Row>\n\n          {/* S√©lection des tranches */}\n          <Row>\n            <Col>\n              <Form.Group className=\"mb-3\">\n                <div className=\"d-flex justify-content-between align-items-center mb-2\">\n                  <Form.Label><strong>Tranches √† inclure :</strong> <small className=\"text-muted\">(Seuls les √©tudiants ayant pay√© ces tranches dans la p√©riode seront affich√©s)</small></Form.Label>\n                  <div>\n                    <Button variant=\"outline-primary\" size=\"sm\" onClick={selectAllTranches} className=\"me-2\">\n                      Tout s√©lectionner\n                    </Button>\n                    <Button variant=\"outline-secondary\" size=\"sm\" onClick={deselectAllTranches}>\n                      Tout d√©s√©lectionner\n                    </Button>\n                  </div>\n                </div>\n                <div style={{ maxHeight: '150px', overflowY: 'auto', border: '1px solid #dee2e6', padding: '10px', borderRadius: '5px' }}>\n                  <Row>\n                    {tranches.map((tranche) => (\n                      <Col md={4} key={tranche.id} className=\"mb-2\">\n                        <Form.Check\n                          type=\"checkbox\"\n                          id={`tranche-${tranche.id}`}\n                          label={tranche.name}\n                          checked={filters.tranche_ids.includes(tranche.id)}\n                          onChange={() => handleTrancheToggle(tranche.id)}\n                        />\n                      </Col>\n                    ))}\n                  </Row>\n                </div>\n                {filters.tranche_ids.length > 0 && (\n                  <div className=\"mt-2\">\n                    <Badge bg=\"info\">\n                      {filters.tranche_ids.length} tranche(s) s√©lectionn√©e(s)\n                    </Badge>\n                  </div>\n                )}\n              </Form.Group>\n            </Col>\n          </Row>\n\n          {listingData && (\n            <Row className=\"mt-3\">\n              <Col>\n                <div className=\"d-flex gap-2\">\n                  <Button variant=\"success\" onClick={downloadPDF} disabled={loading}>\n                    <FileText className=\"me-2\" size={16} />\n                    T√©l√©charger PDF\n                  </Button>\n                  <Button variant=\"info\" onClick={printReport}>\n                    <Printer className=\"me-2\" size={16} />\n                    Imprimer\n                  </Button>\n                </div>\n              </Col>\n            </Row>\n          )}\n        </Card.Body>\n      </Card>\n\n      {error && (\n        <Alert variant=\"danger\" className=\"mb-4\">\n          {error}\n        </Alert>\n      )}\n\n      {listingData && (\n        <Card>\n          <Card.Header className=\"d-flex justify-content-between align-items-center\">\n            <h5 className=\"mb-0\">R√©sultats du Listing par Tranches</h5>\n            <div>\n              <Badge bg=\"primary\" className=\"me-2\">\n                {listingData.summary.total_students} √©tudiant(s)\n              </Badge>\n              <Badge bg=\"success\">\n                {listingData.summary.selected_tranches.join(', ')}\n              </Badge>\n            </div>\n          </Card.Header>\n          <Card.Body>\n            <div \n              dangerouslySetInnerHTML={{ __html: listingData.html }}\n              style={{ \n                maxHeight: '600px', \n                overflowY: 'auto',\n                border: '1px solid #dee2e6',\n                padding: '15px'\n              }}\n            />\n          </Card.Body>\n        </Card>\n      )}\n    </div>\n  );\n};\n\nexport default PaymentReports;\n"],"mappings":"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ACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0BH,IAAI;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,CAAC,CACNH,WAAW,CAACK,QAAQ,CAACE,KAAK,CAAC,CAAC,CAC9B,CAAC,CAED,KAAM,CAAAH,kBAAkB,CAAGA,CAAA,GAAM,CAC/B,KAAM,CAAAI,cAAc,CAAGzD,eAAe,CAAC0D,IAAI,CACxCC,CAAC,EAAKA,CAAC,CAAC7B,EAAE,EAAIxB,OAAO,CAACI,SACzB,CAAC,CACD,KAAM,CAAAkD,UAAU,CACdtD,OAAO,CAACE,UAAU,EAAIF,OAAO,CAACG,QAAQ,CAClC,MAAM,GAAI,CAAAI,IAAI,CAACP,OAAO,CAACE,UAAU,CAAC,CAACqD,kBAAkB,CACnD,OACF,CAAC,OAAO,GAAI,CAAAhD,IAAI,CAACP,OAAO,CAACG,QAAQ,CAAC,CAACoD,kBAAkB,CAAC,OAAO,CAAC,EAAE,CAChE,qBAAqB,CAE3B,MAAO;AACX;AACA;AACA;AACA;AACA,0DACsB,CAAA/D,UAAU,SAAVA,UAAU,iBAAVA,UAAU,CAAEiC,IAAI,GAAI,KAAK;AAC/C,mDACmD6B,UAAU;AAC7D,sBACsBH,cAAc,CACV,8BAA8BA,cAAc,CAAC1B,IAAI,MAAM,CACvD,kDAAkD;AAC5E,qDACqD,GAAI,CAAAlB,IAAI,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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}