{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Person,PencilSquare,Key,Shield,Envelope,Calendar,Building,Check,X,Eye,EyeSlash,Telephone,CameraFill,Trash}from'react-bootstrap-icons';import{useAuth}from'../../hooks/useAuth';import{secureApiEndpoints}from'../../utils/apiMigration';import{paramsTraductions}from'../../local/params';import{getLang}from'../../utils/lang';import PhoneInput from'../../components/PhoneInput';import Swal from'sweetalert2';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const UserProfile=()=>{const{user,updateUser}=useAuth();const[loading,setLoading]=useState(false);const[error,setError]=useState('');const[success,setSuccess]=useState('');const[activeTab,setActiveTab]=useState('profile');// School year data\nconst[availableYears,setAvailableYears]=useState([]);const[currentWorkingYear,setCurrentWorkingYear]=useState(null);const[yearLoading,setYearLoading]=useState(false);// Profile form data\nconst[profileData,setProfileData]=useState({name:'',email:'',contact:'',username:'',subname:'',phone_number:'',sex:'',matricule:''});// Avatar management\nconst[avatarData,setAvatarData]=useState({src:'assets/1.png',file:null,uploading:false});// Password form data\nconst[passwordData,setPasswordData]=useState({current_password:'',new_password:'',confirm_password:''});const[showPasswords,setShowPasswords]=useState({current:false,new:false,confirm:false});const[isEditing,setIsEditing]=useState(false);useEffect(()=>{if(user){setProfileData({name:user.name||'',email:user.email||'',contact:user.contact||'',username:user.username||'',subname:user.subname||'',phone_number:user.phone_number||'',sex:user.sex||'',matricule:user.matricule||''});// Load avatar if available (backend stores in 'photo' field)\nif(user.photo||user.avatar){setAvatarData(prev=>({...prev,src:user.photo||user.avatar}));}// Load school year data for admin and accountant\nif(user.role==='admin'||user.role==='accountant'){loadSchoolYearData();}}},[user]);const loadSchoolYearData=async()=>{try{setYearLoading(true);// Load available years\nconst yearsResponse=await secureApiEndpoints.schoolYears.getActiveYears();setAvailableYears(yearsResponse.data||[]);// Load current working year\nconst workingYearResponse=await secureApiEndpoints.schoolYears.getUserWorkingYear();setCurrentWorkingYear(workingYearResponse.data||null);}catch(error){console.error('Error loading school year data:',error);}finally{setYearLoading(false);}};const handleProfileSubmit=async e=>{e.preventDefault();try{setLoading(true);setError('');// Upload avatar first if changed (temporairement désactivé)\nif(avatarData.file){try{await handleAvatarUpload();}catch(error){console.log('Avatar upload disabled:',error.message);// Continue without failing the profile update\n}}const response=await secureApiEndpoints.auth.updateProfile(profileData);if(response.success){setSuccess(paramsTraductions[getLang()].profileUpdated||'Profil mis à jour avec succès');setIsEditing(false);// Update user in auth context\nupdateUser(response.data);Swal.fire({title:paramsTraductions[getLang()].success||'Succès',text:paramsTraductions[getLang()].profileUpdatedSuccess||'Votre profil a été mis à jour avec succès',icon:'success',timer:2000,showConfirmButton:false});}else{setError(response.message||paramsTraductions[getLang()].profileUpdateError||'Erreur lors de la mise à jour du profil');}}catch(error){console.error('Error updating profile:',error);setError(paramsTraductions[getLang()].profileUpdateError||'Erreur lors de la mise à jour du profil');}finally{setLoading(false);}};const handlePasswordSubmit=async e=>{e.preventDefault();// Validation\nif(passwordData.new_password!==passwordData.confirm_password){setError(paramsTraductions[getLang()].passwordMismatch||'Les nouveaux mots de passe ne correspondent pas');return;}if(passwordData.new_password.length<6){setError(paramsTraductions[getLang()].passwordTooShort||'Le nouveau mot de passe doit contenir au moins 6 caractères');return;}try{setLoading(true);setError('');const response=await secureApiEndpoints.auth.changePassword({current_password:passwordData.current_password,new_password:passwordData.new_password});if(response.success){setSuccess(paramsTraductions[getLang()].passwordChanged||'Mot de passe modifié avec succès');setPasswordData({current_password:'',new_password:'',confirm_password:''});Swal.fire({title:paramsTraductions[getLang()].success||'Succès',text:paramsTraductions[getLang()].passwordChangedSuccess||'Votre mot de passe a été modifié avec succès',icon:'success',timer:2000,showConfirmButton:false});}else{setError(response.message||paramsTraductions[getLang()].passwordChangeError||'Erreur lors de la modification du mot de passe');}}catch(error){console.error('Error changing password:',error);setError(paramsTraductions[getLang()].passwordChangeError||'Erreur lors de la modification du mot de passe');}finally{setLoading(false);}};// Avatar management functions\nconst handleAvatarChange=e=>{const file=e.target.files[0];if(file){// Validate file type\nif(!file.type.startsWith('image/')){setError(paramsTraductions[getLang()].invalidImageType||'Veuillez sélectionner un fichier image valide');return;}// Validate file size (max 2MB)\nif(file.size>2*1024*1024){setError(paramsTraductions[getLang()].imageTooLarge||'L\\'image ne doit pas dépasser 2MB');return;}const url=URL.createObjectURL(file);setAvatarData({src:url,file:file,uploading:false});}};const handleAvatarUpload=async()=>{if(!avatarData.file)return;try{setAvatarData(prev=>({...prev,uploading:true}));const formData=new FormData();formData.append('photo',avatarData.file);// Backend attend 'photo' et non 'avatar'\nconst response=await secureApiEndpoints.auth.uploadAvatar(formData);if(response.success){setAvatarData(prev=>({...prev,file:null,uploading:false,src:response.data.url||prev.src}));// Update user data with new avatar (backend uses 'photo' field)\nif(response.data.url){updateUser({...user,photo:response.data.url,avatar:response.data.url});}// Show success message\nsetSuccess(response.message||'Avatar uploadé avec succès');}else{throw new Error(response.message||'Erreur lors du téléchargement');}}catch(error){console.error('Error uploading avatar:',error);setError(error.message||paramsTraductions[getLang()].avatarUploadError||'Erreur lors du téléchargement de l\\'avatar');setAvatarData(prev=>({...prev,uploading:false}));}};const handleAvatarRemove=()=>{setAvatarData({src:'assets/1.png',file:null,uploading:false});};const handleWorkingYearChange=async yearId=>{try{setYearLoading(true);setError('');const response=await secureApiEndpoints.schoolYears.setUserWorkingYear(yearId);if(response.success){setCurrentWorkingYear(response.data);setSuccess(paramsTraductions[getLang()].workingYearUpdated||'Année de travail mise à jour avec succès');Swal.fire({title:paramsTraductions[getLang()].success||'Succès',text:paramsTraductions[getLang()].workingYearUpdatedSuccess||'Votre année de travail a été mise à jour avec succès',icon:'success',timer:2000,showConfirmButton:false});}else{setError(response.message||paramsTraductions[getLang()].workingYearUpdateError||'Erreur lors de la mise à jour de l\\'année de travail');}}catch(error){console.error('Error updating working year:',error);setError(paramsTraductions[getLang()].workingYearUpdateError||'Erreur lors de la mise à jour de l\\'année de travail');}finally{setYearLoading(false);}};const togglePasswordVisibility=field=>{setShowPasswords(prev=>({...prev,[field]:!prev[field]}));};const formatDate=dateString=>{if(!dateString)return'Non disponible';return new Date(dateString).toLocaleDateString('fr-FR',{year:'numeric',month:'long',day:'numeric'});};if(!user){return/*#__PURE__*/_jsx(\"div\",{className:\"container-fluid py-4\",children:/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-5\",children:/*#__PURE__*/_jsx(\"div\",{className:\"spinner-border\",role:\"status\",children:/*#__PURE__*/_jsx(\"span\",{className:\"visually-hidden\",children:\"Chargement...\"})})})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"container-fluid py-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"row mb-4\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-12\",children:/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-between align-items-center\",children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"h4 mb-1\",children:\"Mon Profil\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted mb-0\",children:\"G\\xE9rez vos informations personnelles et vos param\\xE8tres de s\\xE9curit\\xE9\"})]})})})}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"row mb-3\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-12\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"alert alert-danger alert-dismissible fade show\",role:\"alert\",children:[error,/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-close\",onClick:()=>setError(''),\"aria-label\":\"Close\"})]})})}),success&&/*#__PURE__*/_jsx(\"div\",{className:\"row mb-3\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-12\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"alert alert-success alert-dismissible fade show\",role:\"alert\",children:[success,/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-close\",onClick:()=>setSuccess(''),\"aria-label\":\"Close\"})]})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-3 mb-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-body text-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"position-relative mx-auto mb-3\",style:{width:'80px',height:'80px'},children:[/*#__PURE__*/_jsx(\"img\",{src:avatarData.src,alt:\"Avatar\",className:\"rounded-circle w-100 h-100 object-fit-cover border\",style:{objectFit:'cover'}}),avatarData.uploading&&/*#__PURE__*/_jsx(\"div\",{className:\"position-absolute top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center bg-dark bg-opacity-50 rounded-circle\",children:/*#__PURE__*/_jsx(\"div\",{className:\"spinner-border spinner-border-sm text-white\",role:\"status\"})})]}),/*#__PURE__*/_jsx(\"h5\",{className:\"card-title\",children:user.role==='admin'||user.role==='accountant'?user.username||user.name:user.name&&user.subname?`${user.name} ${user.subname}`:user.name}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted small mb-2\",children:user.role==='admin'||user.role==='accountant'?user.email:user.matricule}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-center gap-1 mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:`badge ${user.is_active?'bg-success':'bg-secondary'}`,children:user.is_active?'Actif':'Inactif'}),/*#__PURE__*/_jsx(\"span\",{className:\"badge bg-primary\",children:user.role==='admin'?paramsTraductions[getLang()].admin||'Admin':user.role==='accountant'?paramsTraductions[getLang()].accountant||'Comptable':user.role==='teacher'?paramsTraductions[getLang()].teacher||'Enseignant':'Utilisateur'})]}),(user.role==='admin'||user.role==='accountant')&&user.username&&/*#__PURE__*/_jsxs(\"small\",{className:\"text-muted\",children:[\"@\",user.username]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"list-group mt-3\",children:[/*#__PURE__*/_jsxs(\"button\",{className:`list-group-item list-group-item-action d-flex align-items-center ${activeTab==='profile'?'active':''}`,onClick:()=>setActiveTab('profile'),children:[/*#__PURE__*/_jsx(Person,{size:16,className:\"me-2\"}),\"Informations personnelles\"]}),/*#__PURE__*/_jsxs(\"button\",{className:`list-group-item list-group-item-action d-flex align-items-center ${activeTab==='security'?'active':''}`,onClick:()=>setActiveTab('security'),children:[/*#__PURE__*/_jsx(Shield,{size:16,className:\"me-2\"}),\"S\\xE9curit\\xE9\"]}),(user.role==='admin'||user.role==='accountant')&&/*#__PURE__*/_jsxs(\"button\",{className:`list-group-item list-group-item-action d-flex align-items-center ${activeTab==='working-year'?'active':''}`,onClick:()=>setActiveTab('working-year'),children:[/*#__PURE__*/_jsx(Calendar,{size:16,className:\"me-2\"}),\"Ann\\xE9e de travail\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-9\",children:[activeTab==='profile'&&/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card-header d-flex justify-content-between align-items-center\",children:[/*#__PURE__*/_jsxs(\"h5\",{className:\"mb-0\",children:[/*#__PURE__*/_jsx(Person,{size:20,className:\"me-2\"}),\"Informations personnelles\"]}),!isEditing&&/*#__PURE__*/_jsxs(\"button\",{className:\"btn btn-outline-primary btn-sm\",onClick:()=>setIsEditing(true),children:[/*#__PURE__*/_jsx(PencilSquare,{size:14,className:\"me-1\"}),\"Modifier\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"card-body\",children:isEditing?/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleProfileSubmit,children:[/*#__PURE__*/_jsx(\"div\",{className:\"row mb-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"col-12 text-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"position-relative d-inline-block\",children:[/*#__PURE__*/_jsx(\"img\",{src:avatarData.src,alt:\"Avatar\",className:\"rounded-circle border\",style:{width:'120px',height:'120px',objectFit:'cover'}}),/*#__PURE__*/_jsx(\"div\",{className:\"position-absolute bottom-0 end-0\",children:/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"avatar-upload\",className:\"btn btn-primary btn-sm rounded-circle p-2\",style:{cursor:'pointer'},children:[/*#__PURE__*/_jsx(CameraFill,{size:16}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"avatar-upload\",accept:\"image/*\",onChange:handleAvatarChange,style:{display:'none'}})]})}),avatarData.file&&/*#__PURE__*/_jsx(\"div\",{className:\"position-absolute top-0 start-100 translate-middle\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-danger btn-sm rounded-circle p-1\",onClick:handleAvatarRemove,title:\"Supprimer\",children:/*#__PURE__*/_jsx(Trash,{size:12})})}),avatarData.uploading&&/*#__PURE__*/_jsx(\"div\",{className:\"position-absolute top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center bg-dark bg-opacity-50 rounded-circle\",children:/*#__PURE__*/_jsx(\"div\",{className:\"spinner-border spinner-border-sm text-white\",role:\"status\"})})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted small mt-2 mb-0\",children:paramsTraductions[getLang()].clickToChangeAvatar||'Cliquez sur l\\'icône pour changer votre photo'})]})}),user.role==='admin'||user.role==='accountant'?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-md-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"form-label\",children:[paramsTraductions[getLang()].username||'Nom d\\'utilisateur',\" *\"]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",value:profileData.username,onChange:e=>setProfileData({...profileData,username:e.target.value}),required:true})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-md-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"form-label\",children:[paramsTraductions[getLang()].email||'Email',\" *\"]}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",className:\"form-control\",value:profileData.email,onChange:e=>setProfileData({...profileData,email:e.target.value}),required:true})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-md-6\",children:/*#__PURE__*/_jsx(PhoneInput,{label:paramsTraductions[getLang()].number||'Téléphone',value:profileData.contact||profileData.phone_number,onChange:e=>{const value=e.target.value;setProfileData({...profileData,contact:value,phone_number:value});},placeholder:\"+237 6XX XXX XXX\",className:\"mb-3\",showSuggestions:true})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-md-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:paramsTraductions[getLang()].name||'Nom complet'}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",value:profileData.name,onChange:e=>setProfileData({...profileData,name:e.target.value}),placeholder:\"Votre nom complet\"})]})})]})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-md-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"form-label\",children:[paramsTraductions[getLang()].teacherName||'Nom',\" *\"]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",value:profileData.name,onChange:e=>setProfileData({...profileData,name:e.target.value}),required:true})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-md-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"form-label\",children:[paramsTraductions[getLang()].teacherSubname||'Prénom',\" *\"]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",value:profileData.subname,onChange:e=>setProfileData({...profileData,subname:e.target.value}),required:true})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-md-6\",children:/*#__PURE__*/_jsx(PhoneInput,{label:paramsTraductions[getLang()].number||'Téléphone',value:profileData.phone_number,onChange:e=>{const value=e.target.value;setProfileData({...profileData,phone_number:value,contact:value});},placeholder:\"+237 6XX XXX XXX\",className:\"mb-3\",showSuggestions:true})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-md-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:paramsTraductions[getLang()].sex||'Sexe'}),/*#__PURE__*/_jsxs(\"select\",{className:\"form-select\",value:profileData.sex,onChange:e=>setProfileData({...profileData,sex:e.target.value}),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:paramsTraductions[getLang()].selectSex||'Sélectionner...'}),/*#__PURE__*/_jsx(\"option\",{value:\"m\",children:paramsTraductions[getLang()].m||'Masculin'}),/*#__PURE__*/_jsx(\"option\",{value:\"f\",children:paramsTraductions[getLang()].f||'Féminin'})]})]})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary\",disabled:loading,children:loading?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"spinner-border spinner-border-sm me-2\",role:\"status\"}),\"Mise \\xE0 jour...\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Check,{size:16,className:\"me-1\"}),paramsTraductions[getLang()].save||'Enregistrer']})}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:\"btn btn-outline-secondary\",onClick:()=>{setIsEditing(false);setProfileData({name:user.name||'',email:user.email||'',contact:user.contact||'',username:user.username||'',subname:user.subname||'',phone_number:user.phone_number||'',sex:user.sex||'',matricule:user.matricule||''});handleAvatarRemove();},children:[/*#__PURE__*/_jsx(X,{size:16,className:\"me-1\"}),paramsTraductions[getLang()].cancel||'Annuler']})]})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-12 text-center mb-4\",children:/*#__PURE__*/_jsx(\"img\",{src:avatarData.src,alt:\"Avatar\",className:\"rounded-circle border\",style:{width:'120px',height:'120px',objectFit:'cover'}})}),user.role==='admin'||user.role==='accountant'?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label text-muted\",children:paramsTraductions[getLang()].username||'Nom d\\'utilisateur'}),/*#__PURE__*/_jsxs(\"p\",{className:\"fw-medium d-flex align-items-center gap-1\",children:[/*#__PURE__*/_jsx(Person,{size:16,className:\"me-1\"}),user.username||'Non défini']})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label text-muted\",children:paramsTraductions[getLang()].email||'Email'}),/*#__PURE__*/_jsxs(\"p\",{className:\"fw-medium d-flex align-items-center gap-1\",children:[/*#__PURE__*/_jsx(Envelope,{size:16,className:\"me-1\"}),user.email]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label text-muted\",children:paramsTraductions[getLang()].number||'Téléphone'}),/*#__PURE__*/_jsxs(\"p\",{className:\"fw-medium d-flex align-items-center gap-1\",children:[/*#__PURE__*/_jsx(Telephone,{size:16,className:\"me-1\"}),user.contact||user.phone_number||'Non renseigné']})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label text-muted\",children:paramsTraductions[getLang()].name||'Nom complet'}),/*#__PURE__*/_jsxs(\"p\",{className:\"fw-medium d-flex align-items-center gap-1\",children:[/*#__PURE__*/_jsx(Person,{size:16,className:\"me-1\"}),user.name||'Non défini']})]})]})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label text-muted\",children:paramsTraductions[getLang()].teacherName||'Nom'}),/*#__PURE__*/_jsxs(\"p\",{className:\"fw-medium d-flex align-items-center gap-1\",children:[/*#__PURE__*/_jsx(Person,{size:16,className:\"me-1\"}),user.name]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label text-muted\",children:paramsTraductions[getLang()].teacherSubname||'Prénom'}),/*#__PURE__*/_jsxs(\"p\",{className:\"fw-medium d-flex align-items-center gap-1\",children:[/*#__PURE__*/_jsx(Person,{size:16,className:\"me-1\"}),user.subname]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label text-muted\",children:paramsTraductions[getLang()].number||'Téléphone'}),/*#__PURE__*/_jsxs(\"p\",{className:\"fw-medium d-flex align-items-center gap-1\",children:[/*#__PURE__*/_jsx(Telephone,{size:16,className:\"me-1\"}),user.phone_number||user.contact||'Non renseigné']})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label text-muted\",children:paramsTraductions[getLang()].matricule||'Matricule'}),/*#__PURE__*/_jsxs(\"p\",{className:\"fw-medium d-flex align-items-center gap-1\",children:[/*#__PURE__*/_jsx(Building,{size:16,className:\"me-1\"}),user.matricule||'Non défini']})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label text-muted\",children:paramsTraductions[getLang()].sex||'Sexe'}),/*#__PURE__*/_jsx(\"p\",{className:\"fw-medium d-flex align-items-center gap-1\",children:user.sex==='m'?paramsTraductions[getLang()].m||'Masculin':user.sex==='f'?paramsTraductions[getLang()].f||'Féminin':'Non défini'})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-12\",children:[/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-md-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label text-muted\",children:\"Date de cr\\xE9ation\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"fw-medium d-flex align-items-center gap-1\",children:[/*#__PURE__*/_jsx(Calendar,{size:16,className:\"me-1\"}),formatDate(user.created_at)]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-md-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label text-muted\",children:\"R\\xF4le\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"fw-medium d-flex align-items-center gap-1\",children:[/*#__PURE__*/_jsx(Building,{size:16,className:\"me-1\"}),user.role==='admin'?'Administrateur':user.role==='accountant'?'Comptable':user.role==='teacher'?'Enseignant':'Utilisateur']})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-md-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label text-muted\",children:\"Nom d'utilisateur\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"fw-medium d-flex align-items-center gap-1\",children:[/*#__PURE__*/_jsx(Person,{size:16,className:\"me-1\"}),user.username||'Non défini']})]})})]}),(user.role==='admin'||user.role==='accountant')&&/*#__PURE__*/_jsx(\"div\",{className:\"row mt-3\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-12\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"alert alert-info\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Informations d'acc\\xE8s :\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"mb-0 mt-2\",children:[/*#__PURE__*/_jsx(\"li\",{children:\"Acc\\xE8s complet aux fonctionnalit\\xE9s du syst\\xE8me\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Gestion des ann\\xE9es scolaires\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Configuration de l'ann\\xE9e de travail personnalis\\xE9e\"}),user.role==='admin'&&/*#__PURE__*/_jsx(\"li\",{children:\"Administration compl\\xE8te du syst\\xE8me\"}),user.role==='accountant'&&/*#__PURE__*/_jsx(\"li\",{children:\"Gestion financi\\xE8re et comptable\"})]})]})})}),user.role==='teacher'&&/*#__PURE__*/_jsx(\"div\",{className:\"row mt-3\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-12\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"alert alert-success\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Profil Enseignant :\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"mb-0 mt-2\",children:[/*#__PURE__*/_jsx(\"li\",{children:\"Gestion des \\xE9l\\xE8ves de vos classes\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Suivi p\\xE9dagogique et \\xE9valuations\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Acc\\xE8s aux outils d'enseignement\"})]})]})})}),(user.role==='admin'||user.role==='accountant')&&currentWorkingYear&&/*#__PURE__*/_jsx(\"div\",{className:\"row mt-3\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-12\",children:/*#__PURE__*/_jsx(\"div\",{className:\"card bg-light\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-body\",children:[/*#__PURE__*/_jsxs(\"h6\",{className:\"card-title mb-2  d-flex align-items-center gap-1\",children:[/*#__PURE__*/_jsx(Calendar,{size:18,className:\"me-2 text-primary\"}),\"Ann\\xE9e de travail actuelle\"]}),/*#__PURE__*/_jsxs(\"p\",{className:\"card-text mb-0\",children:[/*#__PURE__*/_jsx(\"strong\",{children:currentWorkingYear.name}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-muted ms-2\",children:[\"(\",new Date(currentWorkingYear.start_date).toLocaleDateString('fr-FR'),\" -\",new Date(currentWorkingYear.end_date).toLocaleDateString('fr-FR'),\")\"]})]}),/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:\"Cette ann\\xE9e est utilis\\xE9e pour l'affichage des donn\\xE9es et l'ajout de nouveaux \\xE9l\\xE9ments.\"})]})})})})]})]})})]}),activeTab==='security'&&/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header\",children:/*#__PURE__*/_jsxs(\"h5\",{className:\"mb-0 d-flex align-items-center gap-1\",children:[/*#__PURE__*/_jsx(Key,{size:20,className:\"me-2\"}),\"Changer le mot de passe\"]})}),/*#__PURE__*/_jsx(\"div\",{className:\"card-body\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handlePasswordSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Mot de passe actuel *\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group\",children:[/*#__PURE__*/_jsx(\"input\",{type:showPasswords.current?\"text\":\"password\",className:\"form-control\",value:passwordData.current_password,onChange:e=>setPasswordData({...passwordData,current_password:e.target.value}),required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-outline-secondary\",onClick:()=>togglePasswordVisibility('current'),children:showPasswords.current?/*#__PURE__*/_jsx(EyeSlash,{size:16}):/*#__PURE__*/_jsx(Eye,{size:16})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Nouveau mot de passe *\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group\",children:[/*#__PURE__*/_jsx(\"input\",{type:showPasswords.new?\"text\":\"password\",className:\"form-control\",value:passwordData.new_password,onChange:e=>setPasswordData({...passwordData,new_password:e.target.value}),required:true,minLength:\"6\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-outline-secondary\",onClick:()=>togglePasswordVisibility('new'),children:showPasswords.new?/*#__PURE__*/_jsx(EyeSlash,{size:16}):/*#__PURE__*/_jsx(Eye,{size:16})})]}),/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:\"Au moins 6 caract\\xE8res\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Confirmer le nouveau mot de passe *\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group\",children:[/*#__PURE__*/_jsx(\"input\",{type:showPasswords.confirm?\"text\":\"password\",className:\"form-control\",value:passwordData.confirm_password,onChange:e=>setPasswordData({...passwordData,confirm_password:e.target.value}),required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-outline-secondary\",onClick:()=>togglePasswordVisibility('confirm'),children:showPasswords.confirm?/*#__PURE__*/_jsx(EyeSlash,{size:16}):/*#__PURE__*/_jsx(Eye,{size:16})})]})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary\",disabled:loading,children:loading?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"spinner-border spinner-border-sm me-2\",role:\"status\"}),\"Modification...\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Key,{size:16,className:\"me-1\"}),\"Changer le mot de passe\"]})})]})})]}),activeTab==='working-year'&&(user.role==='admin'||user.role==='accountant')&&/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header\",children:/*#__PURE__*/_jsxs(\"h5\",{className:\"mb-0  d-flex align-items-center gap-1\",children:[/*#__PURE__*/_jsx(Calendar,{size:20,className:\"me-2\"}),\"Ann\\xE9e de travail\"]})}),/*#__PURE__*/_jsx(\"div\",{className:\"card-body\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-8\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-muted mb-3\",children:\"Choisissez l'ann\\xE9e scolaire dans laquelle vous souhaitez travailler. Cette s\\xE9lection sera m\\xE9moris\\xE9e et utilis\\xE9e dans toutes les fonctionnalit\\xE9s du syst\\xE8me.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Ann\\xE9e scolaire actuelle\"}),/*#__PURE__*/_jsx(\"div\",{className:\"p-3 bg-light rounded\",children:currentWorkingYear?/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center\",children:[/*#__PURE__*/_jsx(Calendar,{size:18,className:\"me-2 text-primary\"}),/*#__PURE__*/_jsx(\"strong\",{children:currentWorkingYear.name}),/*#__PURE__*/_jsxs(\"span\",{className:\"ms-2 text-muted\",children:[\"(\",new Date(currentWorkingYear.start_date).toLocaleDateString('fr-FR'),\" -\",new Date(currentWorkingYear.end_date).toLocaleDateString('fr-FR'),\")\"]})]}):/*#__PURE__*/_jsx(\"span\",{className:\"text-muted\",children:\"Aucune ann\\xE9e s\\xE9lectionn\\xE9e\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Changer d'ann\\xE9e de travail\"}),/*#__PURE__*/_jsxs(\"select\",{className:\"form-select\",value:(currentWorkingYear===null||currentWorkingYear===void 0?void 0:currentWorkingYear.id)||'',onChange:e=>handleWorkingYearChange(e.target.value),disabled:yearLoading,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"S\\xE9lectionner une ann\\xE9e...\"}),availableYears.map(year=>/*#__PURE__*/_jsxs(\"option\",{value:year.id,children:[year.name,\" (\",new Date(year.start_date).toLocaleDateString('fr-FR'),\" -\",new Date(year.end_date).toLocaleDateString('fr-FR'),\")\",year.is_current&&' (Année courante)']},year.id))]}),yearLoading&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"spinner-border spinner-border-sm me-2\",role:\"status\"}),\"Mise \\xE0 jour en cours...\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"alert alert-info\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Note:\"}),\" Le changement d'ann\\xE9e de travail affectera:\",/*#__PURE__*/_jsxs(\"ul\",{className:\"mb-0 mt-2\",children:[/*#__PURE__*/_jsx(\"li\",{children:\"Les statistiques et rapports affich\\xE9s\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Les listes d'\\xE9l\\xE8ves et leurs donn\\xE9es\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Les calculs de paiements et frais\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Toutes les fonctionnalit\\xE9s li\\xE9es aux donn\\xE9es acad\\xE9miques\"})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"col-md-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-light p-3 rounded\",children:[/*#__PURE__*/_jsx(\"h6\",{className:\"fw-bold mb-3\",children:\"Ann\\xE9es disponibles\"}),availableYears.length>0?/*#__PURE__*/_jsx(\"ul\",{className:\"list-unstyled\",children:availableYears.map(year=>/*#__PURE__*/_jsx(\"li\",{className:\"mb-2\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center\",children:[/*#__PURE__*/_jsx(Calendar,{size:14,className:\"me-2 text-muted\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"small\",children:[year.name,year.is_current&&/*#__PURE__*/_jsx(\"span\",{className:\"badge bg-primary ms-1\",style:{fontSize:'0.6em'},children:\"Courante\"})]})]})},year.id))}):/*#__PURE__*/_jsx(\"p\",{className:\"text-muted small\",children:\"Aucune ann\\xE9e disponible\"})]})})]})})]})]})]})]});};export default UserProfile;","map":{"version":3,"names":["React","useState","useEffect","Person","PencilSquare","Key","Shield","Envelope","Calendar","Building","Check","X","Eye","EyeSlash","Telephone","CameraFill","Trash","useAuth","secureApiEndpoints","paramsTraductions","getLang","PhoneInput","Swal","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","UserProfile","user","updateUser","loading","setLoading","error","setError","success","setSuccess","activeTab","setActiveTab","availableYears","setAvailableYears","currentWorkingYear","setCurrentWorkingYear","yearLoading","setYearLoading","profileData","setProfileData","name","email","contact","username","subname","phone_number","sex","matricule","avatarData","setAvatarData","src","file","uploading","passwordData","setPasswordData","current_password","new_password","confirm_password","showPasswords","setShowPasswords","current","new","confirm","isEditing","setIsEditing","photo","avatar","prev","role","loadSchoolYearData","yearsResponse","schoolYears","getActiveYears","data","workingYearResponse","getUserWorkingYear","console","handleProfileSubmit","e","preventDefault","handleAvatarUpload","log","message","response","auth","updateProfile","profileUpdated","fire","title","text","profileUpdatedSuccess","icon","timer","showConfirmButton","profileUpdateError","handlePasswordSubmit","passwordMismatch","length","passwordTooShort","changePassword","passwordChanged","passwordChangedSuccess","passwordChangeError","handleAvatarChange","target","files","type","startsWith","invalidImageType","size","imageTooLarge","url","URL","createObjectURL","formData","FormData","append","uploadAvatar","Error","avatarUploadError","handleAvatarRemove","handleWorkingYearChange","yearId","setUserWorkingYear","workingYearUpdated","workingYearUpdatedSuccess","workingYearUpdateError","togglePasswordVisibility","field","formatDate","dateString","Date","toLocaleDateString","year","month","day","className","children","onClick","style","width","height","alt","objectFit","is_active","admin","accountant","teacher","onSubmit","htmlFor","cursor","id","accept","onChange","display","clickToChangeAvatar","value","required","label","number","placeholder","showSuggestions","teacherName","teacherSubname","selectSex","m","f","disabled","save","cancel","created_at","start_date","end_date","minLength","map","is_current","fontSize"],"sources":["/var/www/College-IUP/front/src/pages/Profile/UserProfile.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { \n    Person, \n    PencilSquare, \n    Key, \n    Shield, \n    Envelope, \n    Calendar,\n    Building,\n    Check,\n    X,\n    Eye,\n    EyeSlash,\n    Telephone,\n    CameraFill,\n    Trash\n} from 'react-bootstrap-icons';\nimport { useAuth } from '../../hooks/useAuth';\nimport { secureApiEndpoints } from '../../utils/apiMigration';\nimport { paramsTraductions } from '../../local/params';\nimport { getLang } from '../../utils/lang';\nimport PhoneInput from '../../components/PhoneInput';\nimport Swal from 'sweetalert2';\n\nconst UserProfile = () => {\n    const { user, updateUser } = useAuth();\n    const [loading, setLoading] = useState(false);\n    const [error, setError] = useState('');\n    const [success, setSuccess] = useState('');\n    const [activeTab, setActiveTab] = useState('profile');\n    \n    // School year data\n    const [availableYears, setAvailableYears] = useState([]);\n    const [currentWorkingYear, setCurrentWorkingYear] = useState(null);\n    const [yearLoading, setYearLoading] = useState(false);\n    \n    // Profile form data\n    const [profileData, setProfileData] = useState({\n        name: '',\n        email: '',\n        contact: '',\n        username: '',\n        subname: '',\n        phone_number: '',\n        sex: '',\n        matricule: ''\n    });\n    \n    // Avatar management\n    const [avatarData, setAvatarData] = useState({\n        src: 'assets/1.png',\n        file: null,\n        uploading: false\n    });\n    \n    // Password form data\n    const [passwordData, setPasswordData] = useState({\n        current_password: '',\n        new_password: '',\n        confirm_password: ''\n    });\n    \n    const [showPasswords, setShowPasswords] = useState({\n        current: false,\n        new: false,\n        confirm: false\n    });\n    \n    const [isEditing, setIsEditing] = useState(false);\n\n    useEffect(() => {\n        if (user) {\n            setProfileData({\n                name: user.name || '',\n                email: user.email || '',\n                contact: user.contact || '',\n                username: user.username || '',\n                subname: user.subname || '',\n                phone_number: user.phone_number || '',\n                sex: user.sex || '',\n                matricule: user.matricule || ''\n            });\n            \n            // Load avatar if available (backend stores in 'photo' field)\n            if (user.photo || user.avatar) {\n                setAvatarData(prev => ({ ...prev, src: user.photo || user.avatar }));\n            }\n            \n            // Load school year data for admin and accountant\n            if (user.role === 'admin' || user.role === 'accountant') {\n                loadSchoolYearData();\n            }\n        }\n    }, [user]);\n\n    const loadSchoolYearData = async () => {\n        try {\n            setYearLoading(true);\n            \n            // Load available years\n            const yearsResponse = await secureApiEndpoints.schoolYears.getActiveYears();\n            setAvailableYears(yearsResponse.data || []);\n            \n            // Load current working year\n            const workingYearResponse = await secureApiEndpoints.schoolYears.getUserWorkingYear();\n            setCurrentWorkingYear(workingYearResponse.data || null);\n        } catch (error) {\n            console.error('Error loading school year data:', error);\n        } finally {\n            setYearLoading(false);\n        }\n    };\n\n    const handleProfileSubmit = async (e) => {\n        e.preventDefault();\n        \n        try {\n            setLoading(true);\n            setError('');\n            \n            // Upload avatar first if changed (temporairement désactivé)\n            if (avatarData.file) {\n                try {\n                    await handleAvatarUpload();\n                } catch (error) {\n                    console.log('Avatar upload disabled:', error.message);\n                    // Continue without failing the profile update\n                }\n            }\n            \n            const response = await secureApiEndpoints.auth.updateProfile(profileData);\n            \n            if (response.success) {\n                setSuccess(paramsTraductions[getLang()].profileUpdated || 'Profil mis à jour avec succès');\n                setIsEditing(false);\n                \n                // Update user in auth context\n                updateUser(response.data);\n                \n                Swal.fire({\n                    title: paramsTraductions[getLang()].success || 'Succès',\n                    text: paramsTraductions[getLang()].profileUpdatedSuccess || 'Votre profil a été mis à jour avec succès',\n                    icon: 'success',\n                    timer: 2000,\n                    showConfirmButton: false\n                });\n            } else {\n                setError(response.message || paramsTraductions[getLang()].profileUpdateError || 'Erreur lors de la mise à jour du profil');\n            }\n        } catch (error) {\n            console.error('Error updating profile:', error);\n            setError(paramsTraductions[getLang()].profileUpdateError || 'Erreur lors de la mise à jour du profil');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handlePasswordSubmit = async (e) => {\n        e.preventDefault();\n        \n        // Validation\n        if (passwordData.new_password !== passwordData.confirm_password) {\n            setError(paramsTraductions[getLang()].passwordMismatch || 'Les nouveaux mots de passe ne correspondent pas');\n            return;\n        }\n        \n        if (passwordData.new_password.length < 6) {\n            setError(paramsTraductions[getLang()].passwordTooShort || 'Le nouveau mot de passe doit contenir au moins 6 caractères');\n            return;\n        }\n        \n        try {\n            setLoading(true);\n            setError('');\n            \n            const response = await secureApiEndpoints.auth.changePassword({\n                current_password: passwordData.current_password,\n                new_password: passwordData.new_password\n            });\n            \n            if (response.success) {\n                setSuccess(paramsTraductions[getLang()].passwordChanged || 'Mot de passe modifié avec succès');\n                setPasswordData({\n                    current_password: '',\n                    new_password: '',\n                    confirm_password: ''\n                });\n                \n                Swal.fire({\n                    title: paramsTraductions[getLang()].success || 'Succès',\n                    text: paramsTraductions[getLang()].passwordChangedSuccess || 'Votre mot de passe a été modifié avec succès',\n                    icon: 'success',\n                    timer: 2000,\n                    showConfirmButton: false\n                });\n            } else {\n                setError(response.message || paramsTraductions[getLang()].passwordChangeError || 'Erreur lors de la modification du mot de passe');\n            }\n        } catch (error) {\n            console.error('Error changing password:', error);\n            setError(paramsTraductions[getLang()].passwordChangeError || 'Erreur lors de la modification du mot de passe');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    // Avatar management functions\n    const handleAvatarChange = (e) => {\n        const file = e.target.files[0];\n        if (file) {\n            // Validate file type\n            if (!file.type.startsWith('image/')) {\n                setError(paramsTraductions[getLang()].invalidImageType || 'Veuillez sélectionner un fichier image valide');\n                return;\n            }\n            \n            // Validate file size (max 2MB)\n            if (file.size > 2 * 1024 * 1024) {\n                setError(paramsTraductions[getLang()].imageTooLarge || 'L\\'image ne doit pas dépasser 2MB');\n                return;\n            }\n            \n            const url = URL.createObjectURL(file);\n            setAvatarData({\n                src: url,\n                file: file,\n                uploading: false\n            });\n        }\n    };\n\n    const handleAvatarUpload = async () => {\n        if (!avatarData.file) return;\n        \n        try {\n            setAvatarData(prev => ({ ...prev, uploading: true }));\n            \n            const formData = new FormData();\n            formData.append('photo', avatarData.file); // Backend attend 'photo' et non 'avatar'\n            \n            const response = await secureApiEndpoints.auth.uploadAvatar(formData);\n            \n            if (response.success) {\n                setAvatarData(prev => ({ \n                    ...prev, \n                    file: null, \n                    uploading: false,\n                    src: response.data.url || prev.src\n                }));\n                \n                // Update user data with new avatar (backend uses 'photo' field)\n                if (response.data.url) {\n                    updateUser({ ...user, photo: response.data.url, avatar: response.data.url });\n                }\n                \n                // Show success message\n                setSuccess(response.message || 'Avatar uploadé avec succès');\n            } else {\n                throw new Error(response.message || 'Erreur lors du téléchargement');\n            }\n        } catch (error) {\n            console.error('Error uploading avatar:', error);\n            setError(error.message || paramsTraductions[getLang()].avatarUploadError || 'Erreur lors du téléchargement de l\\'avatar');\n            setAvatarData(prev => ({ ...prev, uploading: false }));\n        }\n    };\n\n    const handleAvatarRemove = () => {\n        setAvatarData({\n            src: 'assets/1.png',\n            file: null,\n            uploading: false\n        });\n    };\n\n    const handleWorkingYearChange = async (yearId) => {\n        try {\n            setYearLoading(true);\n            setError('');\n            \n            const response = await secureApiEndpoints.schoolYears.setUserWorkingYear(yearId);\n            \n            if (response.success) {\n                setCurrentWorkingYear(response.data);\n                setSuccess(paramsTraductions[getLang()].workingYearUpdated || 'Année de travail mise à jour avec succès');\n                \n                Swal.fire({\n                    title: paramsTraductions[getLang()].success || 'Succès',\n                    text: paramsTraductions[getLang()].workingYearUpdatedSuccess || 'Votre année de travail a été mise à jour avec succès',\n                    icon: 'success',\n                    timer: 2000,\n                    showConfirmButton: false\n                });\n            } else {\n                setError(response.message || paramsTraductions[getLang()].workingYearUpdateError || 'Erreur lors de la mise à jour de l\\'année de travail');\n            }\n        } catch (error) {\n            console.error('Error updating working year:', error);\n            setError(paramsTraductions[getLang()].workingYearUpdateError || 'Erreur lors de la mise à jour de l\\'année de travail');\n        } finally {\n            setYearLoading(false);\n        }\n    };\n\n    const togglePasswordVisibility = (field) => {\n        setShowPasswords(prev => ({\n            ...prev,\n            [field]: !prev[field]\n        }));\n    };\n\n\n    const formatDate = (dateString) => {\n        if (!dateString) return 'Non disponible';\n        return new Date(dateString).toLocaleDateString('fr-FR', {\n            year: 'numeric',\n            month: 'long',\n            day: 'numeric'\n        });\n    };\n\n    if (!user) {\n        return (\n            <div className=\"container-fluid py-4\">\n                <div className=\"text-center py-5\">\n                    <div className=\"spinner-border\" role=\"status\">\n                        <span className=\"visually-hidden\">Chargement...</span>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"container-fluid py-4\">\n            {/* Header */}\n            <div className=\"row mb-4\">\n                <div className=\"col-12\">\n                    <div className=\"d-flex justify-content-between align-items-center\">\n                        <div>\n                            <h2 className=\"h4 mb-1\">Mon Profil</h2>\n                            <p className=\"text-muted mb-0\">\n                                Gérez vos informations personnelles et vos paramètres de sécurité\n                            </p>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            {/* Alerts */}\n            {error && (\n                <div className=\"row mb-3\">\n                    <div className=\"col-12\">\n                        <div className=\"alert alert-danger alert-dismissible fade show\" role=\"alert\">\n                            {error}\n                            <button \n                                type=\"button\" \n                                className=\"btn-close\" \n                                onClick={() => setError('')}\n                                aria-label=\"Close\"\n                            ></button>\n                        </div>\n                    </div>\n                </div>\n            )}\n            {success && (\n                <div className=\"row mb-3\">\n                    <div className=\"col-12\">\n                        <div className=\"alert alert-success alert-dismissible fade show\" role=\"alert\">\n                            {success}\n                            <button \n                                type=\"button\" \n                                className=\"btn-close\" \n                                onClick={() => setSuccess('')}\n                                aria-label=\"Close\"\n                            ></button>\n                        </div>\n                    </div>\n                </div>\n            )}\n\n            <div className=\"row\">\n                {/* Sidebar */}\n                <div className=\"col-md-3 mb-4\">\n                    <div className=\"card\">\n                        <div className=\"card-body text-center\">\n                            <div className=\"position-relative mx-auto mb-3\" style={{ width: '80px', height: '80px' }}>\n                                <img \n                                    src={avatarData.src} \n                                    alt=\"Avatar\" \n                                    className=\"rounded-circle w-100 h-100 object-fit-cover border\"\n                                    style={{ objectFit: 'cover' }}\n                                />\n                                {avatarData.uploading && (\n                                    <div className=\"position-absolute top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center bg-dark bg-opacity-50 rounded-circle\">\n                                        <div className=\"spinner-border spinner-border-sm text-white\" role=\"status\"></div>\n                                    </div>\n                                )}\n                            </div>\n                            <h5 className=\"card-title\">\n                                {(user.role === 'admin' || user.role === 'accountant') ? \n                                    (user.username || user.name) : \n                                    (user.name && user.subname ? `${user.name} ${user.subname}` : user.name)\n                                }\n                            </h5>\n                            <p className=\"text-muted small mb-2\">\n                                {(user.role === 'admin' || user.role === 'accountant') ? \n                                    user.email : \n                                    user.matricule\n                                }\n                            </p>\n                            <div className=\"d-flex justify-content-center gap-1 mb-2\">\n                                <span className={`badge ${user.is_active ? 'bg-success' : 'bg-secondary'}`}>\n                                    {user.is_active ? 'Actif' : 'Inactif'}\n                                </span>\n                                <span className=\"badge bg-primary\">\n                                    {user.role === 'admin' ? paramsTraductions[getLang()].admin || 'Admin' : \n                                     user.role === 'accountant' ? paramsTraductions[getLang()].accountant || 'Comptable' : \n                                     user.role === 'teacher' ? paramsTraductions[getLang()].teacher || 'Enseignant' : 'Utilisateur'}\n                                </span>\n                            </div>\n                            {(user.role === 'admin' || user.role === 'accountant') && user.username && (\n                                <small className=\"text-muted\">@{user.username}</small>\n                            )}\n                        </div>\n                    </div>\n\n                    {/* Navigation */}\n                    <div className=\"list-group mt-3\">\n                        <button\n                            className={`list-group-item list-group-item-action d-flex align-items-center ${\n                                activeTab === 'profile' ? 'active' : ''\n                            }`}\n                            onClick={() => setActiveTab('profile')}\n                        >\n                            <Person size={16} className=\"me-2\" />\n                            Informations personnelles\n                        </button>\n                        <button\n                            className={`list-group-item list-group-item-action d-flex align-items-center ${\n                                activeTab === 'security' ? 'active' : ''\n                            }`}\n                            onClick={() => setActiveTab('security')}\n                        >\n                            <Shield size={16} className=\"me-2\" />\n                            Sécurité\n                        </button>\n                        {(user.role === 'admin' || user.role === 'accountant') && (\n                            <button\n                                className={`list-group-item list-group-item-action d-flex align-items-center ${\n                                    activeTab === 'working-year' ? 'active' : ''\n                                }`}\n                                onClick={() => setActiveTab('working-year')}\n                            >\n                                <Calendar size={16} className=\"me-2\" />\n                                Année de travail\n                            </button>\n                        )}\n                    </div>\n                </div>\n\n                {/* Main Content */}\n                <div className=\"col-md-9\">\n                    {activeTab === 'profile' && (\n                        <div className=\"card\">\n                            <div className=\"card-header d-flex justify-content-between align-items-center\">\n                                <h5 className=\"mb-0\">\n                                    <Person size={20} className=\"me-2\" />\n                                    Informations personnelles\n                                </h5>\n                                {!isEditing && (\n                                    <button\n                                        className=\"btn btn-outline-primary btn-sm\"\n                                        onClick={() => setIsEditing(true)}\n                                    >\n                                        <PencilSquare size={14} className=\"me-1\" />\n                                        Modifier\n                                    </button>\n                                )}\n                            </div>\n                            <div className=\"card-body\">\n                                {isEditing ? (\n                                    <form onSubmit={handleProfileSubmit}>\n                                        {/* Avatar Upload Section */}\n                                        <div className=\"row mb-4\">\n                                            <div className=\"col-12 text-center\">\n                                                <div className=\"position-relative d-inline-block\">\n                                                    <img \n                                                        src={avatarData.src} \n                                                        alt=\"Avatar\" \n                                                        className=\"rounded-circle border\"\n                                                        style={{ width: '120px', height: '120px', objectFit: 'cover' }}\n                                                    />\n                                                    <div className=\"position-absolute bottom-0 end-0\">\n                                                        <label htmlFor=\"avatar-upload\" className=\"btn btn-primary btn-sm rounded-circle p-2\" style={{ cursor: 'pointer' }}>\n                                                            <CameraFill size={16} />\n                                                            <input \n                                                                type=\"file\" \n                                                                id=\"avatar-upload\"\n                                                                accept=\"image/*\"\n                                                                onChange={handleAvatarChange}\n                                                                style={{ display: 'none' }}\n                                                            />\n                                                        </label>\n                                                    </div>\n                                                    {avatarData.file && (\n                                                        <div className=\"position-absolute top-0 start-100 translate-middle\">\n                                                            <button \n                                                                type=\"button\"\n                                                                className=\"btn btn-danger btn-sm rounded-circle p-1\"\n                                                                onClick={handleAvatarRemove}\n                                                                title=\"Supprimer\"\n                                                            >\n                                                                <Trash size={12} />\n                                                            </button>\n                                                        </div>\n                                                    )}\n                                                    {avatarData.uploading && (\n                                                        <div className=\"position-absolute top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center bg-dark bg-opacity-50 rounded-circle\">\n                                                            <div className=\"spinner-border spinner-border-sm text-white\" role=\"status\"></div>\n                                                        </div>\n                                                    )}\n                                                </div>\n                                                <p className=\"text-muted small mt-2 mb-0\">\n                                                    {paramsTraductions[getLang()].clickToChangeAvatar || 'Cliquez sur l\\'icône pour changer votre photo'}\n                                                </p>\n                                            </div>\n                                        </div>\n\n                                        {/* Form fields based on user role */}\n                                        {(user.role === 'admin' || user.role === 'accountant') ? (\n                                            <>\n                                                <div className=\"row\">\n                                                    <div className=\"col-md-6\">\n                                                        <div className=\"mb-3\">\n                                                            <label className=\"form-label\">{paramsTraductions[getLang()].username || 'Nom d\\'utilisateur'} *</label>\n                                                            <input\n                                                                type=\"text\"\n                                                                className=\"form-control\"\n                                                                value={profileData.username}\n                                                                onChange={(e) => setProfileData({\n                                                                    ...profileData,\n                                                                    username: e.target.value\n                                                                })}\n                                                                required\n                                                            />\n                                                        </div>\n                                                    </div>\n                                                    <div className=\"col-md-6\">\n                                                        <div className=\"mb-3\">\n                                                            <label className=\"form-label\">{paramsTraductions[getLang()].email || 'Email'} *</label>\n                                                            <input\n                                                                type=\"email\"\n                                                                className=\"form-control\"\n                                                                value={profileData.email}\n                                                                onChange={(e) => setProfileData({\n                                                                    ...profileData,\n                                                                    email: e.target.value\n                                                                })}\n                                                                required\n                                                            />\n                                                        </div>\n                                                    </div>\n                                                </div>\n                                                <div className=\"row\">\n                                                    <div className=\"col-md-6\">\n                                                        <PhoneInput\n                                                            label={paramsTraductions[getLang()].number || 'Téléphone'}\n                                                            value={profileData.contact || profileData.phone_number}\n                                                            onChange={(e) => {\n                                                                const value = e.target.value;\n                                                                setProfileData({\n                                                                    ...profileData,\n                                                                    contact: value,\n                                                                    phone_number: value\n                                                                });\n                                                            }}\n                                                            placeholder=\"+237 6XX XXX XXX\"\n                                                            className=\"mb-3\"\n                                                            showSuggestions={true}\n                                                        />\n                                                    </div>\n                                                    <div className=\"col-md-6\">\n                                                        <div className=\"mb-3\">\n                                                            <label className=\"form-label\">{paramsTraductions[getLang()].name || 'Nom complet'}</label>\n                                                            <input\n                                                                type=\"text\"\n                                                                className=\"form-control\"\n                                                                value={profileData.name}\n                                                                onChange={(e) => setProfileData({\n                                                                    ...profileData,\n                                                                    name: e.target.value\n                                                                })}\n                                                                placeholder=\"Votre nom complet\"\n                                                            />\n                                                        </div>\n                                                    </div>\n                                                </div>\n                                            </>\n                                        ) : (\n                                            <>\n                                                <div className=\"row\">\n                                                    <div className=\"col-md-6\">\n                                                        <div className=\"mb-3\">\n                                                            <label className=\"form-label\">{paramsTraductions[getLang()].teacherName || 'Nom'} *</label>\n                                                            <input\n                                                                type=\"text\"\n                                                                className=\"form-control\"\n                                                                value={profileData.name}\n                                                                onChange={(e) => setProfileData({\n                                                                    ...profileData,\n                                                                    name: e.target.value\n                                                                })}\n                                                                required\n                                                            />\n                                                        </div>\n                                                    </div>\n                                                    <div className=\"col-md-6\">\n                                                        <div className=\"mb-3\">\n                                                            <label className=\"form-label\">{paramsTraductions[getLang()].teacherSubname || 'Prénom'} *</label>\n                                                            <input\n                                                                type=\"text\"\n                                                                className=\"form-control\"\n                                                                value={profileData.subname}\n                                                                onChange={(e) => setProfileData({\n                                                                    ...profileData,\n                                                                    subname: e.target.value\n                                                                })}\n                                                                required\n                                                            />\n                                                        </div>\n                                                    </div>\n                                                </div>\n                                                <div className=\"row\">\n                                                    <div className=\"col-md-6\">\n                                                        <PhoneInput\n                                                            label={paramsTraductions[getLang()].number || 'Téléphone'}\n                                                            value={profileData.phone_number}\n                                                            onChange={(e) => {\n                                                                const value = e.target.value;\n                                                                setProfileData({\n                                                                    ...profileData,\n                                                                    phone_number: value,\n                                                                    contact: value\n                                                                });\n                                                            }}\n                                                            placeholder=\"+237 6XX XXX XXX\"\n                                                            className=\"mb-3\"\n                                                            showSuggestions={true}\n                                                        />\n                                                    </div>\n                                                    <div className=\"col-md-6\">\n                                                        <div className=\"mb-3\">\n                                                            <label className=\"form-label\">{paramsTraductions[getLang()].sex || 'Sexe'}</label>\n                                                            <select \n                                                                className=\"form-select\"\n                                                                value={profileData.sex}\n                                                                onChange={(e) => setProfileData({\n                                                                    ...profileData,\n                                                                    sex: e.target.value\n                                                                })}\n                                                            >\n                                                                <option value=\"\">{paramsTraductions[getLang()].selectSex || 'Sélectionner...'}</option>\n                                                                <option value=\"m\">{paramsTraductions[getLang()].m || 'Masculin'}</option>\n                                                                <option value=\"f\">{paramsTraductions[getLang()].f || 'Féminin'}</option>\n                                                            </select>\n                                                        </div>\n                                                    </div>\n                                                </div>\n                                            </>\n                                        )}\n                                        \n                                        <div className=\"d-flex gap-2\">\n                                            <button\n                                                type=\"submit\"\n                                                className=\"btn btn-primary\"\n                                                disabled={loading}\n                                            >\n                                                {loading ? (\n                                                    <>\n                                                        <span className=\"spinner-border spinner-border-sm me-2\" role=\"status\"></span>\n                                                        Mise à jour...\n                                                    </>\n                                                ) : (\n                                                    <>\n                                                        <Check size={16} className=\"me-1\" />\n                                                        {paramsTraductions[getLang()].save || 'Enregistrer'}\n                                                    </>\n                                                )}\n                                            </button>\n                                            <button\n                                                type=\"button\"\n                                                className=\"btn btn-outline-secondary\"\n                                                onClick={() => {\n                                                    setIsEditing(false);\n                                                    setProfileData({\n                                                        name: user.name || '',\n                                                        email: user.email || '',\n                                                        contact: user.contact || '',\n                                                        username: user.username || '',\n                                                        subname: user.subname || '',\n                                                        phone_number: user.phone_number || '',\n                                                        sex: user.sex || '',\n                                                        matricule: user.matricule || ''\n                                                    });\n                                                    handleAvatarRemove();\n                                                }}\n                                            >\n                                                <X size={16} className=\"me-1\" />\n                                                {paramsTraductions[getLang()].cancel || 'Annuler'}\n                                            </button>\n                                        </div>\n                                    </form>\n                                ) : (\n                                    <div className=\"row\">\n                                        {/* Avatar display */}\n                                        <div className=\"col-12 text-center mb-4\">\n                                            <img \n                                                src={avatarData.src} \n                                                alt=\"Avatar\" \n                                                className=\"rounded-circle border\"\n                                                style={{ width: '120px', height: '120px', objectFit: 'cover' }}\n                                            />\n                                        </div>\n                                        \n                                        {/* User information based on role */}\n                                        {(user.role === 'admin' || user.role === 'accountant') ? (\n                                            <>\n                                                <div className=\"col-md-6\">\n                                                    <div className=\"mb-3\">\n                                                        <label className=\"form-label text-muted\">{paramsTraductions[getLang()].username || 'Nom d\\'utilisateur'}</label>\n                                                        <p className=\"fw-medium d-flex align-items-center gap-1\">\n                                                            <Person size={16} className=\"me-1\" />\n                                                            {user.username || 'Non défini'}\n                                                        </p>\n                                                    </div>\n                                                    <div className=\"mb-3\">\n                                                        <label className=\"form-label text-muted\">{paramsTraductions[getLang()].email || 'Email'}</label>\n                                                        <p className=\"fw-medium d-flex align-items-center gap-1\">\n                                                            <Envelope size={16} className=\"me-1\" />\n                                                            {user.email}\n                                                        </p>\n                                                    </div>\n                                                </div>\n                                                <div className=\"col-md-6\">\n                                                    <div className=\"mb-3\">\n                                                        <label className=\"form-label text-muted\">{paramsTraductions[getLang()].number || 'Téléphone'}</label>\n                                                        <p className=\"fw-medium d-flex align-items-center gap-1\">\n                                                            <Telephone size={16} className=\"me-1\" />\n                                                            {user.contact || user.phone_number || 'Non renseigné'}\n                                                        </p>\n                                                    </div>\n                                                    <div className=\"mb-3\">\n                                                        <label className=\"form-label text-muted\">{paramsTraductions[getLang()].name || 'Nom complet'}</label>\n                                                        <p className=\"fw-medium d-flex align-items-center gap-1\">\n                                                            <Person size={16} className=\"me-1\" />\n                                                            {user.name || 'Non défini'}\n                                                        </p>\n                                                    </div>\n                                                </div>\n                                            </>\n                                        ) : (\n                                            <>\n                                                <div className=\"col-md-6\">\n                                                    <div className=\"mb-3\">\n                                                        <label className=\"form-label text-muted\">{paramsTraductions[getLang()].teacherName || 'Nom'}</label>\n                                                        <p className=\"fw-medium d-flex align-items-center gap-1\">\n                                                            <Person size={16} className=\"me-1\" />\n                                                            {user.name}\n                                                        </p>\n                                                    </div>\n                                                    <div className=\"mb-3\">\n                                                        <label className=\"form-label text-muted\">{paramsTraductions[getLang()].teacherSubname || 'Prénom'}</label>\n                                                        <p className=\"fw-medium d-flex align-items-center gap-1\">\n                                                            <Person size={16} className=\"me-1\" />\n                                                            {user.subname}\n                                                        </p>\n                                                    </div>\n                                                    <div className=\"mb-3\">\n                                                        <label className=\"form-label text-muted\">{paramsTraductions[getLang()].number || 'Téléphone'}</label>\n                                                        <p className=\"fw-medium d-flex align-items-center gap-1\">\n                                                            <Telephone size={16} className=\"me-1\" />\n                                                            {user.phone_number || user.contact || 'Non renseigné'}\n                                                        </p>\n                                                    </div>\n                                                </div>\n                                                <div className=\"col-md-6\">\n                                                    <div className=\"mb-3\">\n                                                        <label className=\"form-label text-muted\">{paramsTraductions[getLang()].matricule || 'Matricule'}</label>\n                                                        <p className=\"fw-medium d-flex align-items-center gap-1\">\n                                                            <Building size={16} className=\"me-1\" />\n                                                            {user.matricule || 'Non défini'}\n                                                        </p>\n                                                    </div>\n                                                    <div className=\"mb-3\">\n                                                        <label className=\"form-label text-muted\">{paramsTraductions[getLang()].sex || 'Sexe'}</label>\n                                                        <p className=\"fw-medium d-flex align-items-center gap-1\">\n                                                            {user.sex === 'm' ? \n                                                                (paramsTraductions[getLang()].m || 'Masculin') : \n                                                                user.sex === 'f' ? \n                                                                (paramsTraductions[getLang()].f || 'Féminin') : \n                                                                'Non défini'\n                                                            }\n                                                        </p>\n                                                    </div>\n                                                </div>\n                                            </>\n                                        )}\n                                        <div className=\"col-12\">\n                                            <hr />\n                                            <div className=\"row\">\n                                                <div className=\"col-md-4\">\n                                                    <div className=\"mb-3\">\n                                                        <label className=\"form-label text-muted\">Date de création</label>\n                                                        <p className=\"fw-medium d-flex align-items-center gap-1\">\n                                                            <Calendar size={16} className=\"me-1\" />\n                                                            {formatDate(user.created_at)}\n                                                        </p>\n                                                    </div>\n                                                </div>\n                                                <div className=\"col-md-4\">\n                                                    <div className=\"mb-3\">\n                                                        <label className=\"form-label text-muted\">Rôle</label>\n                                                        <p className=\"fw-medium d-flex align-items-center gap-1\">\n                                                            <Building size={16} className=\"me-1\" />\n                                                            {user.role === 'admin' ? 'Administrateur' : \n                                                             user.role === 'accountant' ? 'Comptable' : \n                                                             user.role === 'teacher' ? 'Enseignant' : 'Utilisateur'}\n                                                        </p>\n                                                    </div>\n                                                </div>\n                                                <div className=\"col-md-4\">\n                                                    <div className=\"mb-3\">\n                                                        <label className=\"form-label text-muted\">Nom d'utilisateur</label>\n                                                        <p className=\"fw-medium d-flex align-items-center gap-1\">\n                                                            <Person size={16} className=\"me-1\" />\n                                                            {user.username || 'Non défini'}\n                                                        </p>\n                                                    </div>\n                                                </div>\n                                            </div>\n                                            \n                                            {/* Informations supplémentaires selon le rôle */}\n                                            {(user.role === 'admin' || user.role === 'accountant') && (\n                                                <div className=\"row mt-3\">\n                                                    <div className=\"col-12\">\n                                                        <div className=\"alert alert-info\">\n                                                            <strong>Informations d'accès :</strong>\n                                                            <ul className=\"mb-0 mt-2\">\n                                                                <li>Accès complet aux fonctionnalités du système</li>\n                                                                <li>Gestion des années scolaires</li>\n                                                                <li>Configuration de l'année de travail personnalisée</li>\n                                                                {user.role === 'admin' && <li>Administration complète du système</li>}\n                                                                {user.role === 'accountant' && <li>Gestion financière et comptable</li>}\n                                                            </ul>\n                                                        </div>\n                                                    </div>\n                                                </div>\n                                            )}\n                                            \n                                            {user.role === 'teacher' && (\n                                                <div className=\"row mt-3\">\n                                                    <div className=\"col-12\">\n                                                        <div className=\"alert alert-success\">\n                                                            <strong>Profil Enseignant :</strong>\n                                                            <ul className=\"mb-0 mt-2\">\n                                                                <li>Gestion des élèves de vos classes</li>\n                                                                <li>Suivi pédagogique et évaluations</li>\n                                                                <li>Accès aux outils d'enseignement</li>\n                                                            </ul>\n                                                        </div>\n                                                    </div>\n                                                </div>\n                                            )}\n                                            \n                                            {/* Afficher l'année de travail si définie */}\n                                            {(user.role === 'admin' || user.role === 'accountant') && currentWorkingYear && (\n                                                <div className=\"row mt-3\">\n                                                    <div className=\"col-12\">\n                                                        <div className=\"card bg-light\">\n                                                            <div className=\"card-body\">\n                                                                <h6 className=\"card-title mb-2  d-flex align-items-center gap-1\">\n                                                                    <Calendar size={18} className=\"me-2 text-primary\" />\n                                                                    Année de travail actuelle\n                                                                </h6>\n                                                                <p className=\"card-text mb-0\">\n                                                                    <strong>{currentWorkingYear.name}</strong>\n                                                                    <span className=\"text-muted ms-2\">\n                                                                        ({new Date(currentWorkingYear.start_date).toLocaleDateString('fr-FR')} - \n                                                                        {new Date(currentWorkingYear.end_date).toLocaleDateString('fr-FR')})\n                                                                    </span>\n                                                                </p>\n                                                                <small className=\"text-muted\">\n                                                                    Cette année est utilisée pour l'affichage des données et l'ajout de nouveaux éléments.\n                                                                </small>\n                                                            </div>\n                                                        </div>\n                                                    </div>\n                                                </div>\n                                            )}\n                                        </div>\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n                    )}\n\n                    {activeTab === 'security' && (\n                        <div className=\"card\">\n                            <div className=\"card-header\">\n                                <h5 className=\"mb-0 d-flex align-items-center gap-1\">\n                                    <Key size={20} className=\"me-2\" />\n                                    Changer le mot de passe\n                                </h5>\n                            </div>\n                            <div className=\"card-body\">\n                                <form onSubmit={handlePasswordSubmit}>\n                                    <div className=\"mb-3\">\n                                        <label className=\"form-label\">Mot de passe actuel *</label>\n                                        <div className=\"input-group\">\n                                            <input\n                                                type={showPasswords.current ? \"text\" : \"password\"}\n                                                className=\"form-control\"\n                                                value={passwordData.current_password}\n                                                onChange={(e) => setPasswordData({\n                                                    ...passwordData,\n                                                    current_password: e.target.value\n                                                })}\n                                                required\n                                            />\n                                            <button\n                                                type=\"button\"\n                                                className=\"btn btn-outline-secondary\"\n                                                onClick={() => togglePasswordVisibility('current')}\n                                            >\n                                                {showPasswords.current ? <EyeSlash size={16} /> : <Eye size={16} />}\n                                            </button>\n                                        </div>\n                                    </div>\n                                    \n                                    <div className=\"mb-3\">\n                                        <label className=\"form-label\">Nouveau mot de passe *</label>\n                                        <div className=\"input-group\">\n                                            <input\n                                                type={showPasswords.new ? \"text\" : \"password\"}\n                                                className=\"form-control\"\n                                                value={passwordData.new_password}\n                                                onChange={(e) => setPasswordData({\n                                                    ...passwordData,\n                                                    new_password: e.target.value\n                                                })}\n                                                required\n                                                minLength=\"6\"\n                                            />\n                                            <button\n                                                type=\"button\"\n                                                className=\"btn btn-outline-secondary\"\n                                                onClick={() => togglePasswordVisibility('new')}\n                                            >\n                                                {showPasswords.new ? <EyeSlash size={16} /> : <Eye size={16} />}\n                                            </button>\n                                        </div>\n                                        <small className=\"text-muted\">Au moins 6 caractères</small>\n                                    </div>\n                                    \n                                    <div className=\"mb-3\">\n                                        <label className=\"form-label\">Confirmer le nouveau mot de passe *</label>\n                                        <div className=\"input-group\">\n                                            <input\n                                                type={showPasswords.confirm ? \"text\" : \"password\"}\n                                                className=\"form-control\"\n                                                value={passwordData.confirm_password}\n                                                onChange={(e) => setPasswordData({\n                                                    ...passwordData,\n                                                    confirm_password: e.target.value\n                                                })}\n                                                required\n                                            />\n                                            <button\n                                                type=\"button\"\n                                                className=\"btn btn-outline-secondary\"\n                                                onClick={() => togglePasswordVisibility('confirm')}\n                                            >\n                                                {showPasswords.confirm ? <EyeSlash size={16} /> : <Eye size={16} />}\n                                            </button>\n                                        </div>\n                                    </div>\n                                    \n                                    <button\n                                        type=\"submit\"\n                                        className=\"btn btn-primary\"\n                                        disabled={loading}\n                                    >\n                                        {loading ? (\n                                            <>\n                                                <span className=\"spinner-border spinner-border-sm me-2\" role=\"status\"></span>\n                                                Modification...\n                                            </>\n                                        ) : (\n                                            <>\n                                                <Key size={16} className=\"me-1\" />\n                                                Changer le mot de passe\n                                            </>\n                                        )}\n                                    </button>\n                                </form>\n                            </div>\n                        </div>\n                    )}\n\n                    {activeTab === 'working-year' && (user.role === 'admin' || user.role === 'accountant') && (\n                        <div className=\"card\">\n                            <div className=\"card-header\">\n                                <h5 className=\"mb-0  d-flex align-items-center gap-1\">\n                                    <Calendar size={20} className=\"me-2\" />\n                                    Année de travail\n                                </h5>\n                            </div>\n                            <div className=\"card-body\">\n                                <div className=\"row\">\n                                    <div className=\"col-md-8\">\n                                        <p className=\"text-muted mb-3\">\n                                            Choisissez l'année scolaire dans laquelle vous souhaitez travailler. \n                                            Cette sélection sera mémorisée et utilisée dans toutes les fonctionnalités du système.\n                                        </p>\n                                        \n                                        <div className=\"mb-3\">\n                                            <label className=\"form-label\">Année scolaire actuelle</label>\n                                            <div className=\"p-3 bg-light rounded\">\n                                                {currentWorkingYear ? (\n                                                    <div className=\"d-flex align-items-center\">\n                                                        <Calendar size={18} className=\"me-2 text-primary\" />\n                                                        <strong>{currentWorkingYear.name}</strong>\n                                                        <span className=\"ms-2 text-muted\">\n                                                            ({new Date(currentWorkingYear.start_date).toLocaleDateString('fr-FR')} - \n                                                            {new Date(currentWorkingYear.end_date).toLocaleDateString('fr-FR')})\n                                                        </span>\n                                                    </div>\n                                                ) : (\n                                                    <span className=\"text-muted\">Aucune année sélectionnée</span>\n                                                )}\n                                            </div>\n                                        </div>\n                                        \n                                        <div className=\"mb-3\">\n                                            <label className=\"form-label\">Changer d'année de travail</label>\n                                            <select \n                                                className=\"form-select\" \n                                                value={currentWorkingYear?.id || ''}\n                                                onChange={(e) => handleWorkingYearChange(e.target.value)}\n                                                disabled={yearLoading}\n                                            >\n                                                <option value=\"\">Sélectionner une année...</option>\n                                                {availableYears.map(year => (\n                                                    <option key={year.id} value={year.id}>\n                                                        {year.name} ({new Date(year.start_date).toLocaleDateString('fr-FR')} - \n                                                        {new Date(year.end_date).toLocaleDateString('fr-FR')})\n                                                        {year.is_current && ' (Année courante)'}\n                                                    </option>\n                                                ))}\n                                            </select>\n                                            {yearLoading && (\n                                                <div className=\"mt-2\">\n                                                    <span className=\"spinner-border spinner-border-sm me-2\" role=\"status\"></span>\n                                                    Mise à jour en cours...\n                                                </div>\n                                            )}\n                                        </div>\n                                        \n                                        <div className=\"alert alert-info\">\n                                            <strong>Note:</strong> Le changement d'année de travail affectera:\n                                            <ul className=\"mb-0 mt-2\">\n                                                <li>Les statistiques et rapports affichés</li>\n                                                <li>Les listes d'élèves et leurs données</li>\n                                                <li>Les calculs de paiements et frais</li>\n                                                <li>Toutes les fonctionnalités liées aux données académiques</li>\n                                            </ul>\n                                        </div>\n                                    </div>\n                                    <div className=\"col-md-4\">\n                                        <div className=\"bg-light p-3 rounded\">\n                                            <h6 className=\"fw-bold mb-3\">Années disponibles</h6>\n                                            {availableYears.length > 0 ? (\n                                                <ul className=\"list-unstyled\">\n                                                    {availableYears.map(year => (\n                                                        <li key={year.id} className=\"mb-2\">\n                                                            <div className=\"d-flex align-items-center\">\n                                                                <Calendar size={14} className=\"me-2 text-muted\" />\n                                                                <span className=\"small\">\n                                                                    {year.name}\n                                                                    {year.is_current && (\n                                                                        <span className=\"badge bg-primary ms-1\" style={{ fontSize: '0.6em' }}>\n                                                                            Courante\n                                                                        </span>\n                                                                    )}\n                                                                </span>\n                                                            </div>\n                                                        </li>\n                                                    ))}\n                                                </ul>\n                                            ) : (\n                                                <p className=\"text-muted small\">Aucune année disponible</p>\n                                            )}\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    )}\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default UserProfile;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}