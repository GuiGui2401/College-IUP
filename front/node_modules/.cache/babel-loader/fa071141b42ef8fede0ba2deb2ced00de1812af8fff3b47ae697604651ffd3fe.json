{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Button,Modal,Form,Alert,Badge,Card,Table,Row,Col,Tabs,Tab}from'react-bootstrap';import{PlusCircle,PersonFill,JournalBookmarkFill,HouseHeartFill,Trash2,Calendar}from'react-bootstrap-icons';import{secureApiEndpoints}from'../../utils/apiMigration';import Swal from'sweetalert2';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const TeacherAssignmentManagement=()=>{const[loading,setLoading]=useState(false);const[teachers,setTeachers]=useState([]);const[seriesSubjects,setSeriesSubjects]=useState([]);const[schoolYears,setSchoolYears]=useState([]);const[assignments,setAssignments]=useState([]);const[mainTeachers,setMainTeachers]=useState([]);const[showAssignModal,setShowAssignModal]=useState(false);const[showMainTeacherModal,setShowMainTeacherModal]=useState(false);const[selectedTeacher,setSelectedTeacher]=useState(null);const[selectedSchoolYear,setSelectedSchoolYear]=useState('current');const[availableSubjects,setAvailableSubjects]=useState([]);const[availableClasses,setAvailableClasses]=useState([]);const[assignmentData,setAssignmentData]=useState({series_subject_id:''});const[mainTeacherData,setMainTeacherData]=useState({school_class_id:''});const[activeTab,setActiveTab]=useState('assignments');useEffect(()=>{loadInitialData();},[]);useEffect(()=>{if(selectedSchoolYear){loadYearData();}},[selectedSchoolYear]);const loadInitialData=async()=>{try{setLoading(true);const[teachersRes,schoolYearsRes,seriesSubjectsRes]=await Promise.all([secureApiEndpoints.teachers.getAll({active:true}),secureApiEndpoints.schoolYears.getActiveYears(),secureApiEndpoints.seriesSubjects.getAll({active:true})]);if(teachersRes.success)setTeachers(teachersRes.data);if(schoolYearsRes.success)setSchoolYears(schoolYearsRes.data);if(seriesSubjectsRes.success)setSeriesSubjects(seriesSubjectsRes.data);}catch(error){console.error('Erreur lors du chargement des données:',error);Swal.fire('Erreur','Impossible de charger les données','error');}finally{setLoading(false);}};const loadYearData=async()=>{try{const yearId=selectedSchoolYear==='current'?null:selectedSchoolYear;// Construire les paramètres sans school_year_id si yearId est null\nconst assignmentParams={active:true};const mainTeacherParams={active:true};if(yearId!==null){assignmentParams.school_year_id=yearId;mainTeacherParams.school_year_id=yearId;}const[assignmentsRes,mainTeachersRes]=await Promise.all([secureApiEndpoints.teacherAssignments.getAll(assignmentParams),secureApiEndpoints.mainTeachers.getAll(mainTeacherParams)]);if(assignmentsRes.success)setAssignments(assignmentsRes.data);if(mainTeachersRes.success)setMainTeachers(mainTeachersRes.data);}catch(error){console.error('Erreur lors du chargement des données de l\\'année:',error);}};const handleShowAssignModal=async teacher=>{setSelectedTeacher(teacher);try{const yearId=selectedSchoolYear==='current'?null:selectedSchoolYear;const params={};if(yearId!==null){params.school_year_id=yearId;}const availableRes=await secureApiEndpoints.teacherAssignments.getAvailableSubjects(teacher.id,params);if(availableRes.success){setAvailableSubjects(availableRes.data);}}catch(error){console.error('Erreur lors du chargement des matières disponibles:',error);}setAssignmentData({series_subject_id:''});setShowAssignModal(true);};const handleShowMainTeacherModal=async()=>{try{const yearId=selectedSchoolYear==='current'?null:selectedSchoolYear;const params={};if(yearId!==null){params.school_year_id=yearId;}const[availableTeachersRes,availableClassesRes]=await Promise.all([secureApiEndpoints.mainTeachers.getAvailableTeachers(params),secureApiEndpoints.mainTeachers.getClassesWithoutMainTeacher(params)]);if(availableTeachersRes.success)setTeachers(prev=>prev.filter(t=>availableTeachersRes.data.some(at=>at.id===t.id)));if(availableClassesRes.success)setAvailableClasses(availableClassesRes.data);}catch(error){console.error('Erreur lors du chargement des données:',error);}setMainTeacherData({school_class_id:''});setShowMainTeacherModal(true);};const handleAssignSubject=async e=>{e.preventDefault();if(!selectedTeacher||!assignmentData.series_subject_id){Swal.fire('Erreur','Veuillez sélectionner une matière','error');return;}try{const yearId=selectedSchoolYear==='current'?null:selectedSchoolYear;const data={teacher_id:selectedTeacher.id,series_subject_id:assignmentData.series_subject_id};if(yearId!==null){data.school_year_id=yearId;}const response=await secureApiEndpoints.teacherAssignments.create(data);if(response.success){Swal.fire('Succès!',response.message||'Enseignant affecté avec succès','success');setShowAssignModal(false);loadYearData();}else{Swal.fire('Erreur',response.message||'Erreur lors de l\\'affectation','error');}}catch(error){console.error('Erreur lors de l\\'affectation:',error);let errorMessage='Une erreur est survenue';if(error.message){errorMessage=error.message;}else if(error.response&&error.response.data&&error.response.data.message){errorMessage=error.response.data.message;}Swal.fire('Erreur',errorMessage,'error');}};const handleAssignMainTeacher=async e=>{e.preventDefault();if(!selectedTeacher||!mainTeacherData.school_class_id){Swal.fire('Erreur','Veuillez sélectionner un enseignant et une classe','error');return;}try{const yearId=selectedSchoolYear==='current'?null:selectedSchoolYear;const data={teacher_id:selectedTeacher.id,school_class_id:mainTeacherData.school_class_id};if(yearId!==null){data.school_year_id=yearId;}const response=await secureApiEndpoints.mainTeachers.create(data);if(response.success){Swal.fire('Succès!',response.message||'Professeur principal désigné avec succès','success');setShowMainTeacherModal(false);loadYearData();}else{Swal.fire('Erreur',response.message||'Erreur lors de la désignation','error');}}catch(error){console.error('Erreur lors de la désignation:',error);let errorMessage='Une erreur est survenue';if(error.message){errorMessage=error.message;}else if(error.response&&error.response.data&&error.response.data.message){errorMessage=error.response.data.message;}Swal.fire('Erreur',errorMessage,'error');}};const handleRemoveAssignment=async assignmentId=>{try{const result=await Swal.fire({title:'Confirmation',text:'Êtes-vous sûr de vouloir supprimer cette affectation ?',icon:'warning',showCancelButton:true,confirmButtonText:'Oui, supprimer',cancelButtonText:'Annuler',confirmButtonColor:'#d33'});if(result.isConfirmed){const response=await secureApiEndpoints.teacherAssignments.delete(assignmentId);if(response.success){Swal.fire('Supprimé!',response.message||'Affectation supprimée avec succès','success');loadYearData();}}}catch(error){console.error('Erreur lors de la suppression:',error);let errorMessage='Une erreur est survenue';if(error.message){errorMessage=error.message;}else if(error.response&&error.response.data&&error.response.data.message){errorMessage=error.response.data.message;}Swal.fire('Erreur',errorMessage,'error');}};const handleRemoveMainTeacher=async mainTeacherId=>{try{const result=await Swal.fire({title:'Confirmation',text:'Êtes-vous sûr de vouloir retirer ce professeur principal ?',icon:'warning',showCancelButton:true,confirmButtonText:'Oui, retirer',cancelButtonText:'Annuler',confirmButtonColor:'#d33'});if(result.isConfirmed){const response=await secureApiEndpoints.mainTeachers.delete(mainTeacherId);if(response.success){Swal.fire('Retiré!',response.message||'Professeur principal retiré avec succès','success');loadYearData();}}}catch(error){console.error('Erreur lors du retrait:',error);let errorMessage='Une erreur est survenue';if(error.message){errorMessage=error.message;}else if(error.response&&error.response.data&&error.response.data.message){errorMessage=error.response.data.message;}Swal.fire('Erreur',errorMessage,'error');}};const getTeacherAssignments=teacherId=>{return assignments.filter(a=>a.teacher_id===teacherId);};const getTeacherMainClasses=teacherId=>{return mainTeachers.filter(mt=>mt.teacher_id===teacherId);};const getCurrentSchoolYear=()=>{if(selectedSchoolYear==='current'){const currentYear=schoolYears.find(y=>y.is_current);return currentYear?currentYear.name:'Année courante';}const year=schoolYears.find(y=>y.id===parseInt(selectedSchoolYear));return year?year.name:'Année sélectionnée';};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"container-fluid py-4\",children:/*#__PURE__*/_jsx(\"div\",{className:\"text-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"spinner-border text-primary\",role:\"status\",children:/*#__PURE__*/_jsx(\"span\",{className:\"visually-hidden\",children:\"Chargement...\"})})})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"container-fluid py-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Affectation des Enseignants\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted\",children:\"G\\xE9rez les affectations des enseignants aux mati\\xE8res configur\\xE9es et d\\xE9signez les professeurs principaux\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"d-flex gap-2\",children:/*#__PURE__*/_jsxs(Button,{variant:\"success\",onClick:handleShowMainTeacherModal,children:[/*#__PURE__*/_jsx(PlusCircle,{className:\"me-2\"}),\"D\\xE9signer Professeur Principal\"]})})]}),/*#__PURE__*/_jsx(Card,{className:\"mb-4\",children:/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(Row,{className:\"align-items-center\",children:[/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsxs(Form.Group,{children:[/*#__PURE__*/_jsxs(Form.Label,{className:\"d-flex align-items-center\",children:[/*#__PURE__*/_jsx(Calendar,{className:\"me-2\"}),\"Ann\\xE9e scolaire\"]}),/*#__PURE__*/_jsxs(Form.Select,{value:selectedSchoolYear,onChange:e=>setSelectedSchoolYear(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"current\",children:\"Ann\\xE9e courante\"}),schoolYears.map(year=>/*#__PURE__*/_jsxs(\"option\",{value:year.id,children:[year.name,\" \",year.is_current&&'(Courante)']},year.id))]})]})}),/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsxs(Alert,{variant:\"info\",className:\"mb-0\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Ann\\xE9e s\\xE9lectionn\\xE9e:\"}),\" \",getCurrentSchoolYear()]})})]})})}),/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(Tabs,{activeKey:activeTab,onSelect:setActiveTab,className:\"mb-3\",children:[/*#__PURE__*/_jsx(Tab,{eventKey:\"assignments\",title:\"Affectations Mati\\xE8res\",children:/*#__PURE__*/_jsx(\"div\",{className:\"row g-4\",children:teachers.map(teacher=>{const teacherAssignments=getTeacherAssignments(teacher.id);const mainClasses=getTeacherMainClasses(teacher.id);return/*#__PURE__*/_jsx(\"div\",{className:\"col-md-6 col-lg-4\",children:/*#__PURE__*/_jsxs(Card,{className:\"h-100\",children:[/*#__PURE__*/_jsxs(Card.Header,{className:\"d-flex justify-content-between align-items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center\",children:[/*#__PURE__*/_jsx(PersonFill,{className:\"text-primary me-2\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:teacher.full_name||`${teacher.last_name} ${teacher.first_name}`}),mainClasses.length>0&&/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Badge,{bg:\"success\",className:\"ms-1\",children:\"Prof. Principal\"})})]})]}),/*#__PURE__*/_jsxs(Button,{variant:\"outline-primary\",size:\"sm\",onClick:()=>handleShowAssignModal(teacher),children:[/*#__PURE__*/_jsx(PlusCircle,{size:14,className:\"me-1\"}),\"Affecter\"]})]}),/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-2\",children:/*#__PURE__*/_jsxs(\"small\",{className:\"text-muted\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"T\\xE9l\\xE9phone:\"}),\" \",teacher.phone_number]})}),teacherAssignments.length>0?/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"small\",{className:\"text-muted mb-2 d-block\",children:/*#__PURE__*/_jsx(\"strong\",{children:\"Mati\\xE8res assign\\xE9es:\"})}),teacherAssignments.map(assignment=>{var _assignment$series_su,_assignment$series_su2,_assignment$series_su3,_assignment$series_su4,_assignment$series_su5,_assignment$series_su6,_assignment$series_su7;return/*#__PURE__*/_jsx(\"div\",{className:\"mb-2 p-2 bg-light rounded\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-start\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{className:\"text-primary\",children:(_assignment$series_su=assignment.series_subject)===null||_assignment$series_su===void 0?void 0:(_assignment$series_su2=_assignment$series_su.subject)===null||_assignment$series_su2===void 0?void 0:_assignment$series_su2.name}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"small\",{className:\"text-muted\",children:[(_assignment$series_su3=assignment.series_subject)===null||_assignment$series_su3===void 0?void 0:(_assignment$series_su4=_assignment$series_su3.school_class)===null||_assignment$series_su4===void 0?void 0:_assignment$series_su4.name,((_assignment$series_su5=assignment.series_subject)===null||_assignment$series_su5===void 0?void 0:(_assignment$series_su6=_assignment$series_su5.school_class)===null||_assignment$series_su6===void 0?void 0:_assignment$series_su6.level)&&` (${assignment.series_subject.school_class.level.name})`]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(Badge,{bg:\"secondary\",children:[\"Coeff: \",(_assignment$series_su7=assignment.series_subject)===null||_assignment$series_su7===void 0?void 0:_assignment$series_su7.coefficient]})]}),/*#__PURE__*/_jsx(Button,{variant:\"outline-danger\",size:\"sm\",onClick:()=>handleRemoveAssignment(assignment.id),children:/*#__PURE__*/_jsx(Trash2,{size:12})})]})},assignment.id);})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"text-center text-muted py-2\",children:[/*#__PURE__*/_jsx(JournalBookmarkFill,{size:20,className:\"mb-1\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"small\",{children:\"Aucune mati\\xE8re assign\\xE9e\"})]}),mainClasses.length>0&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"small\",{className:\"text-muted mb-2 d-block\",children:/*#__PURE__*/_jsx(\"strong\",{children:\"Professeur principal de:\"})}),mainClasses.map(mainClass=>{var _mainClass$school_cla,_mainClass$school_cla2;return/*#__PURE__*/_jsx(\"div\",{className:\"mb-2 p-2 bg-success bg-opacity-10 rounded\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{className:\"text-success\",children:(_mainClass$school_cla=mainClass.school_class)===null||_mainClass$school_cla===void 0?void 0:_mainClass$school_cla.name}),((_mainClass$school_cla2=mainClass.school_class)===null||_mainClass$school_cla2===void 0?void 0:_mainClass$school_cla2.level)&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-muted ms-1\",children:[\"(\",mainClass.school_class.level.name,\")\"]})]}),/*#__PURE__*/_jsx(Button,{variant:\"outline-danger\",size:\"sm\",onClick:()=>handleRemoveMainTeacher(mainClass.id),children:/*#__PURE__*/_jsx(Trash2,{size:12})})]})},mainClass.id);})]})]})]})},teacher.id);})})}),/*#__PURE__*/_jsx(Tab,{eventKey:\"summary\",title:\"R\\xE9sum\\xE9\",children:/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(Card.Header,{children:/*#__PURE__*/_jsx(\"h5\",{children:\"Statistiques des Affectations\"})}),/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between py-2\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Enseignants actifs:\"}),/*#__PURE__*/_jsx(Badge,{bg:\"primary\",children:teachers.length})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between py-2\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Affectations mati\\xE8res:\"}),/*#__PURE__*/_jsx(Badge,{bg:\"info\",children:assignments.length})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between py-2\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Professeurs principaux:\"}),/*#__PURE__*/_jsx(Badge,{bg:\"success\",children:mainTeachers.length})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between py-2\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Mati\\xE8res configur\\xE9es:\"}),/*#__PURE__*/_jsx(Badge,{bg:\"secondary\",children:seriesSubjects.length})]})]})]})})})})]})})}),/*#__PURE__*/_jsxs(Modal,{show:showAssignModal,onHide:()=>setShowAssignModal(false),size:\"lg\",children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true,children:/*#__PURE__*/_jsxs(Modal.Title,{children:[\"Affecter une mati\\xE8re \\xE0 \",(selectedTeacher===null||selectedTeacher===void 0?void 0:selectedTeacher.full_name)||`${selectedTeacher===null||selectedTeacher===void 0?void 0:selectedTeacher.last_name} ${selectedTeacher===null||selectedTeacher===void 0?void 0:selectedTeacher.first_name}`]})}),/*#__PURE__*/_jsxs(Form,{onSubmit:handleAssignSubject,children:[/*#__PURE__*/_jsxs(Modal.Body,{children:[/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsxs(Form.Label,{children:[\"Mati\\xE8re disponible \",/*#__PURE__*/_jsx(\"span\",{className:\"text-danger\",children:\"*\"})]}),/*#__PURE__*/_jsxs(Form.Select,{value:assignmentData.series_subject_id,onChange:e=>setAssignmentData(prev=>({...prev,series_subject_id:e.target.value})),required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"S\\xE9lectionner une mati\\xE8re configur\\xE9e...\"}),availableSubjects.map(seriesSubject=>{var _seriesSubject$subjec,_seriesSubject$school,_seriesSubject$school2;return/*#__PURE__*/_jsxs(\"option\",{value:seriesSubject.id,children:[(_seriesSubject$subjec=seriesSubject.subject)===null||_seriesSubject$subjec===void 0?void 0:_seriesSubject$subjec.name,\" - \",(_seriesSubject$school=seriesSubject.school_class)===null||_seriesSubject$school===void 0?void 0:_seriesSubject$school.name,((_seriesSubject$school2=seriesSubject.school_class)===null||_seriesSubject$school2===void 0?void 0:_seriesSubject$school2.level)&&` (${seriesSubject.school_class.level.name})`,\"- Coeff: \",seriesSubject.coefficient]},seriesSubject.id);})]}),availableSubjects.length===0&&/*#__PURE__*/_jsx(Form.Text,{className:\"text-warning\",children:\"Aucune mati\\xE8re disponible pour cet enseignant. Assurez-vous que les mati\\xE8res sont configur\\xE9es dans les s\\xE9ries.\"})]}),/*#__PURE__*/_jsxs(Alert,{variant:\"info\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Information:\"}),\" Seules les mati\\xE8res pr\\xE9alablement configur\\xE9es pour les s\\xE9ries apparaissent ici. Pour ajouter de nouvelles mati\\xE8res, utilisez d'abord la \\\"Configuration S\\xE9rie-Mati\\xE8res\\\".\"]})]}),/*#__PURE__*/_jsxs(Modal.Footer,{children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:()=>setShowAssignModal(false),children:\"Annuler\"}),/*#__PURE__*/_jsxs(Button,{variant:\"primary\",type:\"submit\",disabled:!assignmentData.series_subject_id||availableSubjects.length===0,children:[/*#__PURE__*/_jsx(PlusCircle,{className:\"me-2\"}),\"Affecter\"]})]})]})]}),/*#__PURE__*/_jsxs(Modal,{show:showMainTeacherModal,onHide:()=>setShowMainTeacherModal(false),size:\"lg\",children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true,children:/*#__PURE__*/_jsx(Modal.Title,{children:\"D\\xE9signer un Professeur Principal\"})}),/*#__PURE__*/_jsxs(Form,{onSubmit:handleAssignMainTeacher,children:[/*#__PURE__*/_jsxs(Modal.Body,{children:[/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsxs(Form.Label,{children:[\"Enseignant \",/*#__PURE__*/_jsx(\"span\",{className:\"text-danger\",children:\"*\"})]}),/*#__PURE__*/_jsxs(Form.Select,{value:(selectedTeacher===null||selectedTeacher===void 0?void 0:selectedTeacher.id)||'',onChange:e=>{const teacher=teachers.find(t=>t.id===parseInt(e.target.value));setSelectedTeacher(teacher);},required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"S\\xE9lectionner un enseignant...\"}),teachers.map(teacher=>/*#__PURE__*/_jsx(\"option\",{value:teacher.id,children:teacher.full_name||`${teacher.last_name} ${teacher.first_name}`},teacher.id))]})]})}),/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsxs(Form.Label,{children:[\"Classe \",/*#__PURE__*/_jsx(\"span\",{className:\"text-danger\",children:\"*\"})]}),/*#__PURE__*/_jsxs(Form.Select,{value:mainTeacherData.school_class_id,onChange:e=>setMainTeacherData(prev=>({...prev,school_class_id:e.target.value})),required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"S\\xE9lectionner une classe...\"}),availableClasses.map(schoolClass=>/*#__PURE__*/_jsxs(\"option\",{value:schoolClass.id,children:[schoolClass.name,\" \",schoolClass.level&&`(${schoolClass.level.name})`]},schoolClass.id))]})]})})]}),/*#__PURE__*/_jsxs(Alert,{variant:\"warning\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Important:\"}),\" Un enseignant ne peut \\xEAtre professeur principal que d'une seule classe par ann\\xE9e scolaire. Une classe ne peut avoir qu'un seul professeur principal.\"]})]}),/*#__PURE__*/_jsxs(Modal.Footer,{children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:()=>setShowMainTeacherModal(false),children:\"Annuler\"}),/*#__PURE__*/_jsxs(Button,{variant:\"success\",type:\"submit\",disabled:!selectedTeacher||!mainTeacherData.school_class_id,children:[/*#__PURE__*/_jsx(PersonFill,{className:\"me-2\"}),\"D\\xE9signer\"]})]})]})]})]});};export default TeacherAssignmentManagement;","map":{"version":3,"names":["React","useState","useEffect","Button","Modal","Form","Alert","Badge","Card","Table","Row","Col","Tabs","Tab","PlusCircle","PersonFill","JournalBookmarkFill","HouseHeartFill","Trash2","Calendar","secureApiEndpoints","Swal","jsx","_jsx","jsxs","_jsxs","TeacherAssignmentManagement","loading","setLoading","teachers","setTeachers","seriesSubjects","setSeriesSubjects","schoolYears","setSchoolYears","assignments","setAssignments","mainTeachers","setMainTeachers","showAssignModal","setShowAssignModal","showMainTeacherModal","setShowMainTeacherModal","selectedTeacher","setSelectedTeacher","selectedSchoolYear","setSelectedSchoolYear","availableSubjects","setAvailableSubjects","availableClasses","setAvailableClasses","assignmentData","setAssignmentData","series_subject_id","mainTeacherData","setMainTeacherData","school_class_id","activeTab","setActiveTab","loadInitialData","loadYearData","teachersRes","schoolYearsRes","seriesSubjectsRes","Promise","all","getAll","active","getActiveYears","success","data","error","console","fire","yearId","assignmentParams","mainTeacherParams","school_year_id","assignmentsRes","mainTeachersRes","teacherAssignments","handleShowAssignModal","teacher","params","availableRes","getAvailableSubjects","id","handleShowMainTeacherModal","availableTeachersRes","availableClassesRes","getAvailableTeachers","getClassesWithoutMainTeacher","prev","filter","t","some","at","handleAssignSubject","e","preventDefault","teacher_id","response","create","message","errorMessage","handleAssignMainTeacher","handleRemoveAssignment","assignmentId","result","title","text","icon","showCancelButton","confirmButtonText","cancelButtonText","confirmButtonColor","isConfirmed","delete","handleRemoveMainTeacher","mainTeacherId","getTeacherAssignments","teacherId","a","getTeacherMainClasses","mt","getCurrentSchoolYear","currentYear","find","y","is_current","name","year","parseInt","className","children","role","variant","onClick","Body","md","Group","Label","Select","value","onChange","target","map","activeKey","onSelect","eventKey","mainClasses","Header","full_name","last_name","first_name","length","bg","size","phone_number","assignment","_assignment$series_su","_assignment$series_su2","_assignment$series_su3","_assignment$series_su4","_assignment$series_su5","_assignment$series_su6","_assignment$series_su7","series_subject","subject","school_class","level","coefficient","mainClass","_mainClass$school_cla","_mainClass$school_cla2","show","onHide","closeButton","Title","onSubmit","required","seriesSubject","_seriesSubject$subjec","_seriesSubject$school","_seriesSubject$school2","Text","Footer","type","disabled","schoolClass"],"sources":["/var/www/College-IUP/front/src/pages/Teachers/TeacherAssignmentManagement.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Button, Modal, Form, Alert, Badge, Card, Table, Row, Col, Tabs, Tab } from 'react-bootstrap';\nimport { PlusCircle, PersonFill, JournalBookmarkFill, HouseHeartFill, Trash2, Calendar } from 'react-bootstrap-icons';\nimport { secureApiEndpoints } from '../../utils/apiMigration';\nimport Swal from 'sweetalert2';\n\nconst TeacherAssignmentManagement = () => {\n    const [loading, setLoading] = useState(false);\n    const [teachers, setTeachers] = useState([]);\n    const [seriesSubjects, setSeriesSubjects] = useState([]);\n    const [schoolYears, setSchoolYears] = useState([]);\n    const [assignments, setAssignments] = useState([]);\n    const [mainTeachers, setMainTeachers] = useState([]);\n    const [showAssignModal, setShowAssignModal] = useState(false);\n    const [showMainTeacherModal, setShowMainTeacherModal] = useState(false);\n    const [selectedTeacher, setSelectedTeacher] = useState(null);\n    const [selectedSchoolYear, setSelectedSchoolYear] = useState('current');\n    const [availableSubjects, setAvailableSubjects] = useState([]);\n    const [availableClasses, setAvailableClasses] = useState([]);\n    const [assignmentData, setAssignmentData] = useState({\n        series_subject_id: ''\n    });\n    const [mainTeacherData, setMainTeacherData] = useState({\n        school_class_id: ''\n    });\n    const [activeTab, setActiveTab] = useState('assignments');\n\n    useEffect(() => {\n        loadInitialData();\n    }, []);\n\n    useEffect(() => {\n        if (selectedSchoolYear) {\n            loadYearData();\n        }\n    }, [selectedSchoolYear]);\n\n    const loadInitialData = async () => {\n        try {\n            setLoading(true);\n            const [teachersRes, schoolYearsRes, seriesSubjectsRes] = await Promise.all([\n                secureApiEndpoints.teachers.getAll({ active: true }),\n                secureApiEndpoints.schoolYears.getActiveYears(),\n                secureApiEndpoints.seriesSubjects.getAll({ active: true })\n            ]);\n\n            if (teachersRes.success) setTeachers(teachersRes.data);\n            if (schoolYearsRes.success) setSchoolYears(schoolYearsRes.data);\n            if (seriesSubjectsRes.success) setSeriesSubjects(seriesSubjectsRes.data);\n\n        } catch (error) {\n            console.error('Erreur lors du chargement des données:', error);\n            Swal.fire('Erreur', 'Impossible de charger les données', 'error');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const loadYearData = async () => {\n        try {\n            const yearId = selectedSchoolYear === 'current' ? null : selectedSchoolYear;\n            \n            // Construire les paramètres sans school_year_id si yearId est null\n            const assignmentParams = { active: true };\n            const mainTeacherParams = { active: true };\n            \n            if (yearId !== null) {\n                assignmentParams.school_year_id = yearId;\n                mainTeacherParams.school_year_id = yearId;\n            }\n            \n            const [assignmentsRes, mainTeachersRes] = await Promise.all([\n                secureApiEndpoints.teacherAssignments.getAll(assignmentParams),\n                secureApiEndpoints.mainTeachers.getAll(mainTeacherParams)\n            ]);\n\n            if (assignmentsRes.success) setAssignments(assignmentsRes.data);\n            if (mainTeachersRes.success) setMainTeachers(mainTeachersRes.data);\n\n        } catch (error) {\n            console.error('Erreur lors du chargement des données de l\\'année:', error);\n        }\n    };\n\n    const handleShowAssignModal = async (teacher) => {\n        setSelectedTeacher(teacher);\n        \n        try {\n            const yearId = selectedSchoolYear === 'current' ? null : selectedSchoolYear;\n            const params = {};\n            if (yearId !== null) {\n                params.school_year_id = yearId;\n            }\n            const availableRes = await secureApiEndpoints.teacherAssignments.getAvailableSubjects(teacher.id, params);\n\n            if (availableRes.success) {\n                setAvailableSubjects(availableRes.data);\n            }\n        } catch (error) {\n            console.error('Erreur lors du chargement des matières disponibles:', error);\n        }\n\n        setAssignmentData({ series_subject_id: '' });\n        setShowAssignModal(true);\n    };\n\n    const handleShowMainTeacherModal = async () => {\n        try {\n            const yearId = selectedSchoolYear === 'current' ? null : selectedSchoolYear;\n            const params = {};\n            if (yearId !== null) {\n                params.school_year_id = yearId;\n            }\n            const [availableTeachersRes, availableClassesRes] = await Promise.all([\n                secureApiEndpoints.mainTeachers.getAvailableTeachers(params),\n                secureApiEndpoints.mainTeachers.getClassesWithoutMainTeacher(params)\n            ]);\n\n            if (availableTeachersRes.success) setTeachers(prev => prev.filter(t => \n                availableTeachersRes.data.some(at => at.id === t.id)\n            ));\n            if (availableClassesRes.success) setAvailableClasses(availableClassesRes.data);\n\n        } catch (error) {\n            console.error('Erreur lors du chargement des données:', error);\n        }\n\n        setMainTeacherData({ school_class_id: '' });\n        setShowMainTeacherModal(true);\n    };\n\n    const handleAssignSubject = async (e) => {\n        e.preventDefault();\n        \n        if (!selectedTeacher || !assignmentData.series_subject_id) {\n            Swal.fire('Erreur', 'Veuillez sélectionner une matière', 'error');\n            return;\n        }\n\n        try {\n            const yearId = selectedSchoolYear === 'current' ? null : selectedSchoolYear;\n            const data = {\n                teacher_id: selectedTeacher.id,\n                series_subject_id: assignmentData.series_subject_id\n            };\n            if (yearId !== null) {\n                data.school_year_id = yearId;\n            }\n            const response = await secureApiEndpoints.teacherAssignments.create(data);\n\n            if (response.success) {\n                Swal.fire('Succès!', response.message || 'Enseignant affecté avec succès', 'success');\n                setShowAssignModal(false);\n                loadYearData();\n            } else {\n                Swal.fire('Erreur', response.message || 'Erreur lors de l\\'affectation', 'error');\n            }\n        } catch (error) {\n            console.error('Erreur lors de l\\'affectation:', error);\n            let errorMessage = 'Une erreur est survenue';\n            \n            if (error.message) {\n                errorMessage = error.message;\n            } else if (error.response && error.response.data && error.response.data.message) {\n                errorMessage = error.response.data.message;\n            }\n            \n            Swal.fire('Erreur', errorMessage, 'error');\n        }\n    };\n\n    const handleAssignMainTeacher = async (e) => {\n        e.preventDefault();\n        \n        if (!selectedTeacher || !mainTeacherData.school_class_id) {\n            Swal.fire('Erreur', 'Veuillez sélectionner un enseignant et une classe', 'error');\n            return;\n        }\n\n        try {\n            const yearId = selectedSchoolYear === 'current' ? null : selectedSchoolYear;\n            const data = {\n                teacher_id: selectedTeacher.id,\n                school_class_id: mainTeacherData.school_class_id\n            };\n            if (yearId !== null) {\n                data.school_year_id = yearId;\n            }\n            const response = await secureApiEndpoints.mainTeachers.create(data);\n\n            if (response.success) {\n                Swal.fire('Succès!', response.message || 'Professeur principal désigné avec succès', 'success');\n                setShowMainTeacherModal(false);\n                loadYearData();\n            } else {\n                Swal.fire('Erreur', response.message || 'Erreur lors de la désignation', 'error');\n            }\n        } catch (error) {\n            console.error('Erreur lors de la désignation:', error);\n            let errorMessage = 'Une erreur est survenue';\n            \n            if (error.message) {\n                errorMessage = error.message;\n            } else if (error.response && error.response.data && error.response.data.message) {\n                errorMessage = error.response.data.message;\n            }\n            \n            Swal.fire('Erreur', errorMessage, 'error');\n        }\n    };\n\n    const handleRemoveAssignment = async (assignmentId) => {\n        try {\n            const result = await Swal.fire({\n                title: 'Confirmation',\n                text: 'Êtes-vous sûr de vouloir supprimer cette affectation ?',\n                icon: 'warning',\n                showCancelButton: true,\n                confirmButtonText: 'Oui, supprimer',\n                cancelButtonText: 'Annuler',\n                confirmButtonColor: '#d33'\n            });\n\n            if (result.isConfirmed) {\n                const response = await secureApiEndpoints.teacherAssignments.delete(assignmentId);\n                if (response.success) {\n                    Swal.fire('Supprimé!', response.message || 'Affectation supprimée avec succès', 'success');\n                    loadYearData();\n                }\n            }\n        } catch (error) {\n            console.error('Erreur lors de la suppression:', error);\n            let errorMessage = 'Une erreur est survenue';\n            \n            if (error.message) {\n                errorMessage = error.message;\n            } else if (error.response && error.response.data && error.response.data.message) {\n                errorMessage = error.response.data.message;\n            }\n            \n            Swal.fire('Erreur', errorMessage, 'error');\n        }\n    };\n\n    const handleRemoveMainTeacher = async (mainTeacherId) => {\n        try {\n            const result = await Swal.fire({\n                title: 'Confirmation',\n                text: 'Êtes-vous sûr de vouloir retirer ce professeur principal ?',\n                icon: 'warning',\n                showCancelButton: true,\n                confirmButtonText: 'Oui, retirer',\n                cancelButtonText: 'Annuler',\n                confirmButtonColor: '#d33'\n            });\n\n            if (result.isConfirmed) {\n                const response = await secureApiEndpoints.mainTeachers.delete(mainTeacherId);\n                if (response.success) {\n                    Swal.fire('Retiré!', response.message || 'Professeur principal retiré avec succès', 'success');\n                    loadYearData();\n                }\n            }\n        } catch (error) {\n            console.error('Erreur lors du retrait:', error);\n            let errorMessage = 'Une erreur est survenue';\n            \n            if (error.message) {\n                errorMessage = error.message;\n            } else if (error.response && error.response.data && error.response.data.message) {\n                errorMessage = error.response.data.message;\n            }\n            \n            Swal.fire('Erreur', errorMessage, 'error');\n        }\n    };\n\n    const getTeacherAssignments = (teacherId) => {\n        return assignments.filter(a => a.teacher_id === teacherId);\n    };\n\n    const getTeacherMainClasses = (teacherId) => {\n        return mainTeachers.filter(mt => mt.teacher_id === teacherId);\n    };\n\n    const getCurrentSchoolYear = () => {\n        if (selectedSchoolYear === 'current') {\n            const currentYear = schoolYears.find(y => y.is_current);\n            return currentYear ? currentYear.name : 'Année courante';\n        }\n        const year = schoolYears.find(y => y.id === parseInt(selectedSchoolYear));\n        return year ? year.name : 'Année sélectionnée';\n    };\n\n    if (loading) {\n        return (\n            <div className=\"container-fluid py-4\">\n                <div className=\"text-center\">\n                    <div className=\"spinner-border text-primary\" role=\"status\">\n                        <span className=\"visually-hidden\">Chargement...</span>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"container-fluid py-4\">\n            {/* Header */}\n            <div className=\"d-flex justify-content-between align-items-center mb-4\">\n                <div>\n                    <h2>Affectation des Enseignants</h2>\n                    <p className=\"text-muted\">Gérez les affectations des enseignants aux matières configurées et désignez les professeurs principaux</p>\n                </div>\n                <div className=\"d-flex gap-2\">\n                    <Button \n                        variant=\"success\" \n                        onClick={handleShowMainTeacherModal}\n                    >\n                        <PlusCircle className=\"me-2\" />\n                        Désigner Professeur Principal\n                    </Button>\n                </div>\n            </div>\n\n            {/* School Year Selector */}\n            <Card className=\"mb-4\">\n                <Card.Body>\n                    <Row className=\"align-items-center\">\n                        <Col md={6}>\n                            <Form.Group>\n                                <Form.Label className=\"d-flex align-items-center\">\n                                    <Calendar className=\"me-2\" />\n                                    Année scolaire\n                                </Form.Label>\n                                <Form.Select\n                                    value={selectedSchoolYear}\n                                    onChange={(e) => setSelectedSchoolYear(e.target.value)}\n                                >\n                                    <option value=\"current\">Année courante</option>\n                                    {schoolYears.map((year) => (\n                                        <option key={year.id} value={year.id}>\n                                            {year.name} {year.is_current && '(Courante)'}\n                                        </option>\n                                    ))}\n                                </Form.Select>\n                            </Form.Group>\n                        </Col>\n                        <Col md={6}>\n                            <Alert variant=\"info\" className=\"mb-0\">\n                                <strong>Année sélectionnée:</strong> {getCurrentSchoolYear()}\n                            </Alert>\n                        </Col>\n                    </Row>\n                </Card.Body>\n            </Card>\n\n            {/* Content Tabs */}\n            <Card>\n                <Card.Body>\n                    <Tabs activeKey={activeTab} onSelect={setActiveTab} className=\"mb-3\">\n                        <Tab eventKey=\"assignments\" title=\"Affectations Matières\">\n                            <div className=\"row g-4\">\n                                {teachers.map((teacher) => {\n                                    const teacherAssignments = getTeacherAssignments(teacher.id);\n                                    const mainClasses = getTeacherMainClasses(teacher.id);\n                                    \n                                    return (\n                                        <div key={teacher.id} className=\"col-md-6 col-lg-4\">\n                                            <Card className=\"h-100\">\n                                                <Card.Header className=\"d-flex justify-content-between align-items-center\">\n                                                    <div className=\"d-flex align-items-center\">\n                                                        <PersonFill className=\"text-primary me-2\" />\n                                                        <div>\n                                                            <strong>{teacher.full_name || `${teacher.last_name} ${teacher.first_name}`}</strong>\n                                                            {mainClasses.length > 0 && (\n                                                                <div>\n                                                                    <Badge bg=\"success\" className=\"ms-1\">Prof. Principal</Badge>\n                                                                </div>\n                                                            )}\n                                                        </div>\n                                                    </div>\n                                                    <Button\n                                                        variant=\"outline-primary\"\n                                                        size=\"sm\"\n                                                        onClick={() => handleShowAssignModal(teacher)}\n                                                    >\n                                                        <PlusCircle size={14} className=\"me-1\" />\n                                                        Affecter\n                                                    </Button>\n                                                </Card.Header>\n                                                <Card.Body>\n                                                    <div className=\"mb-2\">\n                                                        <small className=\"text-muted\">\n                                                            <strong>Téléphone:</strong> {teacher.phone_number}\n                                                        </small>\n                                                    </div>\n                                                    \n                                                    {/* Affectations matières */}\n                                                    {teacherAssignments.length > 0 ? (\n                                                        <div className=\"mb-3\">\n                                                            <small className=\"text-muted mb-2 d-block\">\n                                                                <strong>Matières assignées:</strong>\n                                                            </small>\n                                                            {teacherAssignments.map((assignment) => (\n                                                                <div key={assignment.id} className=\"mb-2 p-2 bg-light rounded\">\n                                                                    <div className=\"d-flex justify-content-between align-items-start\">\n                                                                        <div>\n                                                                            <strong className=\"text-primary\">\n                                                                                {assignment.series_subject?.subject?.name}\n                                                                            </strong>\n                                                                            <br />\n                                                                            <small className=\"text-muted\">\n                                                                                {assignment.series_subject?.school_class?.name} \n                                                                                {assignment.series_subject?.school_class?.level && \n                                                                                    ` (${assignment.series_subject.school_class.level.name})`\n                                                                                }\n                                                                            </small>\n                                                                            <br />\n                                                                            <Badge bg=\"secondary\">\n                                                                                Coeff: {assignment.series_subject?.coefficient}\n                                                                            </Badge>\n                                                                        </div>\n                                                                        <Button\n                                                                            variant=\"outline-danger\"\n                                                                            size=\"sm\"\n                                                                            onClick={() => handleRemoveAssignment(assignment.id)}\n                                                                        >\n                                                                            <Trash2 size={12} />\n                                                                        </Button>\n                                                                    </div>\n                                                                </div>\n                                                            ))}\n                                                        </div>\n                                                    ) : (\n                                                        <div className=\"text-center text-muted py-2\">\n                                                            <JournalBookmarkFill size={20} className=\"mb-1\" />\n                                                            <br />\n                                                            <small>Aucune matière assignée</small>\n                                                        </div>\n                                                    )}\n\n                                                    {/* Classes principales */}\n                                                    {mainClasses.length > 0 && (\n                                                        <div>\n                                                            <small className=\"text-muted mb-2 d-block\">\n                                                                <strong>Professeur principal de:</strong>\n                                                            </small>\n                                                            {mainClasses.map((mainClass) => (\n                                                                <div key={mainClass.id} className=\"mb-2 p-2 bg-success bg-opacity-10 rounded\">\n                                                                    <div className=\"d-flex justify-content-between align-items-center\">\n                                                                        <div>\n                                                                            <strong className=\"text-success\">\n                                                                                {mainClass.school_class?.name}\n                                                                            </strong>\n                                                                            {mainClass.school_class?.level && (\n                                                                                <span className=\"text-muted ms-1\">\n                                                                                    ({mainClass.school_class.level.name})\n                                                                                </span>\n                                                                            )}\n                                                                        </div>\n                                                                        <Button\n                                                                            variant=\"outline-danger\"\n                                                                            size=\"sm\"\n                                                                            onClick={() => handleRemoveMainTeacher(mainClass.id)}\n                                                                        >\n                                                                            <Trash2 size={12} />\n                                                                        </Button>\n                                                                    </div>\n                                                                </div>\n                                                            ))}\n                                                        </div>\n                                                    )}\n                                                </Card.Body>\n                                            </Card>\n                                        </div>\n                                    );\n                                })}\n                            </div>\n                        </Tab>\n\n                        <Tab eventKey=\"summary\" title=\"Résumé\">\n                            <Row>\n                                <Col md={6}>\n                                    <Card>\n                                        <Card.Header>\n                                            <h5>Statistiques des Affectations</h5>\n                                        </Card.Header>\n                                        <Card.Body>\n                                            <div className=\"d-flex justify-content-between py-2\">\n                                                <span>Enseignants actifs:</span>\n                                                <Badge bg=\"primary\">{teachers.length}</Badge>\n                                            </div>\n                                            <div className=\"d-flex justify-content-between py-2\">\n                                                <span>Affectations matières:</span>\n                                                <Badge bg=\"info\">{assignments.length}</Badge>\n                                            </div>\n                                            <div className=\"d-flex justify-content-between py-2\">\n                                                <span>Professeurs principaux:</span>\n                                                <Badge bg=\"success\">{mainTeachers.length}</Badge>\n                                            </div>\n                                            <div className=\"d-flex justify-content-between py-2\">\n                                                <span>Matières configurées:</span>\n                                                <Badge bg=\"secondary\">{seriesSubjects.length}</Badge>\n                                            </div>\n                                        </Card.Body>\n                                    </Card>\n                                </Col>\n                            </Row>\n                        </Tab>\n                    </Tabs>\n                </Card.Body>\n            </Card>\n\n            {/* Modal d'affectation matière */}\n            <Modal show={showAssignModal} onHide={() => setShowAssignModal(false)} size=\"lg\">\n                <Modal.Header closeButton>\n                    <Modal.Title>\n                        Affecter une matière à {selectedTeacher?.full_name || `${selectedTeacher?.last_name} ${selectedTeacher?.first_name}`}\n                    </Modal.Title>\n                </Modal.Header>\n                <Form onSubmit={handleAssignSubject}>\n                    <Modal.Body>\n                        <Form.Group className=\"mb-3\">\n                            <Form.Label>Matière disponible <span className=\"text-danger\">*</span></Form.Label>\n                            <Form.Select\n                                value={assignmentData.series_subject_id}\n                                onChange={(e) => setAssignmentData(prev => ({ ...prev, series_subject_id: e.target.value }))}\n                                required\n                            >\n                                <option value=\"\">Sélectionner une matière configurée...</option>\n                                {availableSubjects.map((seriesSubject) => (\n                                    <option key={seriesSubject.id} value={seriesSubject.id}>\n                                        {seriesSubject.subject?.name} - {seriesSubject.school_class?.name} \n                                        {seriesSubject.school_class?.level && ` (${seriesSubject.school_class.level.name})`} \n                                        - Coeff: {seriesSubject.coefficient}\n                                    </option>\n                                ))}\n                            </Form.Select>\n                            {availableSubjects.length === 0 && (\n                                <Form.Text className=\"text-warning\">\n                                    Aucune matière disponible pour cet enseignant. Assurez-vous que les matières sont configurées dans les séries.\n                                </Form.Text>\n                            )}\n                        </Form.Group>\n                        \n                        <Alert variant=\"info\">\n                            <strong>Information:</strong> Seules les matières préalablement configurées pour les séries apparaissent ici. \n                            Pour ajouter de nouvelles matières, utilisez d'abord la \"Configuration Série-Matières\".\n                        </Alert>\n                    </Modal.Body>\n                    <Modal.Footer>\n                        <Button variant=\"secondary\" onClick={() => setShowAssignModal(false)}>\n                            Annuler\n                        </Button>\n                        <Button \n                            variant=\"primary\" \n                            type=\"submit\"\n                            disabled={!assignmentData.series_subject_id || availableSubjects.length === 0}\n                        >\n                            <PlusCircle className=\"me-2\" />\n                            Affecter\n                        </Button>\n                    </Modal.Footer>\n                </Form>\n            </Modal>\n\n            {/* Modal désignation professeur principal */}\n            <Modal show={showMainTeacherModal} onHide={() => setShowMainTeacherModal(false)} size=\"lg\">\n                <Modal.Header closeButton>\n                    <Modal.Title>\n                        Désigner un Professeur Principal\n                    </Modal.Title>\n                </Modal.Header>\n                <Form onSubmit={handleAssignMainTeacher}>\n                    <Modal.Body>\n                        <Row>\n                            <Col md={6}>\n                                <Form.Group className=\"mb-3\">\n                                    <Form.Label>Enseignant <span className=\"text-danger\">*</span></Form.Label>\n                                    <Form.Select\n                                        value={selectedTeacher?.id || ''}\n                                        onChange={(e) => {\n                                            const teacher = teachers.find(t => t.id === parseInt(e.target.value));\n                                            setSelectedTeacher(teacher);\n                                        }}\n                                        required\n                                    >\n                                        <option value=\"\">Sélectionner un enseignant...</option>\n                                        {teachers.map((teacher) => (\n                                            <option key={teacher.id} value={teacher.id}>\n                                                {teacher.full_name || `${teacher.last_name} ${teacher.first_name}`}\n                                            </option>\n                                        ))}\n                                    </Form.Select>\n                                </Form.Group>\n                            </Col>\n                            <Col md={6}>\n                                <Form.Group className=\"mb-3\">\n                                    <Form.Label>Classe <span className=\"text-danger\">*</span></Form.Label>\n                                    <Form.Select\n                                        value={mainTeacherData.school_class_id}\n                                        onChange={(e) => setMainTeacherData(prev => ({ ...prev, school_class_id: e.target.value }))}\n                                        required\n                                    >\n                                        <option value=\"\">Sélectionner une classe...</option>\n                                        {availableClasses.map((schoolClass) => (\n                                            <option key={schoolClass.id} value={schoolClass.id}>\n                                                {schoolClass.name} {schoolClass.level && `(${schoolClass.level.name})`}\n                                            </option>\n                                        ))}\n                                    </Form.Select>\n                                </Form.Group>\n                            </Col>\n                        </Row>\n                        \n                        <Alert variant=\"warning\">\n                            <strong>Important:</strong> Un enseignant ne peut être professeur principal que d'une seule classe par année scolaire.\n                            Une classe ne peut avoir qu'un seul professeur principal.\n                        </Alert>\n                    </Modal.Body>\n                    <Modal.Footer>\n                        <Button variant=\"secondary\" onClick={() => setShowMainTeacherModal(false)}>\n                            Annuler\n                        </Button>\n                        <Button \n                            variant=\"success\" \n                            type=\"submit\"\n                            disabled={!selectedTeacher || !mainTeacherData.school_class_id}\n                        >\n                            <PersonFill className=\"me-2\" />\n                            Désigner\n                        </Button>\n                    </Modal.Footer>\n                </Form>\n            </Modal>\n        </div>\n    );\n};\n\nexport default TeacherAssignmentManagement;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}